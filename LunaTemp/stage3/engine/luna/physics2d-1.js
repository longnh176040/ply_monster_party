"use strict";(self.webpackChunkluna=self.webpackChunkluna||[]).push([[8],{37:(t,e,i)=>{var n=i(2),s=i(0);const o=planck.Math.EPSILON,r=.001,a=Math.PI*r*r,c=planck.Body,h=new planck.Vec2,_=new planck.Vec2,l=new s.h,d=new s.k;class u extends n.j{constructor(t){super(),t=t||{enabled:!0,simulated:!0,type:UnityEngine.RigidbodyType2D.Dynamic,collisionDetectionMode:UnityEngine.CollisionDetectionMode2D.Discrete,mass:1},this._system=n.a.getApplication().systems.rigidbody2D,this._enabled=t.enabled,this._simulated=t.simulated,this._collisionDetectionMode=t.collisionDetectionMode,this._constraints=t.constraints||0,this._freezeRotation=!!(this._constraints&UnityEngine.RigidbodyConstraints2D.FreezeRotation),this._freezeX=!!(this._constraints&UnityEngine.RigidbodyConstraints2D.FreezePositionX),this._freezeY=!!(this._constraints&UnityEngine.RigidbodyConstraints2D.FreezePositionY),this._useCollidersDensity=!!t.useAutoMass,this._adapter=this._system.adapter,this._world=this._adapter.world,this._body=this._world.createBody({type:t.type===UnityEngine.RigidbodyType2D.Dynamic?c.DYNAMIC:t.type===UnityEngine.RigidbodyType2D.Kinematic?c.KINEMATIC:c.STATIC,bullet:this._collisionDetectionMode===UnityEngine.CollisionDetectionMode2D.Continuous,gravityScale:Number.isFinite(t.gravityScale)?t.gravityScale:1,angularDamping:t.angularDrag>=0?t.angularDrag:.05,linearDamping:t.drag>0?t.drag:0,fixedRotation:this._freezeRotation,defaultMass:t.mass,fixedX:this._freezeX,fixedY:this._freezeY,active:!1}),this._body._component=this,this._body._entity=t.entity,this._body._material=t.material,this._worldTransformVersion=-1,this.createFauxFixture(),this["__UnityEngine.Rigidbody2D"]=null,pc.markPhysics2dModuleAsUsed(),TESTS&&pc.hiddenShapeValidator.addObjectToValidationSet(this,"Rigidbody2DComponent")}get body(){return this._body}get destroyed(){return this._destroyed}get useCollidersDensity(){return this._useCollidersDensity}createFauxFixture(){const t=this._body._density=this._body.getDefaultMass()/a;this._body.createFixture(new planck.Circle(r),{density:t,filterMaskBits:0})._isFaux=!0}onEnable(){return!!super.onEnable()&&(this._simulated&&this._adapter.enableRigidbody(this),!0)}onDisable(){if(!super.onDisable())return!1;if(this._simulated&&this._enabled&&this._adapter.disableRigidbody(this),this._entity.enabled)return!0;let t=this._body.getJointList();for(;t;){const e=t.joint;t=t.next,e.getBodyB()===this._body&&this._world.destroyJoint(e)}return!0}onDestroy(){return!!super.onDestroy()&&(this._destroyed=!0,this.onDisable(),this._world.destroyBody(this._body),!0)}addForce(t){this._body.applyForceToCenter(h.set(t.x,t.y),!0)}addImpulse(t){this._body.applyLinearImpulseToCenter(h.set(t.x,t.y),!0)}addForceAtPosition(t,e){this._body.applyForce(h.set(t.x,t.y),_.set(e.x,e.y),!0)}addImpulseAtPosition(t,e){this._body.applyLinearImpulse(h.set(t.x,t.y),_.set(e.x,e.y),!0)}addRelativeForce(t){this._body.applyForceToCenter(h.set(t.x,t.y).rot(this._body.getTransform().q),!0)}addRelativeImpulse(t){this._body.applyLinearImpulseToCenter(h.set(t.x,t.y).rot(this._body.getTransform().q),!0)}addTorque(t){this._body.applyTorque(t,!0)}addTorqueImpulse(t){this._body.applyAngularImpulse(t,!0)}getVelocity(){const t=this._body.getLinearVelocity();return this._velocity=(this._velocity||new s.j).set(t.x,t.y),this._velocity}setVelocity(t){this._freezeX&&this._freezeY||(this._freezeX||this._freezeY?(h.set(this._body.getLinearVelocity()),this._freezeX?h.y=t.y:h.x=t.x,this._body.setLinearVelocity(h)):this._body.setLinearVelocity(h.set(t.x,t.y)))}getAngularVelocity(){return this._body.getAngularVelocity()*s.i}setAngularVelocity(t){this._freezeRotation||this._body.setAngularVelocity(t*s.d)}getMass(){return this._body.getMass()}setMass(t){if(this._useCollidersDensity)return void UnityEngine.Debug.LogWarningFormat("Mass cannot be set on the rigid-body when it is using auto-mass.");const e=this._body;e.getMass()!==t&&(e.setDefaultMass(t),u.setDensity(e,e.getDefaultMass()/e.getMass()*e._density),e.setAwake(!0))}getUseAutoMass(){return this._useCollidersDensity}setUseAutoMass(t){this._useCollidersDensity!==t&&(this._useCollidersDensity=!!t,this._resetMassData())}_resetMassData(){const t=this._body;if(!this._useCollidersDensity){const e=t.getDefaultMass();return u.setDensity(t,1),void this.setMass(e)}let e=t.getFixtureList();if(!e._isFaux){for(;e;e=e.getNext()){const t=e._component.getDensity();e.setDensity(t)}t.resetMassData(),t.setAwake(!0)}}getInertia(){return this._body.getInertia()}setInertia(t){this._body.setInertia(Math.max(t,1e-4))}getDrag(){return this._body.getLinearDamping()}setDrag(t){this._body.setLinearDamping(t)}getAngularDrag(){return this._body.getAngularDamping()}setAngularDrag(t){this._body.setAngularDamping(t)}getPosition(){const t=this._body.getPosition();return new s.j(t.x,t.y)}setPosition(t){this._body.setPosition(_.set(t.x,t.y))}getRotation(){return this._body.getAngle()*s.i}setRotation(t){this._body.setAngle(t*s.d)}getGravityScale(){return this._body.getGravityScale()}setGravityScale(t){this._body.setGravityScale(t)}getCollisionDetectionMode(){return this._collisionDetectionMode}setCollisionDetectionMode(t){this._collisionDetectionMode!==t&&(this._collisionDetectionMode=t,this._body.setBullet(t===UnityEngine.CollisionDetectionMode2D.Continuous))}getSimulated(){return this._simulated}setSimulated(t){t!==this._simulated&&(this._simulated=t,this._enabled&&(t?this._adapter.enableRigidbody(this):this._adapter.disableRigidbody(this)))}getBodyType(){switch(this._body.getType()){case c.DYNAMIC:return UnityEngine.RigidbodyType2D.Dynamic;case c.KINEMATIC:return UnityEngine.RigidbodyType2D.Kinematic;case c.STATIC:return UnityEngine.RigidbodyType2D.Static;default:return NaN}}setBodyType(t){if(this.getBodyType()!==t)switch(t){case UnityEngine.RigidbodyType2D.Dynamic:this._body.setType(c.DYNAMIC),this._resetMassData();break;case UnityEngine.RigidbodyType2D.Kinematic:this._body.setType(c.KINEMATIC);break;case UnityEngine.RigidbodyType2D.Static:this._body.setType(c.STATIC)}}getIsKinematic(){return this._body.getType()===c.KINEMATIC}setIsKinematic(t){this._body.setType(t?c.KINEMATIC:c.DYNAMIC)}getIsStatic(){return this._body.getType()===c.STATIC}getFreezeRotation(){return this._freezeRotation}setFreezeRotation(t){t!==this._freezeRotation&&(this._body.setFixedRotation(this._freezeRotation=!!t),this._freezeRotation?this._constraints|=UnityEngine.RigidbodyConstraints2D.FreezeRotation:this._constraints&=~UnityEngine.RigidbodyConstraints2D.FreezeRotation)}getConstraints(){return this._constraints}setConstraints(t){t!==this._constraints&&(this._constraints=t,this._freezeRotation!==!!(t&UnityEngine.RigidbodyConstraints2D.FreezeRotation)&&this._body.setFixedRotation(this._freezeRotation=!this._freezeRotation),this._freezeX!==!!(t&UnityEngine.RigidbodyConstraints2D.FreezePositionX)&&this._body.setFixedX(this._freezeX=!this._freezeX),this._freezeY!==!!(t&UnityEngine.RigidbodyConstraints2D.FreezePositionY)&&this._body.setFixedY(this._freezeY=!this._freezeY))}getCenterOfMass(){const t=this._body.getLocalCenter();return new s.j(t.x,t.y)}setCenterOfMass(t){_.set(t.x,t.y),this._body.setLocalCenter(_)}moveRotation(t){this._freezeRotation||(t*=s.d,this._body.setAngularVelocity((t-this._body.getAngle())/this._world.getLastTimeStep()))}movePosition(t){this._body.setPosition(new planck.Vec2(t.x,t.y))}wakeUp(){this._body.setAwake(!0)}getSharedMaterial(){return this._body._material}setSharedMaterial(t){const e=this._body;e._material=t;let i=e.getFixtureList();if(!i._isFaux)for(t=t||this.system.app.systems.collider2D.defaultMaterial;i;i=i.getNext()){if(!i)continue;const e=i._component;if(!e._material){const n=e._fixtureDef;n.friction=t.friction,n.restitution=t.bounciness,i.setFriction(t.friction),i.setRestitution(t.bounciness)}}}getAttachedColliderCount(){let t=this.body.getFixtureList(),e=0;for(;t;)e++,t=t.getNext();return e}getAttachedColliders(t){let e=this.body.getFixtureList(),i=0;for(;i<t.length&&e;)t[i]=e,i++,e=e.getNext();return i}}u.setBodyTransform=(t,e,i)=>{if(_.set(e.x,e.y),i*=s.d,t.getPosition().closeTo(_)){const e=(i-t.getAngle())/(2*Math.PI);if(Math.abs(Math.round(e)-e)<=o)return}t.setTransform(_,i),t.dirtifyTransform(!1)},u.setEntityTransform=(t,e)=>{if(!t.isDirtyTransform())return;const i=t.getTransform(),n=e.getPosition();_.set(n.x,n.y),e.getRotation().getEulerAngles(d);const r=i.q.getAngle()*s.i;Math.abs(r-d.z)>o&&(l.setFromEulerAngles(d.x,d.y,r),e.setRotation(l)),_.closeTo(i.p)||e.setPosition(i.p.x,i.p.y,n.z),t.dirtifyTransform(!1)},u.setDensity=(t,e)=>{t._density=e;for(let i=t.getFixtureList();i;i=i.getNext())i.setDensity(e);t.resetMassData()};const g=.005,y=planck.Math.EPSILON,f=new planck.Vec2,p=new s.k;let m=0,C=null;const x=new s.k,D=new s.k;let b=null;class A extends n.j{constructor(t={}){super(),this._enabled=void 0===t.enabled||t.enabled,this._fixtureDef=t.fixture||{active:!1},this._shape=t.shape||null,this._isTrigger=!!t.isTrigger,this._usedByEffector=!!t.usedByEffector,this._density=t.density>=0?t.density:1,this._offset=this._offset||t.offset,this._type=t.type||"collider2D",this._disabledContacts=[],this._vertices=null,this._vertices2D=null,this._relativePosition=new s.k(0,0,0),this._accumulatedScale=new s.k(1,1,1),this._adapter=n.a.getApplication().systems.physics2D.adapter,this._material=t.material||null,this._material&&(this._fixtureDef.friction=this._material.friction,this._fixtureDef.restitution=this._material.bounciness),this._fixtureDef.isSensor=this._isTrigger,this._contacts={},this._body=null,this._fixture=null,this._worldTransformVersion=-1,this["__UnityEngine.Collider2D"]=null,pc.markPhysics2dModuleAsUsed()}get code(){return this._code||this._initializeCode(),this._code}get shape(){return this._shape}get type(){return this._type}_initializeCode(){this._code&&(this["__UnityEngine.Collider2D"]=this._code,this._code.handle=this)}onEnable(){return!!super.onEnable()&&(this._adapter.enableCollider(this),!0)}onDisable(){return!!super.onDisable()&&(this._adapter.disableCollider(this),!0)}onDestroy(){if(!super.onDestroy())return!1;if(this.onDisable(),this._fixture){const t=this._fixture.getBody();t.destroyFixture(this._fixture),t._component&&!t.getFixtureList()&&t._component.createFauxFixture(),this._fixture=null}return!0}addFixture(t){if(this._fixture){const e=this._fixture.getBody();if(e===t)return;e.destroyFixture(this._fixture),this._fixture=null}else{const e=t.getFixtureList();e&&e._isFaux&&t.destroyFixture(e)}const e=t._component&&t._component.useCollidersDensity;if(this._fixtureDef.density=e?this._density:t._density,!this._material){const e=t._material||this._system.defaultMaterial;this._fixtureDef.friction=e.friction,this._fixtureDef.restitution=e.bounciness}this._fixture=t.createFixture(this._shape,this._fixtureDef),this._fixture._component=this,this._body=t}updateShape(t,e,i=null){t.getTranslation(this._relativePosition),this._accumulatedScale.copy(e),i&&i!==this._body||this._updateShapeSizeAndPosition()}_updateShapeSizeAndPosition(t=!1){const e=this._fixture;e&&(e.createProxies(),this._resetMassData())}_resetMassData(){this._resetBodyMassData(this._fixture.getBody())}_resetBodyMassData(t){if(t.resetMassData(),t.fixturesAreBlank()||t.isStatic()||t.isKinematic()||t._component&&t._component.useCollidersDensity)return t.setDefaultMass(t.getMass()),void t.setAwake(!0);const e=this._fixtureDef.density=t.getDefaultMass()/t.getMass()*t._density;u.setDensity(t,e),t.setAwake(!0)}_transformVertices(){const t=this._entity.getWorldTransform(),e=this._vertices,i=this._vertices2D;let n=!1;const s=this._getAngle2D(),o=Math.cos(s),r=Math.sin(s),a=this._relativePosition;for(let s=e.length,c=0;c<s;++c){p.copy(e[c]),t.transformVector(p,p).add(a);const s=i[c];f.set(p.x,p.y).rotate(o,r).closeTo(s)||(s.set(f),n=!0)}return n}_getAngle2D(){return-(this._body._entity||this._body._component._entity).getEulerAngles().z*s.d}enable(){this._fixtureDef.active=!0,this._fixture&&(this._fixture.setActive(!0),this._resetMassData())}disable(){this._fixtureDef.active=!1,this._fixture&&(this._fixture.setActive(!1),this._resetMassData())}addContact(t,e){this._contacts[e]=t}removeContact(t){this._contacts&&delete this._contacts[t]}_getContacts(){return this._contacts}overlapPoint(t){return!!this._fixture&&this._fixture.testPoint(f.set(t.x,t.y))}getContactedColliders(t){if(!t||0===t.length)return 0;let e=0;for(const i in this._contacts){if(e>=t.length)break;if(!this._contacts.hasOwnProperty(i))continue;const n=this._contacts[i],s=n.getFixtureA(),o=n.getFixtureB();if(!s.getBody()||!o.getBody())continue;const r=s._component,a=o._component;s===this._fixture?t[e++]=a.code:o===this._fixture&&(t[e++]=r.code)}return e}getContactedContacts(t){if(!t||0===t.length)return 0;let e=0;for(const i in this._contacts){e=this._contacts[i].populateContactsArray(t,e)}return e}getIsTrigger(){return this._isTrigger}setIsTrigger(t){t=!!t,this._isTrigger!==t&&(this._fixtureDef.isSensor=this._isTrigger=t,this._fixture&&this._fixture.setSensor(t))}getIsUsedByEffector(){return this._usedByEffector}setIsUsedByEffector(t){this._usedByEffector=!!t}getOffset(){return this._offset.clone()}setOffset(t){throw new Error("Not Implemented")}getShapeCount(){return 1}overlapCollider(t,e){return e&&0!==e.length&&this._fixture?(m=0,C=e,this._fixture.queryOverlaps(this._reportOverlap),C=null,m):0}_reportOverlap(t){return!!t._isFaux||(C[m++]=t._component.code,m<C.length)}getDistance(t){const e=new UnityEngine.ColliderDistance2D;if(!t||!t._fixture||!this._fixture)return e;const i=this._adapter.world.getDistance(this._fixture,t._fixture);if(null===i)return e;let n=i.pointA,s=i.pointB;return n=e.pointA.set(n.x,n.y),s=e.pointB.set(s.x,s.y),e.distance=i.distance,e.normal.copy(n).sub(s).normalize(),e.isValid=!0,e}getBounds(){const t=new UnityEngine.Bounds;if(!this._fixture||!this._fixtureDef.active)return t;const e=this._fixture.getProxyCount();if(e<1)return t;b=b||new planck.AABB,b.set(this._fixture.getAABB(0));for(let t=1;t<e;++t)b.combine(b,this._fixture.getAABB(t));const i=this._entity.getPosition().z;return x.set(b.lowerBound.x,b.lowerBound.y,i),D.set(b.upperBound.x,b.upperBound.y,i),t.setMinMax(x,D),t}getDensity(){return this._density}setDensity(t){if(this._density===t)return;const e=this._body;if(e&&e._component&&!e._component.useCollidersDensity)return void UnityEngine.Debug.LogWarningFormat("Density cannot be set on the collider unless it is attached to a dynamic rigid-body that is using auto-mass.");this._fixtureDef.density=this._density=t=t>=0?t:0;const i=this._fixture;i&&(i.setDensity(t),this._resetBodyMassData(i.getBody()))}getSharedMaterial(){return this._material}setSharedMaterial(t){this._material=t,t||(this._body&&(t=this._body._material),t=t||this._system.defaultMaterial);const e=this._fixtureDef;e.friction=t.friction,e.restitution=t.bounciness;const i=this._fixture;i&&(i.setFriction(t.friction),i.setRestitution(t.bounciness))}}class S extends n.i{constructor(t){super(t),this.id="collider2D",this.performanceSamplerSection=n.d.PHYSICS2D,this._physics2DSystem=n.a.getApplication().systems.physics2D}removeComponent(t,e){e.onDestroy(),super.removeComponent(t,e)}get defaultMaterial(){return this._physics2DSystem.defaultMaterial}set defaultMaterial(t){this._physics2DSystem.defaultMaterial=t}}class w extends n.i{constructor(t){super(t),this.id="rigidbody2D",this.performanceSamplerSection=n.d.PHYSICS2D,this._physics2DSystem=n.a.getApplication().systems.physics2D}removeComponent(t,e){e.onDestroy(),super.removeComponent(t,e)}get adapter(){return this._physics2DSystem.adapter}}const T=["onFixedUpdate"],M=new planck.Vec2;class j extends n.j{constructor(t){if(super(),this.constraint={active:!1},this._jointDef=this.constraint,t){this._enabled=!!t.enabled,this._enableCollision=!!t.enableCollision;const e=t.breakForce,i=t.breakTorque;this._breakForce=Number.isFinite(e)&&e>=0?e:1/0,this._breakTorque=Number.isFinite(i)&&i>=0?i:1/0}else this._enabled=!0,this._enableCollision=!1,this._breakForce=1/0,this._breakTorque=1/0;this._attachedRigidbody=null,this._connectedBody=null,this._joint=null,this._type="",this._breakForceSq=this._breakForce*this._breakForce,this._adapter=n.a.getApplication().systems.physics2D.adapter,this._world=this._adapter.world,this._dt=0,pc.markPhysics2dModuleAsUsed()}get sortingOrderInQueue(){return this._sortingOrderInQueue}get code(){return this._code||this._initializeCode(),this._code}get joint(){return this._joint}get type(){return this._type}_initializeCode(){this._code&&(this["__UnityEngine.Joint2D"]=this._code,this._code.handle=this)}onEnable(){return!!super.onEnable()&&(this._adapter.enableConstraint(this),!0)}onDisable(){return!!super.onDisable()&&(this._adapter.disableConstraint(this),!0)}onDestroy(){return!!super.onDestroy()&&(this.onDisable(),this._joint&&(this._world.destroyJoint(this._joint),this._joint=null),!0)}_queuesToSubscribe(){return T}onFixedUpdate(t){if(this._joint){if(this._dt=t,this._breakTorque<1/0){if(this._joint.getReactionTorque(1/t)>this._breakTorque)return void this.onDestroy()}if(this._breakForce<1/0){this._joint.getReactionForce(1/t,M).lengthSquared()>this._breakForceSq&&this.onDestroy()}}}createJoint(){if(this._joint)return;this._connectedBody=this.code.connectedBody;let t=this._connectedBody&&this._connectedBody.handle.body;const e=this.getAttachedRigidbody().handle.body;t||(t=this._adapter.getWorldBody()),this._joint=this._createJoint(e,t),this._joint._component=this}_createJointDef(t,e){const i=this._jointDef;return i.bodyA=t,i.bodyB=e,i.active=this.enabled,i.collideConnected=this._enableCollision,i}_createJoint(t,e){throw new Error("Not implemented")}update(){}enable(){this._jointDef.active=!0,this._joint&&this._joint.setActive(!0)}disable(){this._jointDef.active=!1,this._joint&&this._joint.setActive(!1)}getEnableCollision(){return this._enableCollision}setEnableCollision(t){this._enableCollision=!!t,this._joint&&this._joint.setCollideConnected(t)}getAttachedRigidbody(){if(this._attachedRigidbody)return this._attachedRigidbody;const t=this._entity._unityComponents.rigidbody2D[0];return this._attachedRigidbody=UnityEngine.Object.FromHandle(UnityEngine.Rigidbody2D,t),this._attachedRigidbody}getConnectedBody(){return this._connectedBody}setConnectedBody(t){this._connectedBody!==t&&(this._connectedBody=t,this._joint&&this._joint.setBodyB(t?this._connectedBody.handle.body:this._adapter.getWorldBody()))}getBreakForce(){return this._breakForce}setBreakForce(t){t<0&&(t=0),this._breakForce=t,this._breakForceSq=t*t}getBreakTorque(){return this._breakTorque}setBreakTorque(t){this._breakTorque=t<0?0:t}getReactionForce(t){if(t<=0||!this._joint)return new s.j;const e=this._joint.getReactionForce(1/t,M);return new s.j(e.x,e.y)}getFrameReactionForce(){if(0===this._dt||!this._joint)return new s.j;const t=this._joint.getReactionForce(1/this._dt,M);return new s.j(t.x,t.y)}getReactionTorque(t){return t>0&&this._joint?this._joint.getReactionTorque(1/t):0}getFrameReactionTorque(){return this._dt>0&&this._joint?this._joint.getReactionTorque(1/this._dt):0}}class E extends j{constructor(t){super(t),t?(this._autoConfigureConnectedAnchor=!!t.autoConfigureConnectedAnchor,this._connectedAnchor=t.connectedAnchor,this._anchor=t.anchor):(this._autoConfigureConnectedAnchor=!0,this._connectedAnchor=new s.j,this._anchor=s.j.ZERO)}_initializeCode(){this._code&&(this["__UnityEngine.AnchoredJoint2D"]=this._code),super._initializeCode()}_createJointDef(t,e){const i=super._createJointDef(t,e);i.localAnchorA=new planck.Vec2(this._anchor.x,this._anchor.y);const n=new planck.Vec2(this._connectedAnchor.x,this._connectedAnchor.y);return this._autoConfigureConnectedAnchor?(i.localAnchorB=this._getConnectedAnchor(t,e,i.localAnchorA,n),this._connectedAnchor.set(n.x,n.y)):i.localAnchorB=n,i}_getConnectedAnchor(t,e,i,n){return e.getLocalPoint(t.getWorldPoint(i,n),n)}getAutoConfigureConnectedAnchor(){return this._autoConfigureConnectedAnchor}setAutoConfigureConnectedAnchor(t){this._autoConfigureConnectedAnchor=!!t}getAnchor(){return this._anchor.clone()}setAnchor(t){this._anchor.equals(t)||(this._anchor=t,this._joint&&this._joint.setLocalAnchorA(this._joint.getLocalAnchorA().set(t.x,t.y)))}getConnectedAnchor(){return this._connectedAnchor.clone()}setConnectedAnchor(t){this._joint&&this.enabled?this._autoConfigureConnectedAnchor||this._connectedAnchor.equals(t)||(this._connectedAnchor=t,this._joint&&this._joint.setLocalAnchorB(this._joint.getLocalAnchorB().set(t.x,t.y))):this._connectedAnchor=t}update(){if(!this._autoConfigureConnectedAnchor)return;const t=this._joint;if(!t)return;const e=t.getBodyA(),i=t.getBodyB();(e._isEntityTransformed||i._isEntityTransformed)&&this._resetConnectedAnchor(t,e,i)}_updateConnectedAnchor(){if(!this._autoConfigureConnectedAnchor)return;const t=this._joint;t&&this._resetConnectedAnchor(t,t.getBodyA(),t.getBodyB())}_resetConnectedAnchor(t,e,i){const n=t.getLocalAnchorB();t.setLocalAnchorB(this._getConnectedAnchor(e,i,t.getLocalAnchorA(),n)),this._connectedAnchor.set(n.x,n.y)}setConnectedBody(t){this._connectedBody!==t&&(super.setConnectedBody(t),this.enabled&&this._updateConnectedAnchor())}enable(){super.onEnable(),this._updateConnectedAnchor()}}class B extends n.i{constructor(t){super(t),this.id="joint2D",this.performanceSamplerSection=n.d.PHYSICS2D}removeComponent(t,e){e.onDestroy(),super.removeComponent(t,e)}}class R extends n.j{constructor(t){super(),t?(this._enabled=!!t.enabled,this._useColliderMask=!!t.useColliderMask,this.colliderMask=t.colliderMask):(this._enabled=!0,this._useColliderMask=!1,this.colliderMask=0),this._adapter=n.a.getApplication().systems.physics2D.adapter,pc.markPhysics2dModuleAsUsed()}get useColliderMask(){return this._useColliderMask}set useColliderMask(t){this._useColliderMask=t}_initializeCode(){this._code&&(this["__UnityEngine.Effector2D"]=this._code,this._code.handle=this)}onEnable(){return!!super.onEnable()&&(this._adapter.enableEffector(this),!0)}onBeforeCollision2D(t){const e=t.getFixtureA(),i=t.getFixtureB(),n=e._component._body.getLinearVelocity(),s=i._component._body.getLinearVelocity();n.y+s.y>0&&t.setEnabled(!1)}onDisable(){return!!super.onDisable()&&(this._adapter.disableEffector(this),!0)}onDestroy(){return!!super.onDestroy()&&(this.onDisable(),!0)}}class F extends n.i{constructor(t){super(t),this.id="effector2D",this.performanceSamplerSection=n.d.PHYSICS2D}removeComponent(t,e){e.onDestroy(),super.removeComponent(t,e)}}var z=i(27);const v=new s.k,k=new s.k;class O extends z.a{constructor(t){super(t),this._effectors2d=new Map}setup(){this._world=this.options.world,this._newContacts={},this._contacts={},this._oldContacts={},this._disabledContacts={},this._world.on("begin-contact",this._onBeginContact.bind(this)),this._world.on("end-contact",this._onEndContact.bind(this)),this._world.on("pre-solve",this._onPresolve.bind(this))}addRigidbody(t){t.setActive(!0),this.preSimulationSynchronization(t._component||t,z.a.PreSyncStages.TransformToPhysics)}removeRigidbody(t){for(let e=t.getFixtureList();e;e=e.getNext())e._component&&this._exitContacts(e._component);t.setActive(!1)}_exitContacts(t){const e=t._getContacts();if(e)for(const t in e){if(!e.hasOwnProperty(t))continue;const i=e[t];i._childContactsCount=0,this._onEndContact(i)}}destroyRigidbody(t){this._world.destroyBody(t)}addCollider(t,e){e.addFixture(t),e.enable(),this.preSimulationSynchronizationForCollider(e)}removeCollider(t,e){this._exitContacts(e),e.disable(),this._clearDisabledContacts(e)}_clearDisabledContacts(t){const e=t._disabledContacts;if(e){for(let t=0,i=e.length;t<i;++t)delete this._disabledContacts[e[t]];e.length=0}}addConstraint(t){t.createJoint(),t.enable()}removeConstraint(t){t.disable()}onSimulationStep(t){this._world.step(t)}getAttachedColliders(t){return t._unityComponents.collider2D}getAttachedRigidbody(t){const e=t._unityComponents.rigidbody2D[0];return e&&e.enabled&&e.getSimulated()&&!e.destroyed?e._body:null}attachFauxRigidbody(t){const e=this.createWorldBody();return e._body=e,e._entity=t,this.addRigidbody(e),e}getRelTransformAndAccumScale(t,e,i,n){const o=t._component?t._component._entity:e._entity,r=e._entity.getWorldTransform(),a=o.getWorldTransform();o===e._entity?i.setTranslation(s.k.ZERO):(r.getTranslation(k),a.getTranslation(v),k.sub(v),i.setTranslation(k)),r.getScale(n).abs()}synchronizeBodyWithEntity(t){const e=t._entity,i=t._body;i.setLayer(e.cullingLayer),i.setLayerMask(e.layerMask);const n=e.getPosition(),s=e.getEulerAngles();u.setBodyTransform(i,n,s.z)}synchronizeEntityWithBody(t){u.setEntityTransform(t._body,t._entity)}updateConstraint(t){t.update()}preSimulationSynchronization(t,e){if(e!==z.a.PreSyncStages.TransformToPhysics)return;const i=t._entity;if(t._worldTransformVersion===i.aabbVersion)return;this.synchronizeBodyWithEntity(t),t._worldTransformVersion=i.aabbVersion;t._body._isEntityTransformed=!0}postSimulationSynchronization(t){t._body._isEntityTransformed=!1;const e=t._entity,i=t._worldTransformVersion!==e.aabbVersion;if(t.getIsKinematic()){if(i)return void this.synchronizeBodyWithEntity(t)}else if(t.getIsStatic()&&!i)return;this.synchronizeEntityWithBody(t)}preSimulationSynchronizationForCollider(t){super.preSimulationSynchronizationForCollider(t),t._body.setLayer(t._entity.cullingLayer),t._body.setLayerMask(1<<t._entity.cullingLayer)}_onBeginContact(t){const e=this._getContactUid(t),i=this._contacts[e]||this._newContacts[e];i?i._childContactsCount++:(t._childContactsCount=1,this._newContacts[e]=t)}_onEndContact(t){const e=this._getContactUid(t),i=this._contacts[e];i&&--i._childContactsCount<=0&&(this._oldContacts[e]=i)}_onPresolve(t){const e=t.getFixtureA()._component,i=t.getFixtureB()._component;if(e._usedByEffector){const i=this._effectors2d.get(e._entity._guid);i&&i.onBeforeCollision2D(t)}else if(i._usedByEffector){const e=this._effectors2d.get(i._entity._guid);e&&e.onBeforeCollision2D(t)}}_getContactUid(t){return this._getCollidersUid(t.getFixtureA()._component,t.getFixtureB()._component)}_getCollidersUid(t,e){const i=t._id,n=e._id;return i>n?i+":"+n:n+":"+i}handleContacts(){this._triggerNewContacts(),this._triggerPersistentContacts(),this._removeNewContacts(),this._triggerOldContacts()}_triggerNewContacts(){for(const t in this._newContacts)this._contacts[t]||this._triggerContactCallback("Enter",this._newContacts[t],t,!0)}_triggerPersistentContacts(){for(const t in this._contacts)this._triggerContactCallback("Stay",this._contacts[t],t)}_removeNewContacts(){for(const t in this._newContacts)this._contacts[t]=this._newContacts[t],delete this._newContacts[t]}_triggerOldContacts(){for(const t in this._oldContacts){const e=this._oldContacts[t];e.getFixtureA()._component.removeContact(t),e.getFixtureB()._component.removeContact(t),this._triggerContactCallback("Exit",e,t),delete this._oldContacts[t],delete this._contacts[t]}}_triggerContactCallback(t,e,i,n=!1){if(this._disabledContacts[i])return;const s=e.getFixtureA(),o=s.getBody();if(!o)return;const r=e.getFixtureB(),a=r.getBody();if(!a)return;const c=s._component,h=r._component;if(c._isTrigger||h._isTrigger){const e="OnTrigger"+t+"2D";this.dispatchContact(c._entity,e,h.code);let i=o._component;i&&c._entity!==i._entity&&this.dispatchContact(i._entity,e,h.code),this.dispatchContact(h._entity,e,c.code),i=a._component,i&&h._entity!==i._entity&&this.dispatchContact(i._entity,e,c.code)}else{n&&(c.addContact(e,i),h.addContact(e,i));const s="OnCollision"+t+"2D";this.dispatchContact(c._entity,s,UnityEngine.Object.FromHandle(UnityEngine.Collision2D,e).ConfigureFor(0));let r=o._component;r&&c._entity!==r._entity&&this.dispatchContact(r._entity,s,UnityEngine.Object.FromHandle(UnityEngine.Collision2D,e).ConfigureFor(0)),this.dispatchContact(h._entity,s,UnityEngine.Object.FromHandle(UnityEngine.Collision2D,e).ConfigureFor(1)),r=a._component,r&&h._entity!==r._entity&&this.dispatchContact(r._entity,s,UnityEngine.Object.FromHandle(UnityEngine.Collision2D,e).ConfigureFor(1))}}ignoreCollision(t,e,i){if(!t.entity._enabledInHierarchy||!e.entity._enabledInHierarchy)return;const n=this._getCollidersUid(t,e);this._disabledContacts[n]=i,i&&(t._disabledContacts=t._disabledContacts||[],e._disabledContacts=e._disabledContacts||[],t._disabledContacts.push(n),e._disabledContacts.push(n))}getWorldBody(){return this._worldBody||(this._worldBody=this.createWorldBody()),this._worldBody}createWorldBody(){const t=this._world.createBody({type:planck.Body.STATIC,userData:{isWorldBody:!0}});return t.equals=function(e){return e===t||e&&(e=e.getUserData())&&e.isWorldBody},t}enableEffector(t){this._effectors2d.set(t._entity._guid,t)}disableEffector(t){this._effectors2d.delete(t._entity._guid)}get world(){return this._world}}let U=0,P=0,q=0,J=0;const L=new planck.Vec2,V=new planck.Vec2;let I,N=0,W={},H=[],Y=0,Z=0;class K extends n.i{constructor(t){super(t),this.id="physics2D",this.performanceSamplerSection=n.d.PHYSICS2D,this._defaultMaterial=new UnityEngine.PhysicsMaterial2D,this._defaultMaterial.friction=.4,this._defaultMaterial.bounciness=0,this._autoSyncTransforms=!1,this._gravity=new s.j(0,-9.81),this._world=new planck.World({gravity:new planck.Vec2(this._gravity.x,this._gravity.y)}),this._adapter=new O({world:this._world}),K._world=this._world,K._adapter=this._adapter}onFixedUpdate(t){this._adapter.onFixedUpdate(t)}setIgnoreCollisionBetweenLayers(t,e,i){this._adapter.setIgnoreCollisionBetweenLayers(t,e,i)}syncHierarchy(t){this._adapter.syncHierarchy(t)}syncTransforms(t){this._autoSyncTransforms&&this._adapter.syncTransforms(t)}get adapter(){return this._adapter}get gravity(){return this._gravity}set gravity(t){this._gravity=t;const e=this._world.getGravity();e.x=t.x,e.y=t.y,this._world.setGravity(e)}get defaultMaterial(){return this._defaultMaterial}set defaultMaterial(t){t&&(this._defaultMaterial=t)}get autoSyncTransforms(){return this._autoSyncTransforms}set autoSyncTransforms(t){this._autoSyncTransforms=t}get velocityIterations(){return this._world.getVelocityIterations()}set velocityIterations(t){this._world.setVelocityIterations(t>0?t:1)}get positionIterations(){return this._world.getPositionIterations()}set positionIterations(t){this._world.setPositionIterations(t>0?t:1)}}function X(t,e,i,n){return n>=P||$(t)?P:(P=n,I.collider=t._component.code,I.fraction=(I.distance=n*q)/J,I.m_Normal.set(i.x,i.y),I.m_Point.set(e.x,e.y),I.m_Centroid.set(e.x,e.y),n)}function $(t){if(t._isFaux)return!0;const e=t._component._entity;if(!(e.layerMask&U))return!0;const i=e.getPosition().z;return i<Y||Z<i}function G(t){return t===Number.POSITIVE_INFINITY?3402823e32:t===Number.NEGATIVE_INFINITY?-3402823e32:t}function Q(t,e,i,n){if($(t))return 1;let s=H.length;for(H.push(new UnityEngine.RaycastHit2D),et(s,t,e,i,e,(n*=q)/J,n);s>0&&!(H[s].fraction>=H[s-1].fraction);--s)it(s,s-1);return 1}function tt(t,e,i,n){if($(t))return 1;const s=n*q;let o;if(n=s/J,N<H.length)o=N++;else if(n>=H[o=H.length-1].fraction)return 1;for(et(o,t,e,i,e,n,s);o>0&&!(n>=H[o-1].fraction);--o)it(o,o-1);return 1}function et(t,e,i,n,s,o,r){const a=H[t];a.collider=e._component.code,a.fraction=o,a.distance=r,a.m_Normal.set(n.x,n.y),a.m_Point.set(i.x,i.y),a.m_Centroid.set(s.x,s.y)}function it(t,e){const i=H[t];H[t]=H[e],H[e]=i}function nt(t){if($(t))return 1;const e=t._component;return(!I||e._entity.getPosition().z<I.handle._entity.getPosition().z)&&(I=e.code),1}function st(t){if($(t))return 1;let e=H.length;const i=t._component,n=i._entity.getPosition().z;for(H.push(i.code);e>0&&!(n>=H[e-1].handle._entity.getPosition().z);--e)it(e,e-1);return 1}function ot(t){if($(t))return 1;let e;const i=t._component,n=i._entity.getPosition().z;if(N<H.length)e=N++;else if(n>=H[e=H.length-1].handle._entity.getPosition().z)return 1;for(H[e]=i.code;e>0&&!(n>=H[e-1].handle._entity.getPosition().z);--e)it(e,e-1);return 1}function rt(t){const e=t.fixture;if($(e))return 1;const i=e._component._id;let n=W[i];if(n>=0){if(t.fraction>=H[n].fraction)return 1}else n=H.length,H.push(new UnityEngine.RaycastHit2D);for(et(n,e,t.point,t.normal,t.centroid,t.fraction,t.distance);n>0&&!(H[n].fraction>=H[n-1].fraction);--n)it(n,n-1),W[H[n].collider.handle._id]=n;return W[i]=n,1}function at(t,e){const i=.5*t.x;let n=.5*t.y;const s=new planck.Vec2,o=new planck.Vec2;e===UnityEngine.CapsuleDirection2D.Vertical?(s.set(0,-n),o.set(0,n)):(s.set(-n,0),o.set(n,0)),n<=0&&(n=i);const r=Math.max(planck.Math.EPSILON,1-i/n);return s.mul(r),o.mul(r),{vertex1:s,vertex2:o,radius:i}}function ct(t,e){if(e>P)return P;const i=t.fixture;if($(i))return P;P=e,I.collider=i._component.code,I.fraction=t.fraction,I.distance=t.distance;const n=t.normal;I.m_Normal.set(n.x,n.y);const s=t.point;I.m_Point.set(s.x,s.y);const o=t.centroid;return I.m_Centroid.set(o.x,o.y),P}function ht(t){const e=t.fixture;if($(e))return 1;const i=e._component._id;let n=W[i];if(n>=0){if(t.fraction>=H[n].fraction)return 1}else if(N<H.length)n=N++;else{if(n=H.length-1,t.fraction>=H[n].fraction)return 1;W[H[n].collider.handle._id]=-1}for(et(n,e,t.point,t.normal,t.centroid,t.fraction,t.distance);n>0&&!(t.fraction>=H[n-1].fraction);--n)it(n,n-1),W[H[n].collider.handle._id]=n;return W[i]=n,1}K._world=null,K._adapter=null,K.raycast=(t,e,i,n,s,o)=>{i=G(i),L.set(t.x,t.y);const r=V.set(e.x,e.y);J=r.normalize(),0===J&&(J=1),V.mul(i),V.add(L),q=i,U=n,Y=s,Z=o,P=1/0;const a=I=new UnityEngine.RaycastHit2D;return K._world.rayCast(L,V,X),I=null,a},K.linecast=(t,e,i,n,s)=>{L.set(t.x,t.y),V.set(e.x,e.y),q=planck.Vec2.distance(L,V),J=q,0===J&&(J=1),U=i,Y=n,Z=s,P=1;const o=I=new UnityEngine.RaycastHit2D;return K._world.rayCast(L,V,X),I=null,o},K.raycastAll=(t,e,i,n,s,o)=>{i=G(i),L.set(t.x,t.y);const r=V.set(e.x,e.y);J=r.normalize(),0===J&&(J=1),V.mul(i),V.add(L),q=i,U=n,Y=s,Z=o;const a=H=[];return K._world.rayCast(L,V,Q),H=null,a},K.raycastNonAlloc=(t,e,i,n,s,o,r)=>i&&0!==i.length?(n=G(n),L.set(t.x,t.y),V.set(e.x,e.y),J=V.normalize(),0===J&&(J=1),V.mul(n),V.add(L),q=n,U=s,Y=o,Z=r,N=0,H=i,K._world.rayCast(L,V,tt),H=null,N):0,K.overlapCircle=(t,e,i,n,s)=>{L.set(t.x,t.y),U=i,Y=n,Z=s,I=null,K._world.queryCircle(L,e,nt);const o=I;return I=null,o},K.overlapCircleAll=(t,e,i,n,s)=>{L.set(t.x,t.y),U=i,Y=n,Z=s;const o=H=[];return K._world.queryCircle(L,e,st),H=null,o},K.overlapCircleNonAlloc=(t,e,i,n,s,o)=>i&&0!==i.length?(L.set(t.x,t.y),U=n,Y=s,Z=o,N=0,H=i,K._world.queryCircle(L,e,ot),H=null,N):0,K.overlapBox=(t,e,i,n,s,o)=>{L.set(t.x,t.y),U=n,Y=s,Z=o,I=null,K._world.queryBox(L,e,i,nt);const r=I;return I=null,r},K.overlapPoint=(t,e,i,n)=>{V.set(L.set(t.x,t.y)),U=e,Y=i,Z=n,I=null,K._world.rayCast(L,V,nt);const s=I;return I=null,s},K.overlapPointAll=(t,e,i,n)=>{V.set(L.set(t.x,t.y)),U=e,Y=i,Z=n;const s=H=[];return K._world.rayCast(L,V,st),H=null,s},K.overlapPointNonAlloc=(t,e,i,n,s)=>e&&0!==e.length?(V.set(L.set(t.x,t.y)),U=i,Y=n,Z=s,N=0,H=e,K._world.rayCast(L,V,ot),H=null,N):0,K.ignoreCollision=(t,e,i)=>{K._adapter.ignoreCollision(t,e,i)},K.circleCastAll=(t,e,i,n,s,o,r)=>{n=G(n),L.set(t.x,t.y);const a=V.set(i.x,i.y);U=s,Y=o,Z=r;const c=H=[];return W={},K._world.circleCast(L,e,a,n,rt),H=W=null,c},K.boxCastAll=(t,e,i,n,o,r,a,c)=>{o=G(o),L.set(t.x,t.y);const h=V.set(n.x,n.y);i*=s.d,U=r,Y=a,Z=c;const _=H=[];return W={},K._world.boxCast(L,.5*e.x,.5*e.y,i,h,o,rt),H=W=null,_},K.capsuleCastAll=(t,e,i,n,o,r,a,c,h)=>{r=G(r),L.set(t.x,t.y);const _=V.set(o.x,o.y);n*=s.d,U=a,Y=c,Z=h;const l=at(e,i),d=H=[];return W={},K._world.capsuleCast(L,l.vertex1,l.vertex2,l.radius,n,_,r,rt),H=W=null,d},K.circleCast=(t,e,i,n,s,o,r)=>{n=G(n),L.set(t.x,t.y);const a=V.set(i.x,i.y);U=s,Y=o,Z=r,P=1;const c=I=new UnityEngine.RaycastHit2D;return K._world.circleCast(L,e,a,n,ct),I=null,c},K.boxCast=(t,e,i,n,o,r,a,c)=>{o=G(o),L.set(t.x,t.y);const h=V.set(n.x,n.y);i*=s.d,U=r,Y=a,Z=c,P=1;const _=I=new UnityEngine.RaycastHit2D;return K._world.boxCast(L,.5*e.x,.5*e.y,i,h,o,ct),_},K.capsuleCast=(t,e,i,n,o,r,a,c,h)=>{r=G(r),L.set(t.x,t.y);const _=V.set(o.x,o.y);n*=s.d,U=a,Y=c,Z=h;const l=at(e,i);P=1;const d=I=new UnityEngine.RaycastHit2D;return K._world.capsuleCast(L,l.vertex1,l.vertex2,l.radius,n,_,r,ct),d},K.circleCastNonAlloc=(t,e,i,n,s,o,r,a)=>{if(!n||0===n.length)return 0;s=G(s),L.set(t.x,t.y);const c=V.set(i.x,i.y);return U=o,Y=r,Z=a,N=0,H=n,W={},K._world.circleCast(L,e,c,s,ht),H=W=null,N},K.boxCastNonAlloc=(t,e,i,n,o,r,a,c,h)=>{if(!o||0===o.length)return 0;r=G(r),L.set(t.x,t.y);const _=V.set(n.x,n.y);return i*=s.d,U=a,Y=c,Z=h,N=0,H=o,W={},K._world.boxCast(L,.5*e.x,.5*e.y,i,_,r,ht),H=W=null,N},K.capsuleCastNonAlloc=(t,e,i,n,o,r,a,c,h,_)=>{if(!r||0===r.length)return 0;a=G(a),L.set(t.x,t.y);const l=V.set(o.x,o.y);n*=s.d,U=c,Y=h,Z=_;const d=at(e,i);return N=0,H=r,W={},K._world.capsuleCast(L,d.vertex1,d.vertex2,d.radius,n,l,a,ht),H=W=null,N},K.getRayIntersectionAll=(t,e,i,n)=>{if(0===e.z)return[];i=G(i);const o=K.raycastAll(new s.j(t.x,t.y),new s.j(t.x,t.y),i,n,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY);for(let i=0;i<o.length;i++){const n=o[i],r=n.transform.position;if(Math.sign(r.z-t.z)!==Math.sign(e.z)){o.splice(i,1),i--;continue}const a=Math.abs((t.z-r.z)/e.z),c=new s.j(t.x+e.x*a,t.y+e.y*a);n.collider.OverlapPoint(c)?(n.point=c,n.distance=s.k.distance(t,new s.k(c.x,c.y,0)),n.fraction=n.distance,o[i]=n):(o.splice(i,1),i--)}return e.z>0?o.sort(((t,e)=>t.transform.position.z-e.transform.position.z)):o.sort(((t,e)=>e.transform.position.z-t.transform.position.z))},K.getRayIntersectionNonAlloc=(t,e,i,n,o)=>{if(!i||0===i.length||0===e.z)return 0;n=G(n);const r=K.raycastAll(new s.j(t.x,t.y),new s.j(e.x,e.y),n,o,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY);let a=0;for(let n=0;n<r.length&&a<i.length;n++){const o=r[n],c=o.transform.position;if(Math.sign(c.z-t.z)!==Math.sign(e.z))continue;const h=Math.abs((t.z-c.z)/e.z),_=new s.j(t.x+e.x*h,t.y+e.y*h);o.collider.OverlapPoint(_)&&(o.point=_,o.distance=s.k.distance(t,new s.k(_.x,_.y,0)),o.fraction=o.distance,i[a]=o,a++)}return e.z>0?i.sort(((t,e)=>t.transform===e.transform?0:null===t.transform?1:null===e.transform?-1:t.transform.position.z-e.transform.position.z)):i.sort(((t,e)=>t.transform===e.transform?0:null===t.transform?1:null===e.transform?-1:e.transform.position.z-t.transform.position.z)),a},K.isTouching=(t,e)=>{const i=t.handle,n=e.handle.$id;if(!i._contacts||i.$id===n)return!1;for(const t in i._contacts){if(!i._contacts.hasOwnProperty(t))continue;const e=i._contacts[t],s=e.getFixtureA(),o=e.getFixtureB(),r=s._component,a=o._component;if(r.$id===n||a.$id===n)return!0}return!1},pc.Collider2DComponent=A,pc.CapsuleCollider2DComponent=class extends A{constructor(t){(t=t||{}).type="capsuleCollider2D",super(t),this._offset=(new s.j).copy(t.center||s.j.ZERO),this._size=(new s.j).copy(t.size||s.j.ZERO).setFromMax(g,g),this._direction=t.direction||UnityEngine.CapsuleDirection2D.Vertical,this._vertices2D=[new planck.Vec2,new planck.Vec2,new planck.Vec2],this._vertices=[new s.k,new s.k,new s.k],this._vertex1=new planck.Vec2,this._vertex2=new planck.Vec2,this._radius=0,this._calculateVertices(),this._calculateShape(),this._shape=new planck.Capsule(this._vertex1,this._vertex2,this._radius),this["__UnityEngine.CapsuleCollider2D"]=null,TESTS&&pc.hiddenShapeValidator.addObjectToValidationSet(this,"CapsuleCollider2DComponent")}_calculateVertices(){const t=this._offset.x,e=this._offset.y,i=.5*this._size.x,n=.5*this._size.y,s=this._vertices2D,o=this._vertices;this._direction===UnityEngine.CapsuleDirection2D.Vertical?(s[0].set(t,e-n),s[1].set(t,e+n),s[2].set(t+i,e)):(s[0].set(t-n,e),s[1].set(t+n,e),s[2].set(t,e+i));for(let t=0,e=s.length;t<e;++t){const e=s[t];o[t].set(e.x,e.y,0)}}_calculateShape(){const t=this._vertices2D[0],e=this._vertices2D[1],i=this._vertices2D[2],n=t.x,s=t.y,o=e.x,r=e.y,a=.5*(n+o),c=.5*(s+r),h=i.x-a,_=i.y-c,l=Math.sqrt(h*h+_*_);this._radius=l;let d=n-a,u=s-c,g=Math.sqrt(d*d+u*u);g<=0&&(g=l);const f=Math.max(y,1-l/g);this._vertex1.x=a+f*d,this._vertex1.y=c+f*u,d=o-a,u=r-c,this._vertex2.x=a+f*d,this._vertex2.y=c+f*u}_initializeCode(){this._code=new UnityEngine.CapsuleCollider2D(this),this["__UnityEngine.CapsuleCollider2D"]=this._code,super._initializeCode()}_updateShapeSizeAndPosition(t=!1){(this._fixture||t)&&(this._transformVertices()||t)&&(this._calculateShape(),this._shape.setRadius(this._radius),this._shape.setVertex1(this._vertex1),this._shape.setVertex2(this._vertex2),super._updateShapeSizeAndPosition(t))}getSize(){return this._size.clone()}setSize(t){this._size.equals(t)||(this._size=t,this._calculateVertices(),this._updateShapeSizeAndPosition())}setOffset(t){this._offset.equals(t)||(this._offset=t,this._calculateVertices(),this._updateShapeSizeAndPosition())}getDirection(){return this._direction}setDirection(t){this._direction=t,this._calculateVertices(),this._updateShapeSizeAndPosition()}},pc.CircleCollider2DComponent=class extends A{constructor(t){(t=t||{}).type="circleCollider2D";const e=(new s.j).copy(t.center||s.j.ZERO);f.set(e.x,e.y);const i=t.radius=t.radius>0?t.radius:g,n=t.shape=new planck.Circle(f,i);super(t),this._shape=n,this._center=new s.k(f.x,f.y,0),this._vertices=[this._center],this._vertices2D=[n.m_p],this._radius=i,this._offset=e,this["__UnityEngine.CircleCollider2D"]=null,TESTS&&pc.hiddenShapeValidator.addObjectToValidationSet(this,"CircleCollider2DComponent")}_initializeCode(){this._code=new UnityEngine.CircleCollider2D(this),this["__UnityEngine.CircleCollider2D"]=this._code,super._initializeCode()}_updateShapeSizeAndPosition(t=!1){if(this._fixture||t){const e=this._transformVertices(),i=this._scaleRadius();(e||i||t)&&this._rebuild()}}_rebuild(){super._updateShapeSizeAndPosition(),this._shape.m_vertices=null}_scaleRadius(){const t=this._radius*Math.max(this._accumulatedScale.x,this._accumulatedScale.y),e=t-this._shape.getRadius();return!(-y<=e&&e<=y)&&(this._shape.setRadius(t),!0)}getRadius(){return this._radius}setRadius(t){this._radius!==t&&(this._radius=t,this._fixture&&this._scaleRadius()&&this._rebuild())}setOffset(t=s.j.ZERO){this._offset.equals(t)||(this._offset.copy(t),this._center.set(t.x,t.y,0),this._fixture&&this._transformVertices()&&this._rebuild())}},pc.BoxCollider2DComponent=class extends A{constructor(t){(t=t||{}).type="boxCollider2D";const e=(new s.j).copy(t.size||s.j.ZERO).setFromMax(g,g),i=(new s.j).copy(t.center||s.j.ZERO),n=new planck.Box(.5*e.x,.5*e.y,f.set(i.x,i.y));n.setRadius(t.radius),t.shape=n,super(t),this._offset=i,this._size=e;const o=this._vertices2D=n.m_vertices,r=this._vertices=new Array(o.length);for(let t=r.length,e=0;e<t;++e)r[e]=new s.k(o[e].x,o[e].y,0);this["__UnityEngine.BoxCollider2D"]=null,TESTS&&pc.hiddenShapeValidator.addObjectToValidationSet(this,"BoxCollider2DComponents")}_initializeCode(){this._code=new UnityEngine.BoxCollider2D(this),this["__UnityEngine.BoxCollider2D"]=this._code,super._initializeCode()}_updateShapeSizeAndPosition(t){(this._fixture||t)&&(this._transformVertices()||t)&&(this._shape._set(this._vertices2D),super._updateShapeSizeAndPosition(t))}getSize(){return this._size.clone()}setSize(t){let e=(t=t||s.j.ZERO).x,i=t.y;e<g&&(e=g),i<g&&(i=g),(t=this._size).x===e&&t.y===i||(this._size.set(e,i),this._rebuild(!0))}_rebuild(t=!1){this._shape._setAsBox(.5*this._size.x,.5*this._size.y,f.set(this._offset.x,this._offset.y));const e=this._vertices,i=this._vertices2D;for(let t=e.length,n=0;n<t;++n){const t=i[n];e[n].set(t.x,t.y,0)}this._updateShapeSizeAndPosition(t)}setOffset(t=s.j.ZERO){this._offset.equals(t)||(this._offset.copy(t),this._rebuild(!0))}getShapeCount(){return this._size.x<=g||this._size.y<=g?0:1}},pc.EdgeCollider2DComponent=class extends A{constructor(t){(t=t||{}).type="edgeCollider2D",super(t),this._points=null,this._init(t),this._shape=new planck.Chain(this._vertices2D,!1,t.radius),this["__UnityEngine.EdgeCollider2D"]=null,TESTS&&pc.hiddenShapeValidator.addObjectToValidationSet(this,"EdgeCollider2DComponent")}get edgeRadius(){return this._shape.getRadius()}set edgeRadius(t){this._shape.setRadius(t)}_initializeCode(){this._code=new UnityEngine.EdgeCollider2D(this),this["__UnityEngine.EdgeCollider2D"]=this._code,super._initializeCode()}_updateShapeSizeAndPosition(t=!1){(this._fixture||t)&&(!this._body||this._transformVertices()||t)&&(this._shape._createChain(this._vertices2D),super._updateShapeSizeAndPosition(t))}_init(t){this._offset=(new s.j).copy(t.offset||s.j.ZERO);const e=t.points||[],i=e.length,n=i/2,o=this._points=new Array(n),r=this._vertices=new Array(n),a=this._vertices2D=new Array(n),c=this._offset.x,h=this._offset.y;for(let t,n,_,l,d=0,u=0;d<i;d+=2,++u)t=e[d],n=e[d+1],_=c+t,l=h+n,o[u]=new s.j(t,n),a[u]=new planck.Vec2(_,l),r[u]=new s.k(_,l,0)}setOffset(t=s.j.ZERO){if(this._offset.equals(t))return;this._offset.copy(t);const e=this._points,i=this._vertices,n=t.x,o=t.y;for(let t=0,s=e.length;t<s;++t){const s=e[t];i[t].set(n+s.x,o+s.y,0)}this._updateShapeSizeAndPosition()}getPoints(){const t=this._points,e=t.length,i=new Array(e);for(let n=0;n<e;++n){const e=t[n];i[n]=new s.j(e.x,e.y)}return i}setPoints(t){let e,i,n,o,r,a=0;const c=(t=t||[]).length,h=this._offset.x,_=this._offset.y,l=this._vertices,d=this._vertices2D,u=this._points;for(let e=Math.min(c,l.length);a<e;++a)n=t[a],o=n.x,r=n.y,l[a].set(h+o,_+r,0),u[a].set(o,r);for(l.length=d.length=u.length=c;a<c;++a)n=t[a],o=n.x,r=n.y,e=h+o,i=_+r,d[a]=new planck.Vec2(e,i),l[a]=new s.k(e,i,0),u[a]=new s.j(o,r);this._updateShapeSizeAndPosition(!0)}getPointCount(){return this._vertices.length}},pc.PolygonCollider2DComponent=class extends A{constructor(t){(t=t||{}).type="polygonCollider2D",super(t),this._contours=null,this._points=null,this._init(t),this._shape=new planck.CompositePolygon(this._contours),this["__UnityEngine.PolygonCollider2D"]=null,TESTS&&pc.hiddenShapeValidator.addObjectToValidationSet(this,"PolygonCollider2DComponent")}_initializeCode(){this._code=new UnityEngine.PolygonCollider2D(this),this["__UnityEngine.PolygonCollider2D"]=this._code,super._initializeCode()}_updateShapeSizeAndPosition(t=!1){(this._fixture||t)&&(!this._body||this._transformVertices()||t)&&(this._shape._set(this._contours),super._updateShapeSizeAndPosition(t))}_init(t){this._offset=(new s.j).copy(t.offset||s.j.ZERO);const e=this._offset.x,i=this._offset.y,n=this._points=t.points||[],o=n.length,r=this._vertices=new Array(o),a=this._contours=new Array(o);for(let t=0;t<o;++t){const o=n[t]||[],c=o.length,h=c>>1,_=r[t]=new Array(h),l=a[t]=new Array(c);for(let t,n,r=0,a=0;r<c;r+=2,++a)t=l[r]=o[r]+e,n=l[r+1]=o[r+1]+i,_[a]=new s.k(t,n,0)}}_transformVertices(){let t=!1;const e=this._entity.getWorldTransform(),i=this._getAngle2D(),n=Math.cos(i),s=Math.sin(i),o=this._relativePosition,r=this._vertices,a=this._contours;for(let i=r.length,c=0;c<i;++c){const i=a[c],h=r[c];t=this._setContour(i,h,e,n,s,o)||t}return t}_transformContour(t){const e=this._entity.getWorldTransform(),i=this._getAngle2D(),n=Math.cos(i),s=Math.sin(i),o=this._relativePosition,r=this._contours[t],a=this._vertices[t];return this._setContour(r,a,e,n,s,o)}_setContour(t,e,i,n,s,o){let r=!1;for(let a=t.length,c=0,h=0;c<a;c+=2,++h)p.copy(e[h]),i.transformVector(p,p).add(o),f.set(p.x,p.y).rotate(n,s).closeToValues(t[c],t[c+1])||(t[c]=f.x,t[c+1]=f.y,r=!0);return r}setOffset(t){if(this._offset.equals(t=t||s.j.ZERO))return;this._offset.copy(t);const e=t.x,i=t.y,n=this._points,o=this._vertices;for(let t=0,s=n.length;t<s;++t){const s=n[t],r=o[t];for(let t=0,o=0,a=n.length;t<a;t+=2,++o)r[o].set(e+s[t],i+s[t+1],0)}this._updateShapeSizeAndPosition()}getPoints(){return 0===this._points.length?[]:this.getPath(0)}getPath(t){if(t>=this._points.length||t<0)throw new System.ArgumentOutOfRangeException.ctor;const e=this._points[t],i=e.length,n=new Array(i>>1);for(let t=0,o=0;t<i;t+=2,++o)n[o]=new s.j(e[t],e[t+1]);return n}setPoints(t){t&&0!==t.length&&this.setPath(0,t)}setPath(t,e){if(!e)throw new System.ArgumentNullException;const i=this._points,n=i.length;if(t>0&&t>=n||t<0)throw new System.ArgumentOutOfRangeException.ctor;const o=this._contours,r=this._vertices;let a,c;0===n&&(i[0]=[],o[0]=[],r[0]=[]);let h=0,_=0;const l=e.length;let d,u,g;const y=this._offset.x,f=this._offset.y,p=i[t],m=o[t],C=r[t],x=C.length!==l;for(let t=Math.min(l,C.length);h<t;++h,_+=2)d=e[h],u=d.x,g=d.y,C[h].set(y+u,f+g,0),p[_]=u,p[_+1]=g;for(C.length=l,m.length=p.length=2*l;h<l;++h,_+=2)d=e[h],u=d.x,g=d.y,a=y+u,c=f+g,C[h]=new s.k(a,c,0),m[_]=a,m[_+1]=c,p[_]=u,p[_+1]=g;(!this._body||this._transformContour(t)||x)&&(this._shape._set(this._contours),super._updateShapeSizeAndPosition())}getPathCount(){return this._points.length}setPathCount(t){const e=this._points,i=e.length;if(i===t)return;t<0&&(t=0);const n=this._contours,s=this._vertices;if(e.length=t,n.length=t,s.length=t,t<i)return this._shape._set(this._contours),void super._updateShapeSizeAndPosition();for(let o=i;o<t;++o)e[o]=[],n[o]=[],s[o]=[]}getTotalPointCount(){let t=0;const e=this._vertices;for(let i=0,n=e.length;i<n;++i)t+=e[i].length;return t}},pc.Collider2DSystem=S,pc.Rigidbody2DComponent=u,pc.Rigidbody2DSystem=w,pc.Joint2DComponent=j,pc.AnchoredJoint2DComponent=E,pc.DistanceJoint2DComponent=class extends E{constructor(t){super(t),this._type="distanceJoint2D",this._joint2=null,t?(this._maxDistanceOnly=!!t.maxDistanceOnly,this._distance=t.distance,this._autoConfigureDistance=!!t.autoConfigureDistance):(this._autoConfigureConnectedAnchor=!1,this._maxDistanceOnly=!1,this._distance=.005,this._autoConfigureDistance=!0),TESTS&&pc.hiddenShapeValidator.addObjectToValidationSet(this,"DistanceJoint2DComponent")}_initializeCode(){this._code=new UnityEngine.DistanceJoint2D(this),this["__UnityEngine.DistanceJoint2D"]=this._code,super._initializeCode()}_createJoint(t,e){const i=this._createJointDef(t,e);return this._autoConfigureDistance&&(this._distance=this._getDistance(t,e)),this._maxDistanceOnly?(i.maxLength=this._distance,this._world.createJoint(new planck.RopeJoint(i,t,e))):(i.frequencyHz=0,i.dampingRatio=1,i.length=this._distance,this._world.createJoint(new planck.DistanceJoint(i)))}update(){const t=this._joint;if(!t)return;const e=t.getBodyA(),i=t.getBodyB();(e._isEntityTransformed||i._isEntityTransformed)&&(super.update(),this._autoConfigureDistance&&this._resetDistance(e,i))}_updateDistance(){if(!this._autoConfigureDistance)return;const t=this._joint;t&&this._resetDistance(t.getBodyA(),t.getBodyB())}_resetDistance(t,e){const i=this._distance=this._getDistance(t,e);this._joint.setLength(i),this._joint2&&this._joint2.setLength(i)}_getDistance(t,e){return Math.max(planck.Vec2.distance(t.getWorldPoint(new planck.Vec2(this._anchor.x,this._anchor.y)),e.getWorldPoint(new planck.Vec2(this._connectedAnchor.x,this._connectedAnchor.y))),.005)}getDistance(){return this._distance}setDistance(t){this._autoConfigureDistance||(this._distance=t,this._joint&&(this._joint.setLength(t),this._joint2&&this._joint2.setLength(t)))}onDestroy(){return!!super.onDestroy()&&(this._joint2&&(this._world.destroyJoint(this._joint2),this._joint2=null),!0)}getMaxDistanceOnly(){return this._maxDistanceOnly}setMaxDistanceOnly(t){if(t=!!t,this._maxDistanceOnly===t)return;if(this._maxDistanceOnly=t,!this._joint)return;if(this._joint.setActive(!1),!this._joint2)return this._joint2=this._joint,void(this._joint=this._createJoint(this._joint.getBodyA(),this._joint.getBodyB()));const e=this._joint2;this._joint2=this._joint,this._joint=e,this._joint.setActive(this.enabled)}getAutoConfigureDistance(){return this._autoConfigureDistance}setAutoConfigureDistance(t){if(t=!!t,this._autoConfigureDistance===t)return;if(this._autoConfigureDistance=t,!t)return;const e=this._joint;e&&this._resetDistance(e.getBodyA(),e.getBodyB())}setConnectedBody(t){this._connectedBody!==t&&(super.setConnectedBody(t),this.enabled&&this._updateDistance())}enable(){this._updateDistance(),super.enable()}},pc.FixedJoint2DComponent=class extends E{constructor(t){super(t),this._type="fixedJoint2D",t?(this._frequency=t.frequency,this._dampingRatio=t.dampingRatio):(this._frequency=0,this._dampingRatio=0),TESTS&&pc.hiddenShapeValidator.addObjectToValidationSet(this,"FixedJoint2DComponent")}_initializeCode(){this._code=new UnityEngine.FixedJoint2D(this),this["__UnityEngine.FixedJoint2D"]=this._code,super._initializeCode()}_createJoint(t,e){const i=this._createJointDef(t,e);return i.frequencyHz=this._frequency,i.dampingRatio=this._dampingRatio,this._world.createJoint(new planck.WeldJoint(i))}update(){const t=this._joint;if(!t)return;const e=t.getBodyA(),i=t.getBodyB();(e._isEntityTransformed||i._isEntityTransformed)&&(super.update(),this._resetReferenceAngle(t,e,i))}_updateReferenceAngle(){const t=this._joint;t&&this._resetReferenceAngle(t,t.getBodyA(),t.getBodyB())}_resetReferenceAngle(t,e,i){t.setReferenceAngle(i.getAngle()-e.getAngle())}setConnectedBody(t){this._connectedBody!==t&&(super.setConnectedBody(t),this.enabled&&this._updateReferenceAngle())}enable(){this._updateReferenceAngle(),super.enable()}getFrequency(){return this._frequency}setFrequency(t){this._frequency=t,this._joint&&this._joint.setFrequency(t)}getDampingRatio(){return this._dampingRatio}setDampingRatio(t){this._dampingRatio=t,this._joint&&this._joint.setDampingRatio(t)}getReferenceAngle(){return this._joint?this._joint.getReferenceAngle()*s.i:0}},pc.FrictionJoint2DComponent=class extends E{constructor(t){super(t),this._type="frictionJoint2D",t?(this._maxForce=t.maxForce,this._maxTorque=t.maxTorque):(this._maxForce=1,this._maxTorque=1),TESTS&&pc.hiddenShapeValidator.addObjectToValidationSet(this,"FrictionJoint2DComponent")}_initializeCode(){this._code=new UnityEngine.FrictionJoint2D(this),this["__UnityEngine.FrictionJoint2D"]=this._code,super._initializeCode()}_createJoint(t,e){const i=this._createJointDef(t,e);return i.maxForce=this._maxForce,i.maxTorque=this._maxTorque,this._world.createJoint(new planck.FrictionJoint(i))}getMaxForce(){return this._maxForce}setMaxForce(t){this._maxForce=t<0?0:t>1e6?1e6:t,this._joint&&this._joint.setMaxForce(this._maxForce)}getMaxTorque(){return this._maxTorque}setMaxTorque(t){this._maxTorque=t<0?0:t>1e6?1e6:t,this._joint&&this._joint.setMaxTorque(this._maxTorque)}},pc.HingeJoint2DComponent=class extends E{constructor(t){super(t),this._type="hingeJoint2D",t?(this._limits=t.limits,this._useLimits=!!t.useLimits,this._motor=t.motor,this._useMotor=!!t.useMotor):(this._useLimits=!1,this._useMotor=!1),TESTS&&pc.hiddenShapeValidator.addObjectToValidationSet(this,"HingeJoint2DComponent")}_initializeCode(){this._code=new UnityEngine.HingeJoint2D(this),this["__UnityEngine.HingeJoint2D"]=this._code,super._initializeCode()}_createJoint(t,e){const i=this._createJointDef(t,e);return i.enableLimit=this._useLimits,this._limits&&(i.lowerAngle=this._limits.min*s.d,i.upperAngle=this._limits.max*s.d),i.enableMotor=this._useMotor,this._motor&&(i.motorSpeed=this._motor.motorSpeed*s.d,i.maxMotorTorque=this._motor.maxMotorTorque),this._world.createJoint(new planck.RevoluteJoint(i))}getUseLimits(){return this._useLimits}setUseLimits(t){t=!!t,this._useLimits!==t&&(this._useLimits=t,this._joint&&this._joint.enableLimit(t))}getLimits(){if(this._limits)return this._limits.$clone();const t=new UnityEngine.JointAngleLimits2D;return t.max=359,t}setLimits(t){this._limits&&this._limits.min===t.min&&this._limits.max===t.max||(this._limits=t,this._joint&&this._joint.setLimits(t.min*s.d,t.max*s.d))}getUseMotor(){return this._useMotor}setUseMotor(t){t=!!t,this._useMotor!==t&&(this._useMotor=t,this._joint&&this._joint.enableMotor(t))}getMotor(){if(this._motor)return this._motor.$clone();const t=new UnityEngine.JointMotor2D;return t.maxMotorTorque=1e4,t}setMotor(t){if(this.setUseMotor(!0),this._motor&&this._motor.motorSpeed===t.motorSpeed&&this._motor.maxMotorTorque===t.maxMotorTorque)return;this._motor=t;const e=this._joint;e&&(e.setMotorSpeed(t.motorSpeed*s.d),e.setMaxMotorTorque(t.maxMotorTorque))}getJointAngle(){return this._joint?this._joint.getJointAngle()*s.i:0}},pc.RelativeJoint2DComponent=class extends j{constructor(t){super(t),this._type="relativeJoint2D",t?(this._autoConfigureOffset=!!t.autoConfigureOffset,this._linearOffset=t.linearOffset,this._angularOffset=t.angularOffset*s.d,this._maxForce=t.maxForce,this._maxTorque=t.maxTorque,this._correctionScale=t.correctionScale):(this._autoConfigureOffset=!0,this._linearOffset=new s.j,this._angularOffset=0,this._maxForce=1e4,this._maxTorque=1e4,this._correctionScale=.3),TESTS&&pc.hiddenShapeValidator.addObjectToValidationSet(this,"RelativeJoint2DComponent")}_initializeCode(){this._code=new UnityEngine.RelativeJoint2D(this),this["__UnityEngine.RelativeJoint2D"]=this._code,super._initializeCode()}_createJoint(t,e){const i=this._createJointDef(t,e);i.maxForce=this._maxForce,i.maxTorque=this._maxTorque,i.correctionFactor=this._correctionScale;const n=new planck.Vec2(this._linearOffset.x,this._linearOffset.y);return this._autoConfigureOffset?(i.linearOffset=this._getLinearOffset(t,e,n),this._linearOffset.set(n.x,n.y),i.angularOffset=this._angularOffset=this._getAngularOffset(t,e)):(i.linearOffset=n,i.angularOffset=this._angularOffset),this._world.createJoint(new planck.MotorJoint(i))}_getLinearOffset(t,e,i){return t.getLocalPoint(e.getPosition(),i)}_getAngularOffset(t,e){return e.getAngle()-t.getAngle()}update(){if(!this._autoConfigureOffset)return;const t=this._joint;if(!t)return;const e=t.getBodyA(),i=t.getBodyB();(e._isEntityTransformed||i._isEntityTransformed)&&this._resetOffsets(t,e,i)}_updateOffsets(){if(!this._autoConfigureOffset)return;const t=this._joint;t&&this._resetOffsets(t,t.getBodyA(),t.getBodyB())}_resetOffsets(t,e,i){const n=t.getLinearOffset();t.setLinearOffset(this._getLinearOffset(e,i,n)),this._linearOffset.set(n.x,n.y),t.setAngularOffset(this._angularOffset=this._getAngularOffset(e,i))}setConnectedBody(t){this._connectedBody!==t&&(super.setConnectedBody(t),this.enabled&&this._updateOffsets())}enable(){super.enable(),this._updateOffsets()}getAngularOffset(){return this._angularOffset*s.i}setAngularOffset(t){t*=s.d,this._angularOffset!==t&&(this._angularOffset=t,this._joint&&this._joint.setAngularOffset(t))}getLinearOffset(){return this._linearOffset.clone()}setLinearOffset(t){this._linearOffset.equals(t)||(this._linearOffset=t,this._joint&&this._joint.setLinearOffset(this._joint.getLinearOffset().set(t.x,t.y)))}getAutoConfigureOffset(){return this._autoConfigureOffset}setAutoConfigureOffset(t){this._autoConfigureOffset=!!t}getCorrectionScale(){return this._correctionScale}setCorrectionScale(t){this._correctionScale!==t&&(this._correctionScale=t<0?0:t>1?1:t,this._joint&&this._joint.setCorrectionFactor(this._correctionScale))}getMaxForce(){return this._maxForce}setMaxForce(t){this._maxForce!==t&&(this._maxForce=t<0?0:t>1e6?1e6:t,this._joint&&this._joint.setMaxForce(this._maxForce))}getMaxTorque(){return this._maxTorque}setMaxTorque(t){this._maxTorque!==t&&(this._maxTorque=t<0?0:t>1e6?1e6:t,this._joint&&this._joint.setMaxTorque(this._maxTorque))}getTarget(){if(!this._joint)return s.j.ZERO.clone();const t=-this._angularOffset,e=this._joint.getBodyB();return M.set(e.getLocalCenter()).sub(new planck.Vec2(this._linearOffset.x,this._linearOffset.y)).rotate(Math.cos(t),Math.sin(t)),e.getWorldPoint(M,M),new s.j(M.x,M.y)}},pc.SliderJoint2DComponent=class extends E{constructor(t){super(t),this._type="sliderJoint2D",t?(this._autoConfigureAngle=!!t.autoConfigureAngle,this._angle=t.angle*s.d,this._useMotor=!!t.useMotor,this._motor=t.motor,this._useLimits=!!t.useLimits,this._limits=t.limits):(this._autoConfigureConnectedAnchor=!1,this._autoConfigureAngle=!0,this._angle=0,this._useMotor=!1,this._useLimits=!1),this._newConnectedBody=!0,TESTS&&pc.hiddenShapeValidator.addObjectToValidationSet(this,"SliderJoint2DComponent")}_initializeCode(){this._code=new UnityEngine.SliderJoint2D(this),this["__UnityEngine.SliderJoint2D"]=this._code,super._initializeCode()}_createJoint(t,e){const i=this._createJointDef(t,e);return i.enableMotor=this._useMotor,this._motor&&(i.motorSpeed=this._motor.motorSpeed,i.maxMotorForce=this._motor.maxMotorTorque),i.enableLimit=this._useLimits,this._limits&&(i.lowerTranslation=this._limits.min,i.upperTranslation=this._limits.max),i.localAxisA=this._getAxis(this._angle),this._world.createJoint(new planck.PrismaticJoint(i))}_getAxis(t,e){return(e=e||new planck.Vec2).set(Math.cos(t),Math.sin(t))}update(){const t=this._joint;if(!t)return;const e=t.getBodyA(),i=t.getBodyB();(e._isEntityTransformed||i._isEntityTransformed)&&(super.update(),this._resetAngle(t,e,i))}_updateAngle(){const t=this._joint;t&&this._resetAngle(t,t.getBodyA(),t.getBodyB())}_resetAngle(t,e,i){if(this._newConnectedBody&&(t.setReferenceAngle(i.getAngle()-e.getAngle()),this._newConnectedBody=!1),!this._autoConfigureAngle)return;const n=t.getLocalAxisA(),s=i.getWorldPoint(t.getLocalAnchorB(),n),o=e.getWorldPoint(t.getLocalAnchorA(),M),r=s.sub(o).normal();this._angle=Math.atan2(r.y,r.x),t.setLocalAxisA(r)}setConnectedBody(t){this._newConnectedBody=!0,this._connectedBody!==t&&(super.setConnectedBody(t),this.enabled&&this._updateAngle())}enable(){this._updateAngle(),super.enable()}getAngle(){return this._angle*s.i}setAngle(t){if(this._autoConfigureAngle)return void this._updateAngle();if(t*=s.d,this._angle===t)return;this._angle=t;const e=this._joint;e&&e.setLocalAxisA(this._getAxis(t,e.getLocalAxisA()))}getReferenceAngle(){return this._joint?this._joint.getReferenceAngle()*s.i:0}getAutoConfigureAngle(){return this._autoConfigureAngle}setAutoConfigureAngle(t){this._autoConfigureAngle=!!t}getUseMotor(){return this._useMotor}setUseMotor(t){t=!!t,this._useMotor!==t&&(this._useMotor=t,this._joint&&this._joint.enableMotor(t))}getMotor(){if(this._motor)return this._motor.$clone();const t=new UnityEngine.JointMotor2D;return t.maxMotorTorque=1e4,t}setMotor(t){if(this.setUseMotor(!0),this._motor&&this._motor.motorSpeed===t.motorSpeed&&this._motor.maxMotorTorque===t.maxMotorTorque)return;this._motor=t;const e=this._joint;e&&(e.setMotorSpeed(t.motorSpeed),e.setMaxMotorForce(t.maxMotorTorque))}getUseLimits(){return this._useLimits}setUseLimits(t){t=!!t,this._useLimits!==t&&(this._useLimits=t,this._joint&&this._joint.enableLimit(t))}getLimits(){return this._limits?this._limits.$clone():new UnityEngine.JointTranslationLimits2D}setLimits(t){this.setUseLimits(!0),this._limits&&this._limits.min===t.min&&this._limits.max===t.max||(this._limits=t,this._joint&&this._joint.setLimits(t.min,t.max))}getLimitState(){if(!this._joint)return UnityEngine.JointLimitState2D.Inactive;switch(this._joint.getLimitState()){default:return UnityEngine.JointLimitState2D.Inactive;case 1:return UnityEngine.JointLimitState2D.LowerLimit;case 2:return UnityEngine.JointLimitState2D.UpperLimit;case 3:return UnityEngine.JointLimitState2D.EqualLimits}}getJointTranslation(){return this._joint?this._joint.getJointTranslation():0}getJointSpeed(){return this._joint?this._joint.getJointSpeed()*s.i:0}getMotorForce(t){return this._joint&&t>0?this._joint.getMotorForce(1/t):0}},pc.SpringJoint2DComponent=class extends E{constructor(t){super(t),this._type="springJoint2D",t?(this._frequency=t.frequency,this._dampingRatio=t.dampingRatio,this._distance=t.distance):(this._autoConfigureConnectedAnchor=!1,this._frequency=1,this._dampingRatio=0,this._distance=0),TESTS&&pc.hiddenShapeValidator.addObjectToValidationSet(this,"SpringJoint2DComponent")}_initializeCode(){this._code=new UnityEngine.SpringJoint2D(this),this["__UnityEngine.SpringJoint2D"]=this._code,super._initializeCode()}_createJoint(t,e){const i=this._createJointDef(t,e);return i.frequencyHz=this._frequency,i.dampingRatio=this._dampingRatio,i.length=this._distance,this._world.createJoint(new planck.DistanceJoint(i))}getDistance(){return this._distance}setDistance(t){this._distance=t,this._joint&&this._joint.setLength(t)}getFrequency(){return this._frequency}setFrequency(t){this._frequency=t,this._joint&&this._joint.setFrequency(t)}getDampingRatio(){return this._dampingRatio}setDampingRatio(t){this._dampingRatio=t,this._joint&&this._joint.setDampingRatio(t)}},pc.TargetJoint2DComponent=class extends j{constructor(t){super(t),this._type="targetJoint2D",t?(this._autoConfigureTarget=!!t.autoConfigureTarget,this._target=t.target,this._anchor=t.anchor,this._maxForce=t.maxForce,this._dampingRatio=t.dampingRatio,this._frequency=t.frequency):(this._autoConfigureTarget=!0,this._target=new s.j,this._anchor=new s.j,this._maxForce=1e4,this._dampingRatio=1,this._frequency=5),TESTS&&pc.hiddenShapeValidator.addObjectToValidationSet(this,"TargetJoint2DComponent")}_initializeCode(){this._code=new UnityEngine.TargetJoint2D(this),this["__UnityEngine.TargetJoint2D"]=this._code,super._initializeCode()}_createJoint(t,e){const i=this._createJointDef(e,t);i.maxForce=this._maxForce,i.dampingRatio=this._dampingRatio,i.frequencyHz=this._frequency,i.anchorB=new planck.Vec2(this._anchor.x,this._anchor.y);const n=new planck.Vec2(this._target.x,this._target.y);return this._autoConfigureTarget?(i.target=n.set(t.getPosition()),this._target.set(n.x,n.y)):i.target=n,this._world.createJoint(new planck.MouseJoint(i))}update(){if(!this._autoConfigureTarget)return;const t=this._joint;if(!t)return;const e=t.getBodyB();e._isEntityTransformed&&this._resetTarget(t,e)}_updateTarget(){if(!this._autoConfigureTarget)return;const t=this._joint;t&&this._resetTarget(t,t.getBodyB())}_resetTarget(t,e){const i=t.getTarget();t.setTarget(i.set(e.getPosition())),this._target.set(i.x,i.y)}setConnectedBody(t){UnityEngine.Debug.LogWarningFormat("The connected rigidbody for the 'TargetJoint2D' type cannot be set.")}enable(){super.enable(),this._updateTarget()}getAutoConfigureTarget(){return this._autoConfigureTarget}setAutoConfigureTarget(t){this._autoConfigureTarget=!!t}getTarget(){return this._target.clone()}setTarget(t){this._target.copy(t);const e=this._joint;e&&e.setTarget(e.getTarget().set(t.x,t.y))}getAnchor(){return this._anchor.clone()}setAnchor(t){if(this._anchor.equals(t))return;this._anchor=t;const e=this._joint;e&&e.setLocalAnchorB(e.getLocalAnchorB().set(t.x,t.y))}getMaxForce(){return this._maxForce}setMaxForce(t){this._maxForce!==t&&(this._maxForce=t<0?0:t>1e6?1e6:t,this._joint&&this._joint.setMaxForce(this._maxForce))}getFrequency(){return this._frequency}setFrequency(t){this._frequency!==t&&(this._frequency=t<0?0:t>1e6?1e6:t,this._joint&&this._joint.setFrequency(this._frequency))}getDampingRatio(){return this._dampingRatio}setDampingRatio(t){this._dampingRatio!==t&&(this._dampingRatio=t<0?0:t>1?1:t,this._joint&&this._joint.setDampingRatio(this._dampingRatio))}},pc.WheelJoint2DComponent=class extends E{constructor(t){super(t),this._type="wheelJoint2D",this._autoConfigureConnectedAnchorMock=this._autoConfigureConnectedAnchor,this._autoConfigureConnectedAnchor=!1,t?(this._suspension=t.suspension,this._motor=t.motor,this._useMotor=!!t.useMotor):this._useMotor=!1,TESTS&&pc.hiddenShapeValidator.addObjectToValidationSet(this,"WheelJoint2DComponent")}_initializeCode(){this._code=new UnityEngine.WheelJoint2D(this),this["__UnityEngine.WheelJoint2D"]=this._code,super._initializeCode()}_createJoint(t,e){const i=this._createJointDef(t,e);return this._suspension&&(i.dampingRatio=this._suspension.dampingRatio,i.frequencyHz=this._suspension.frequency,i.localAxisA=this._getAxis(this._suspension.angle)),i.enableMotor=this._useMotor,this._motor&&(i.motorSpeed=this._motor.motorSpeed*s.d,i.maxMotorTorque=this._motor.maxMotorTorque),i.active=!!this._connectedBody,this._world.createJoint(new planck.WheelJoint(i))}_getAxis(t,e){return t*=s.d,(e=e||new planck.Vec2).set(Math.cos(t),Math.sin(t))}getAutoConfigureConnectedAnchor(){return this._autoConfigureConnectedAnchorMock}setConnectedBody(t){super.setConnectedBody(t),this._joint&&this._connectedBody&&this.enabled&&this._joint.setActive(!0)}enable(){super.enable(),this._joint&&this._joint.setActive(!!this._connectedBody)}setAutoConfigureConnectedAnchor(t){this._autoConfigureConnectedAnchorMock=!!t}getSuspension(){if(this._suspension)return this._suspension.$clone();const t=new UnityEngine.JointSuspension2D;return t.dampingRatio=.7,t.frequency=2,t.angle=90,t}setSuspension(t){if(this._suspension&&this._suspension.dampingRatio===t.dampingRatio&&this._suspension.frequency===t.frequency&&this._suspension.angle===t.angle)return;this._suspension=t;const e=this._joint;e&&(e.setSpringDampingRatio(t.dampingRatio),e.setSpringFrequencyHz(t.frequency),e.setLocalAxisA(this._getAxis(t.angle,M)))}getUseMotor(){return this._useMotor}setUseMotor(t){t=!!t,this._useMotor!==t&&(this._useMotor=t,this._joint&&this._joint.enableMotor(t))}getMotor(){if(this._motor)return this._motor.$clone();const t=new UnityEngine.JointMotor2D;return t.maxMotorTorque=1e4,t}setMotor(t){if(this.setUseMotor(!0),this._motor&&this._motor.motorSpeed===t.motorSpeed&&this._motor.maxMotorTorque===t.maxMotorTorque)return;this._motor=t;const e=this._joint;e&&(e.setMotorSpeed(t.motorSpeed*s.d),e.setMaxMotorTorque(t.maxMotorTorque))}getMotorTorque(t){return this._joint&&t>0?this._joint.getMotorTorque(1/t):0}getJointAngle(){return this._joint?this._joint.getJointAngle()*s.i:0}getJointSpeed(){return this._joint?this._joint.getJointAngularSpeed()*s.i:0}getJointTranslation(){return this._joint?this._joint.getJointTranslation():0}getJointLinearSpeed(){return this._joint?this._joint.getJointLinearSpeed():0}},pc.Joint2DSystem=B,pc.Effector2DComponent=R,pc.PlatformEffector2DComponent=class extends R{_initializeCode(){this._code=new UnityEngine.PlatformEffector2D(this),this["__UnityEngine.PlatformEffector2D"]=this._code,super._initializeCode()}},pc.Effector2DSystem=F,pc.Physics2DSystem=K,pc.markPhysics2dModuleAsUsed=()=>{window.traceResults&&window.traceResults.markModuleAsUsed(window.traceResults.EngineModules.Physics2d)}}},t=>{t.O(0,[1],(()=>{return e=37,t(t.s=e);var e}));t.O()}]);