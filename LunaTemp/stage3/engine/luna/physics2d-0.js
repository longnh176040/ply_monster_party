var planck=function(t){var e={};function i(s){if(e[s])return e[s].exports;var o=e[s]={i:s,l:!1,exports:{}};return t[s].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(s,o,function(e){return t[e]}.bind(null,o));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=34)}([function(t,e,i){t.exports=o;i(2);const s=i(1);function o(t,e){if(!(this instanceof o))return new o(t,e);void 0===t?(this.x=0,this.y=0):"object"==typeof t?(this.x=t.x,this.y=t.y):(this.x=t,this.y=e)}o.zero=function(){const t=Object.create(o.prototype);return t.x=0,t.y=0,t},o.ZERO=o.zero(),o.neo=function(t,e){const i=Object.create(o.prototype);return i.x=t,i.y=e,i},o.clone=function(t){return o.neo(t.x,t.y)},o.prototype.toString=function(){return JSON.stringify(this)},o.isValid=function(t){return t&&s.isFinite(t.x)&&s.isFinite(t.y)},o.assert=function(t){},o.prototype.clone=function(){return o.clone(this)},o.prototype.setZero=function(){return this.x=0,this.y=0,this},o.prototype.set=function(t,e){return pc.markPhysics2dModuleAsUsed(),"object"==typeof t?(this.x=t.x,this.y=t.y):(this.x=t,this.y=e),this},o.prototype.wSet=function(t,e,i,s){return void 0!==i||void 0!==s?this.setCombine(t,e,i,s):this.setMul(t,e)},o.prototype.setCombine=function(t,e,i,s){const o=t*e.x+i*s.x,n=t*e.y+i*s.y;return this.x=o,this.y=n,this},o.prototype.setMul=function(t,e){const i=t*e.x,s=t*e.y;return this.x=i,this.y=s,this},o.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},o.prototype.wAdd=function(t,e,i,s){return void 0!==i||void 0!==s?this.addCombine(t,e,i,s):this.addMul(t,e)},o.prototype.addCombine=function(t,e,i,s){const o=t*e.x+i*s.x,n=t*e.y+i*s.y;return this.x+=o,this.y+=n,this},o.prototype.addMul=function(t,e){const i=t*e.x,s=t*e.y;return this.x+=i,this.y+=s,this},o.prototype.wSub=function(t,e,i,s){return void 0!==i||void 0!==s?this.subCombine(t,e,i,s):this.subMul(t,e)},o.prototype.subCombine=function(t,e,i,s){const o=t*e.x+i*s.x,n=t*e.y+i*s.y;return this.x-=o,this.y-=n,this},o.prototype.subMul=function(t,e){const i=t*e.x,s=t*e.y;return this.x-=i,this.y-=s,this},o.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this},o.prototype.mul=function(t){return this.x*=t,this.y*=t,this},o.prototype.length=function(){return o.lengthOf(this)},o.prototype.lengthSquared=function(){return o.lengthSquared(this)},o.prototype.normalize=function(){const t=this.length();if(t<s.EPSILON)return 0;const e=1/t;return this.x*=e,this.y*=e,t},o.prototype.normal=function(){const t=this.length();if(t<s.EPSILON)return this;const e=1/t;return this.x*=e,this.y*=e,this},o.prototype.rot=function(t){const e=this.x,i=this.y;return this.x=t.c*e-t.s*i,this.y=t.s*e+t.c*i,this},o.prototype.rotate=function(t,e){const i=this.x,s=this.y;return this.x=t*i-e*s,this.y=e*i+t*s,this},o.prototype.rotT=function(t){const e=this.x,i=this.y;return this.x=t.c*e+t.s*i,this.y=-t.s*e+t.c*i,this},o.prototype.closeTo=function(t){const e=this.x-t.x;if(e>s.EPSILON||e<-s.EPSILON)return!1;const i=this.y-t.y;return-s.EPSILON<=i&&i<=s.EPSILON},o.prototype.closeToValues=function(t,e){const i=this.x-t;if(i>s.EPSILON||i<-s.EPSILON)return!1;const o=this.y-e;return-s.EPSILON<=o&&o<=s.EPSILON},o.lengthOf=function(t){return s.sqrt(t.x*t.x+t.y*t.y)},o.lengthSquared=function(t){return t.x*t.x+t.y*t.y},o.distance=function(t,e){const i=t.x-e.x,o=t.y-e.y;return s.sqrt(i*i+o*o)},o.distanceSquared=function(t,e){const i=t.x-e.x,s=t.y-e.y;return i*i+s*s},o.areEqual=function(t,e){return t==e||"object"==typeof e&&null!==e&&t.x===e.x&&t.y===e.y},o.skew=function(t){return o.neo(-t.y,t.x)},o.dot=function(t,e){return t.x*e.x+t.y*e.y},o.cross=function(t,e){return"number"==typeof e?o.neo(e*t.y,-e*t.x):"number"==typeof t?o.neo(-t*e.y,t*e.x):t.x*e.y-t.y*e.x},o.addCross=function(t,e,i){return"number"==typeof i?o.neo(i*e.y+t.x,-i*e.x+t.y):"number"==typeof e?o.neo(-e*i.y+t.x,e*i.x+t.y):void 0},o.add=function(t,e){return o.neo(t.x+e.x,t.y+e.y)},o.wAdd=function(t,e,i,s){return void 0!==i||void 0!==s?o.combine(t,e,i,s):o.mul(t,e)},o.combine=function(t,e,i,s){return o.zero().setCombine(t,e,i,s)},o.sub=function(t,e){return o.neo(t.x-e.x,t.y-e.y)},o.mul=function(t,e,i){return"object"==typeof t?i?i.set(t.x*e,t.y*e):o.neo(t.x*e,t.y*e):"object"==typeof e?i?i.set(t*e.x,t*e.y):o.neo(t*e.x,t*e.y):void 0},o.prototype.neg=function(){return this.x=-this.x,this.y=-this.y,this},o.neg=function(t){return o.neo(-t.x,-t.y)},o.abs=function(t){return o.neo(s.abs(t.x),s.abs(t.y))},o.mid=function(t,e,i){const s=.5*(t.x+e.x),n=.5*(t.y+e.y);return i?i.set(s,n):o.neo(s,n)},o.upper=function(t,e){return o.neo(s.max(t.x,e.x),s.max(t.y,e.y))},o.lower=function(t,e){return o.neo(s.min(t.x,e.x),s.min(t.y,e.y))},o.prototype.clamp=function(t){const e=this.x*this.x+this.y*this.y;if(e>t*t){const i=s.invSqrt(e);this.x*=i*t,this.y*=i*t}return this},o.clamp=function(t,e){return(t=o.neo(t.x,t.y)).clamp(e),t},o.scaleFn=function(t,e){return function(i){return o.neo(i.x*t,i.y*e)}},o.translateFn=function(t,e){return function(i){return o.neo(i.x+t,i.y+e)}}},function(t,e,i){i(2);const s=i(5),o=Math,n=t.exports=s(o);n.EPSILON=1e-9,n.isFinite=function(t){return"number"==typeof t&&isFinite(t)&&!isNaN(t)},n.assert=function(t){},n.invSqrt=function(t){return 1/o.sqrt(t)},n.nextPowerOfTwo=function(t){return t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,(t|=t>>16)+1},n.isPowerOfTwo=function(t){return t>0&&0==(t&t-1)},n.mod=function(t,e,i){return void 0===e?(i=1,e=0):void 0===i&&(i=e,e=0),i>e?(t=(t-e)%(i-e))+(t<0?i:e):(t=(t-i)%(e-i))+(t<=0?e:i)},n.clamp=function(t,e,i){return t<e?e:t>i?i:t},n.random=function(t,e){return void 0===t?(e=1,t=0):void 0===e&&(e=t,t=0),t==e?t:o.random()*(e-t)+t}},function(t,e,i){e.debug=function(...t){},e.assert=function(t,e,i){}},function(t,e,i){t.exports=n;i(2);const s=i(0),o=i(1);function n(t){if(!(this instanceof n))return new n(t);"number"==typeof t?this.setAngle(t):"object"==typeof t?this.set(t):this.setIdentity()}n.neo=function(t){const e=Object.create(n.prototype);return e.setAngle(t),e},n.clone=function(t){const e=Object.create(n.prototype);return e.s=t.s,e.c=t.c,e},n.identity=function(){const t=Object.create(n.prototype);return t.s=0,t.c=1,t},n.isValid=function(t){return t&&o.isFinite(t.s)&&o.isFinite(t.c)},n.assert=function(t){},n.prototype.setIdentity=function(){this.s=0,this.c=1},n.prototype.set=function(t){"object"==typeof t?(this.s=t.s,this.c=t.c):(this.s=o.sin(t),this.c=o.cos(t))},n.prototype.setCS=function(t,e){this.c=t,this.s=e},n.prototype.setAngle=function(t){this.s=o.sin(t),this.c=o.cos(t)},n.prototype.getAngle=function(){return o.atan2(this.s,this.c)},n.prototype.getXAxis=function(){return s.neo(this.c,this.s)},n.prototype.getYAxis=function(){return s.neo(-this.s,this.c)},n.mul=function(t,e){if("c"in e&&"s"in e){const i=n.identity();return i.s=t.s*e.c+t.c*e.s,i.c=t.c*e.c-t.s*e.s,i}if("x"in e&&"y"in e)return s.neo(t.c*e.x-t.s*e.y,t.s*e.x+t.c*e.y)},n.mulRot=function(t,e){const i=n.identity();return i.s=t.s*e.c+t.c*e.s,i.c=t.c*e.c-t.s*e.s,i},n.mulVec2=function(t,e){return s.neo(t.c*e.x-t.s*e.y,t.s*e.x+t.c*e.y)},n.mulSub=function(t,e,i){const o=t.c*(e.x-i.x)-t.s*(e.y-i.y),n=t.s*(e.x-i.y)+t.c*(e.y-i.y);return s.neo(o,n)},n.mulT=function(t,e){if("c"in e&&"s"in e){const i=n.identity();return i.s=t.c*e.s-t.s*e.c,i.c=t.c*e.c+t.s*e.s,i}if("x"in e&&"y"in e)return s.neo(t.c*e.x+t.s*e.y,-t.s*e.x+t.c*e.y)},n.mulTRot=function(t,e){const i=n.identity();return i.s=t.c*e.s-t.s*e.c,i.c=t.c*e.c+t.s*e.s,i},n.mulTVec2=function(t,e){return s.neo(t.c*e.x+t.s*e.y,-t.s*e.x+t.c*e.y)}},function(t,e){const i=e;i.maxManifoldPoints=2,i.maxPolygonVertices=12,i.aabbExtension=.1,i.aabbMultiplier=2,i.linearSlop=.005,i.linearSlopSquared=i.linearSlop*i.linearSlop,i.angularSlop=2/180*Math.PI,i.polygonRadius=2*i.linearSlop,i.maxSubSteps=8,i.maxTOIContacts=32,i.maxTOIIterations=20,i.maxDistnceIterations=20,i.velocityThreshold=1,i.maxLinearCorrection=.2,i.maxAngularCorrection=8/180*Math.PI,i.maxTranslation=2,i.maxTranslationSquared=i.maxTranslation*i.maxTranslation,i.maxRotation=.5*Math.PI,i.maxRotationSquared=i.maxRotation*i.maxRotation,i.baumgarte=.2,i.toiBaugarte=.75,i.timeToSleep=.5,i.linearSleepTolerance=.01,i.linearSleepToleranceSqr=Math.pow(i.linearSleepTolerance,2),i.angularSleepTolerance=2/180*Math.PI,i.angularSleepToleranceSqr=Math.pow(i.angularSleepTolerance,2)},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){return Object.create.call(Object,t,e)}:t.exports=function(t,e){if(e)throw Error("Second argument is not supported!");if("object"!=typeof t||null===t)throw Error("Invalid prototype!");function i(){}return i.prototype=t,new i}},function(t,e,i){t.exports=n;i(2);const s=i(0),o=i(3);function n(t,e){if(!(this instanceof n))return new n(t,e);this.p=s.zero(),this.q=o.identity(),void 0!==t&&this.p.set(t),void 0!==e&&this.q.set(e)}n.clone=function(t){const e=Object.create(n.prototype);return e.p=s.clone(t.p),e.q=o.clone(t.q),e},n.neo=function(t,e){const i=Object.create(n.prototype);return i.p=s.clone(t),i.q=o.clone(e),i},n.identity=function(){const t=Object.create(n.prototype);return t.p=s.zero(),t.q=o.identity(),t},n.prototype.setIdentity=function(){this.p.setZero(),this.q.setIdentity()},n.prototype.set=function(t,e){void 0===e?(this.p.set(t.p),this.q.set(t.q)):(this.p.set(t),this.q.set(e))},n.isValid=function(t){return t&&s.isValid(t.p)&&o.isValid(t.q)},n.assert=function(t){},n.mul=function(t,e){if(Array.isArray(e)){const i=[];for(let s=0;s<e.length;s++)i[s]=n.mul(t,e[s]);return i}if("x"in e&&"y"in e){const i=t.q.c*e.x-t.q.s*e.y+t.p.x,o=t.q.s*e.x+t.q.c*e.y+t.p.y;return s.neo(i,o)}if("p"in e&&"q"in e){const i=n.identity();return i.q=o.mulRot(t.q,e.q),i.p=s.add(o.mulVec2(t.q,e.p),t.p),i}},n.mulAll=function(t,e){const i=[];for(let s=0;s<e.length;s++)i[s]=n.mul(t,e[s]);return i},n.mulFn=function(t){return function(e){return n.mul(t,e)}},n.mulVec2=function(t,e,i){const o=t.q.c*e.x-t.q.s*e.y+t.p.x,n=t.q.s*e.x+t.q.c*e.y+t.p.y;return i?i.set(o,n):s.neo(o,n)},n.mulXf=function(t,e){const i=n.identity();return i.q=o.mulRot(t.q,e.q),i.p=s.add(o.mulVec2(t.q,e.p),t.p),i},n.mulT=function(t,e){if("x"in e&&"y"in e){const i=e.x-t.p.x,o=e.y-t.p.y,n=t.q.c*i+t.q.s*o,r=-t.q.s*i+t.q.c*o;return s.neo(n,r)}if("p"in e&&"q"in e){const i=n.identity();return i.q.set(o.mulTRot(t.q,e.q)),i.p.set(o.mulTVec2(t.q,s.sub(e.p,t.p))),i}},n.mulTVec2=function(t,e,i){const o=e.x-t.p.x,n=e.y-t.p.y,r=t.q.c*o+t.q.s*n,m=-t.q.s*o+t.q.c*n;return i?i.set(r,m):s.neo(r,m)},n.mulTXf=function(t,e){const i=n.identity();return i.q.set(o.mulTRot(t.q,e.q)),i.p.set(o.mulTVec2(t.q,s.sub(e.p,t.p))),i}},function(t,e){t.exports=function(t,e){null==t&&(t={});for(const i in e)e.hasOwnProperty(i)&&void 0===t[i]&&(t[i]=e[i]);if("function"==typeof Object.getOwnPropertySymbols){const i=Object.getOwnPropertySymbols(e);for(let s=0;s<i.length;s++){const o=i[s];e.propertyIsEnumerable(o)&&void 0===t[o]&&(t[o]=e[o])}}return t}},function(t,e,i){t.exports=o;i(2);function s(){this.other=null,this.joint=null,this.prev=null,this.next=null}function o(t,e,i){e=t.bodyA||e,i=t.bodyB||i,this.m_type="unknown-joint",this.m_bodyA=e,this.m_bodyB=i,this.m_index=0,this.m_collideConnected=!!t.collideConnected,this.m_prev=null,this.m_next=null,this.m_edgeA=new s,this.m_edgeB=new s,this.m_islandFlag=!1,this.m_activeFlag=t.active,this.m_userData=t.userData}o.prototype.isActive=function(){return this.m_activeFlag&&this.m_bodyA.isActive()&&this.m_bodyB.isActive()},o.prototype.setActive=function(t){this.m_activeFlag=t},o.prototype.getType=function(){return this.m_type},o.prototype.getBodyA=function(){return this.m_bodyA},o.prototype.setBodyA=function(t){this.disconnectBodyA(),this.disconnectBodyB(),this.refilter(),this.m_bodyA=t,this.connectBodyA(),this.connectBodyA(),this.refilter()},o.prototype.connectBodyA=function(){const t=this.m_edgeA;t.joint=this,t.other=this.m_bodyB,t.prev=null;const e=this.m_bodyA,i=e.m_jointList;t.next=i,i&&(i.prev=t),e.m_jointList=t,e.setAwake(!0)},o.prototype.disconnectBodyA=function(){const t=this.m_bodyA,e=this.m_edgeA;t.setAwake(!0),e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),e==t.m_jointList&&(t.m_jointList=e.next),e.prev=null,e.next=null},o.prototype.getBodyB=function(){return this.m_bodyB},o.prototype.setBodyB=function(t){this.disconnectBodyA(),this.disconnectBodyB(),this.refilter(),this.m_bodyB=t,this.connectBodyA(),this.connectBodyB(),this.refilter()},o.prototype.connectBodyB=function(){const t=this.m_edgeB;t.joint=this,t.other=this.m_bodyA,t.prev=null;const e=this.m_bodyB,i=e.m_jointList;t.next=i,i&&(i.prev=t),e.m_jointList=t,e.setAwake(!0)},o.prototype.disconnectBodyB=function(){const t=this.m_bodyB,e=this.m_edgeB;t.setAwake(!0),e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),e==t.m_jointList&&(t.m_jointList=e.next),e.prev=null,e.next=null},o.prototype.refilter=function(){if(!this.m_collideConnected)for(let t=this.m_bodyB.getContactList();t;t=t.next)this.m_bodyA.equals(t.other)&&t.contact.flagForFiltering()},o.prototype.getNext=function(){return this.m_next},o.prototype.getUserData=function(){return this.m_userData},o.prototype.setUserData=function(t){this.m_userData=t},o.prototype.getCollideConnected=function(){return this.m_collideConnected},o.prototype.setCollideConnected=function(t){this.m_collideConnected=t},o.prototype.getAnchorA=function(){},o.prototype.getAnchorB=function(){},o.prototype.getReactionForce=function(t,e){},o.prototype.getReactionTorque=function(t){},o.prototype.shiftOrigin=function(t){},o.prototype.initVelocityConstraints=function(t){},o.prototype.solveVelocityConstraints=function(t){},o.prototype.solvePositionConstraints=function(t){}},function(t,e,i){i(2);const s=i(1),o=i(0),n=i(6),r=i(10),m=i(3),h=i(4),c=i(11),l=i(14);function a(t){this.contact=t,this.prev,this.next,this.other}function _(t,e,i,s,n){pc.markPhysics2dModuleAsUsed(),this.m_nodeA=new a(this),this.m_nodeB=new a(this),this.m_fixtureA=t,this.m_fixtureB=i,this.m_indexA=e,this.m_indexB=s,this.m_evaluateFcn=n,this.m_manifold=new c,this.m_prev=null,this.m_next=null,this.m_toi=1,this.m_toiCount=0,this.m_toiFlag=!1,this.m_friction=p(this.m_fixtureA.m_friction,this.m_fixtureB.m_friction),this.m_restitution=d(this.m_fixtureA.m_restitution,this.m_fixtureB.m_restitution),this.m_tangentSpeed=0,this.m_enabledFlag=!0,this.m_islandFlag=!1,this.m_touchingFlag=!1,this.m_filterFlag=!1,this.m_bulletHitFlag=!1,this.v_points=[],this.v_normal=o.zero(),this.v_normalMass=new r,this.v_K=new r,this.v_pointCount,this.v_tangentSpeed,this.v_friction,this.v_restitution,this.v_invMassA,this.v_invMassB,this.v_invIA,this.v_invIB,this.p_localPoints=[],this.p_localNormal=o.zero(),this.p_localPoint=o.zero(),this.p_localCenterA=o.zero(),this.p_localCenterB=o.zero(),this.p_type,this.p_radiusA,this.p_radiusB,this.p_pointCount,this.p_invMassA,this.p_invMassB,this.p_invIA,this.p_invIB}function u(){this.rA=o.zero(),this.rB=o.zero(),this.normalImpulse=0,this.tangentImpulse=0,this.normalMass=0,this.tangentMass=0,this.velocityBias=0}function p(t,e){return s.sqrt(t*e)}function d(t,e){return t>e?t:e}t.exports=_,_.prototype.getContactPoint=function(t,e){const i=new UnityEngine.ContactPoint2D;i.collider=e.collider,i.otherCollider=e.otherCollider,i.rigidbody=e.rigidbody,i.otherRigidbody=e.otherRigidbody;const s=this.v_points[t];return i.point.set(s.worldPoint.x,s.worldPoint.y),i.normal.set(this.v_normal.x,this.v_normal.y),i.normalImpulse=s.normalImpulse,i.tangentImpulse=s.tangentImpulse,i.separation=s.separation,i},_.prototype.populateContactsArray=function(t,e){for(let i=0;i<this.v_pointCount&&!(i>=t.length);i++){const s=this.v_points[i],o=t[e++];this.populateContactPoint(s,o)}return e},_.prototype.populateContactPoint=function(t,e=null){e=e||new UnityEngine.ContactPoint2D;const i=this.getFixtureA(),s=this.getFixtureB(),o=i._component.code,n=s._component.code,r=i.getBody(),m=s.getBody();return e.collider=n,e.otherCollider=o,e.rigidbody=UnityEngine.Object.FromHandle(UnityEngine.Rigidbody2D,m._component),e.otherRigidbody=UnityEngine.Object.FromHandle(UnityEngine.Rigidbody2D,r._component),e.point.set(t.worldPoint.x,t.worldPoint.y),e.normal.set(this.v_normal.x,this.v_normal.y),e.normalImpulse=t.normalImpulse,e.tangentImpulse=t.tangentImpulse,e.separation=t.separation,e},_.prototype.initConstraint=function(t){const e=this.m_fixtureA,i=this.m_fixtureB,s=e.getShape(),n=i.getShape(),r=e.getBody(),m=i.getBody(),h=this.getManifold(),c=h.pointCount;this.v_invMassA=r.m_invMass,this.v_invMassB=m.m_invMass,this.v_invIA=r.m_invI,this.v_invIB=m.m_invI,this.v_friction=this.m_friction,this.v_restitution=this.m_restitution,this.v_tangentSpeed=this.m_tangentSpeed,this.v_pointCount=c,this.v_K.setZero(),this.v_normalMass.setZero(),this.p_invMassA=r.m_invMass,this.p_invMassB=m.m_invMass,this.p_invIA=r.m_invI,this.p_invIB=m.m_invI,this.p_localCenterA=o.clone(r.m_sweep.localCenter),this.p_localCenterB=o.clone(m.m_sweep.localCenter),this.p_radiusA=s.m_radius,this.p_radiusB=n.m_radius,this.p_type=h.type,this.p_localNormal=o.clone(h.localNormal),this.p_localPoint=o.clone(h.localPoint),this.p_pointCount=c;for(let e=0;e<c;++e){const i=h.points[e],s=this.v_points[e]=new u;t.warmStarting?(s.normalImpulse=t.dtRatio*i.normalImpulse,s.tangentImpulse=t.dtRatio*i.tangentImpulse):(s.normalImpulse=0,s.tangentImpulse=0),s.rA.setZero(),s.rB.setZero(),s.normalMass=0,s.tangentMass=0,s.velocityBias=0,this.p_localPoints[e]=o.clone(i.localPoint)}},_.prototype.getManifold=function(){return this.m_manifold},_.prototype.getWorldManifold=function(t){const e=this.m_fixtureA.getBody(),i=this.m_fixtureB.getBody(),s=this.m_fixtureA.getShape(),o=this.m_fixtureB.getShape();return this.m_manifold.getWorldManifold(t,e.getTransform(),s.m_radius,i.getTransform(),o.m_radius)},_.prototype.setEnabled=function(t){this.m_enabledFlag=!!t},_.prototype.isEnabled=function(){return this.m_enabledFlag},_.prototype.isTouching=function(){return this.m_touchingFlag},_.prototype.getNext=function(){return this.m_next},_.prototype.getFixtureA=function(){return this.m_fixtureA},_.prototype.getFixtureB=function(){return this.m_fixtureB},_.prototype.getChildIndexA=function(){return this.m_indexA},_.prototype.getChildIndexB=function(){return this.m_indexB},_.prototype.flagForFiltering=function(){this.m_filterFlag=!0},_.prototype.setFriction=function(t){this.m_friction=t},_.prototype.getFriction=function(){return this.m_friction},_.prototype.resetFriction=function(){this.m_friction=p(this.m_fixtureA.m_friction,this.m_fixtureB.m_friction)},_.prototype.setRestitution=function(t){this.m_restitution=t},_.prototype.getRestitution=function(){return this.m_restitution},_.prototype.resetRestitution=function(){this.m_restitution=d(this.m_fixtureA.m_restitution,this.m_fixtureB.m_restitution)},_.prototype.setTangentSpeed=function(t){this.m_tangentSpeed=t},_.prototype.getTangentSpeed=function(){return this.m_tangentSpeed},_.prototype.evaluate=function(t,e,i){this.m_evaluateFcn(t,e,this.m_fixtureA,this.m_indexA,i,this.m_fixtureB,this.m_indexB)},_.prototype.update=function(t){this.m_enabledFlag=!0;let e=!1;const i=this.m_touchingFlag,s=this.m_fixtureA.isSensor(),o=this.m_fixtureB.isSensor(),n=s||o,r=this.m_fixtureA.getBody(),m=this.m_fixtureB.getBody(),h=r.getTransform(),a=m.getTransform();let _=null;if(n){const t=this.m_fixtureA.getShape(),i=this.m_fixtureB.getShape();e=l.testOverlap(t,this.m_indexA,i,this.m_indexB,h,a),this.m_manifold.pointCount=0}else{_=this.m_manifold,this.m_manifold=new c,this.evaluate(this.m_manifold,h,a),e=this.m_manifold.pointCount>0;for(let t=0;t<this.m_manifold.pointCount;++t){const e=this.m_manifold.points[t];e.normalImpulse=0,e.tangentImpulse=0;for(let t=0;t<_.pointCount;++t){const i=_.points[t];if(i.id.key==e.id.key){e.normalImpulse=i.normalImpulse,e.tangentImpulse=i.tangentImpulse;break}}}e!=i&&(r.setAwake(!0),m.setAwake(!0))}this.m_touchingFlag=e,0==i&&1==e&&t&&t.beginContact(this),1==i&&0==e&&t&&t.endContact(this),0==n&&e&&t&&t.preSolve(this,_)},_.prototype.solvePositionConstraint=function(t){return this._solvePositionConstraint(t,!1)},_.prototype.solvePositionConstraintTOI=function(t,e,i){return this._solvePositionConstraint(t,!0,e,i)},_.prototype._solvePositionConstraint=function(t,e,i,r){const l=this.m_fixtureA,a=this.m_fixtureB,_=l.getBody(),u=a.getBody(),p=_.c_position,d=u.c_position,y=o.clone(this.p_localCenterA),f=o.clone(this.p_localCenterB);let x=0,g=0;e&&_!=i&&_!=r||(x=this.p_invMassA,g=this.p_invIA);let v=0,A=0;e&&u!=i&&u!=r||(v=this.p_invMassB,A=this.p_invIB);const b=o.clone(p.c);let B=p.a;const w=o.clone(d.c);let C=d.a,I=0;for(let t=0;t<this.p_pointCount;++t){const i=n.identity(),r=n.identity();let l,a,_;switch(i.q.set(B),r.q.set(C),i.p=o.sub(b,m.mulVec2(i.q,y)),r.p=o.sub(w,m.mulVec2(r.q,f)),this.p_type){case c.e_circles:{let t=n.mulVec2(i,this.p_localPoint),e=n.mulVec2(r,this.p_localPoints[0]);l=o.sub(e,t),l.normalize(),a=o.combine(.5,t,.5,e),_=o.dot(o.sub(e,t),l)-this.p_radiusA-this.p_radiusB;break}case c.e_faceA:{l=m.mulVec2(i.q,this.p_localNormal);let e=n.mulVec2(i,this.p_localPoint),s=n.mulVec2(r,this.p_localPoints[t]);_=o.dot(o.sub(s,e),l)-this.p_radiusA-this.p_radiusB,a=s;break}case c.e_faceB:{l=m.mulVec2(r.q,this.p_localNormal);let e=n.mulVec2(r,this.p_localPoint),s=n.mulVec2(i,this.p_localPoints[t]);_=o.dot(o.sub(s,e),l)-this.p_radiusA-this.p_radiusB,a=s,l.mul(-1);break}}const u=o.sub(a,b),p=o.sub(a,w);I=s.min(I,_);const d=e?h.toiBaugarte:h.baumgarte,M=h.linearSlop,S=h.maxLinearCorrection,L=s.clamp(d*(_+M),-S,0),P=o.cross(u,l),V=o.cross(p,l),z=x+v+g*P*P+A*V*V,k=z>0?-L/z:0,O=o.mul(k,l);b.subMul(x,O),B-=g*o.cross(u,O),w.addMul(v,O),C+=A*o.cross(p,O)}return p.c.set(b),p.a=B,d.c.set(w),d.a=C,I},_.prototype.initVelocityConstraint=function(t){const e=this.m_fixtureA,i=this.m_fixtureB,s=e.getBody(),r=i.getBody(),c=s.c_velocity,l=r.c_velocity,a=s.c_position,_=r.c_position,u=this.p_radiusA,p=this.p_radiusB,d=this.getManifold(),y=this.v_invMassA,f=this.v_invMassB,x=this.v_invIA,g=this.v_invIB,v=o.clone(this.p_localCenterA),A=o.clone(this.p_localCenterB),b=o.clone(a.c),B=a.a,w=o.clone(c.v),C=c.w,I=o.clone(_.c),M=_.a,S=o.clone(l.v),L=l.w,P=n.identity(),V=n.identity();P.q.set(B),V.q.set(M),P.p.setCombine(1,b,-1,m.mulVec2(P.q,v)),V.p.setCombine(1,I,-1,m.mulVec2(V.q,A));const z=d.getWorldManifold(null,P,u,V,p);this.v_normal.set(z.normal);for(let t=0;t<this.v_pointCount;++t){const e=this.v_points[t],i=z.points[t];e.worldPoint=i,e.separation=z.separations[t],e.rA.set(o.sub(i,b)),e.rB.set(o.sub(i,I));const s=o.cross(e.rA,this.v_normal),n=o.cross(e.rB,this.v_normal),r=y+f+x*s*s+g*n*n;e.normalMass=r>0?1/r:0;const m=o.cross(this.v_normal,1),c=o.cross(e.rA,m),l=o.cross(e.rB,m),a=y+f+x*c*c+g*l*l;e.tangentMass=a>0?1/a:0,e.velocityBias=0;const _=o.dot(this.v_normal,S)+o.dot(this.v_normal,o.cross(L,e.rB))-o.dot(this.v_normal,w)-o.dot(this.v_normal,o.cross(C,e.rA));_<-h.velocityThreshold&&(e.velocityBias=-this.v_restitution*_)}if(2==this.v_pointCount&&t.blockSolve){const t=this.v_points[0],e=this.v_points[1],i=o.cross(t.rA,this.v_normal),s=o.cross(t.rB,this.v_normal),n=o.cross(e.rA,this.v_normal),r=o.cross(e.rB,this.v_normal),m=y+f+x*i*i+g*s*s,h=y+f+x*n*n+g*r*r,c=y+f+x*i*n+g*s*r;m*m<1e3*(m*h-c*c)?(this.v_K.ex.set(m,c),this.v_K.ey.set(c,h),this.v_normalMass.set(this.v_K.getInverse())):this.v_pointCount=1}a.c.set(b),a.a=B,c.v.set(w),c.w=C,_.c.set(I),_.a=M,l.v.set(S),l.w=L},_.prototype.warmStartConstraint=function(t){const e=this.m_fixtureA,i=this.m_fixtureB,s=e.getBody(),n=i.getBody(),r=s.c_velocity,m=n.c_velocity,h=this.v_invMassA,c=this.v_invIA,l=this.v_invMassB,a=this.v_invIB,_=o.clone(r.v);let u=r.w;const p=o.clone(m.v);let d=m.w;const y=this.v_normal,f=o.cross(y,1);for(let t=0;t<this.v_pointCount;++t){const e=this.v_points[t],i=o.combine(e.normalImpulse,y,e.tangentImpulse,f);u-=c*o.cross(e.rA,i),_.subMul(h,i),d+=a*o.cross(e.rB,i),p.addMul(l,i)}r.v.set(_),r.w=u,m.v.set(p),m.w=d},_.prototype.storeConstraintImpulses=function(t){const e=this.m_manifold;for(let t=0;t<this.v_pointCount;++t)e.points[t].normalImpulse=this.v_points[t].normalImpulse,e.points[t].tangentImpulse=this.v_points[t].tangentImpulse},_.prototype.solveVelocityConstraint=function(t){const e=this.m_fixtureA.m_body,i=this.m_fixtureB.m_body,n=e.c_velocity,m=i.c_velocity,h=this.v_invMassA,c=this.v_invIA,l=this.v_invMassB,a=this.v_invIB,_=o.clone(n.v);let u=n.w;const p=o.clone(m.v);let d=m.w;const y=this.v_normal,f=o.cross(y,1),x=this.v_friction;for(let t=0;t<this.v_pointCount;++t){let e=this.v_points[t],i=o.zero();i.addCombine(1,p,1,o.cross(d,e.rB)),i.subCombine(1,_,1,o.cross(u,e.rA)),e.relativeVelocity||(e.relativeVelocity=i);const n=o.dot(i,f)-this.v_tangentSpeed;let r=e.tangentMass*-n;const m=x*e.normalImpulse;let y=s.clamp(e.tangentImpulse+r,-m,m);r=y-e.tangentImpulse,e.tangentImpulse=y;let g=o.mul(r,f);_.subMul(h,g),u-=c*o.cross(e.rA,g),p.addMul(l,g),d+=a*o.cross(e.rB,g)}if(1==this.v_pointCount||0==t.blockSolve)for(let t=0;t<this.v_pointCount;++t){let e=this.v_points[t],i=o.zero();i.addCombine(1,p,1,o.cross(d,e.rB)),i.subCombine(1,_,1,o.cross(u,e.rA));const n=o.dot(i,y);let r=-e.normalMass*(n-e.velocityBias),m=s.max(e.normalImpulse+r,0);r=m-e.normalImpulse,e.normalImpulse=m;let f=o.mul(r,y);_.subMul(h,f),u-=c*o.cross(e.rA,f),p.addMul(l,f),d+=a*o.cross(e.rB,f)}else{const t=this.v_points[0],e=this.v_points[1],i=o.neo(t.normalImpulse,e.normalImpulse);let s=o.zero().add(p).add(o.cross(d,t.rB)).sub(_).sub(o.cross(u,t.rA)),n=o.zero().add(p).add(o.cross(d,e.rB)).sub(_).sub(o.cross(u,e.rA)),m=o.dot(s,y),f=o.dot(n,y);const x=o.neo(m-t.velocityBias,f-e.velocityBias);x.sub(r.mulVec2(this.v_K,i));for(;;){const s=r.mulVec2(this.v_normalMass,x).neg();if(s.x>=0&&s.y>=0){let n=o.sub(s,i),r=o.mul(n.x,y),m=o.mul(n.y,y);_.subCombine(h,r,h,m),u-=c*(o.cross(t.rA,r)+o.cross(e.rA,m)),p.addCombine(l,r,l,m),d+=a*(o.cross(t.rB,r)+o.cross(e.rB,m)),t.normalImpulse=s.x,e.normalImpulse=s.y;break}if(s.x=-t.normalMass*x.x,s.y=0,m=0,f=this.v_K.ex.y*s.x+x.y,s.x>=0&&f>=0){let n=o.sub(s,i),r=o.mul(n.x,y),m=o.mul(n.y,y);_.subCombine(h,r,h,m),u-=c*(o.cross(t.rA,r)+o.cross(e.rA,m)),p.addCombine(l,r,l,m),d+=a*(o.cross(t.rB,r)+o.cross(e.rB,m)),t.normalImpulse=s.x,e.normalImpulse=s.y;break}if(s.x=0,s.y=-e.normalMass*x.y,m=this.v_K.ey.x*s.y+x.x,f=0,s.y>=0&&m>=0){let n=o.sub(s,i),r=o.mul(n.x,y),m=o.mul(n.y,y);_.subCombine(h,r,h,m),u-=c*(o.cross(t.rA,r)+o.cross(e.rA,m)),p.addCombine(l,r,l,m),d+=a*(o.cross(t.rB,r)+o.cross(e.rB,m)),t.normalImpulse=s.x,e.normalImpulse=s.y;break}if(s.x=0,s.y=0,m=x.x,f=x.y,m>=0&&f>=0){let n=o.sub(s,i),r=o.mul(n.x,y),m=o.mul(n.y,y);_.subCombine(h,r,h,m),u-=c*(o.cross(t.rA,r)+o.cross(e.rA,m)),p.addCombine(l,r,l,m),d+=a*(o.cross(t.rB,r)+o.cross(e.rB,m)),t.normalImpulse=s.x,e.normalImpulse=s.y;break}break}}n.v.set(_),n.w=u,m.v.set(p),m.w=d};const y=[];_.addType=function(t,e,i){y[t]=y[t]||{},y[t][e]=i},_.create=function(t,e,i,s){const o=t.getType(),n=i.getType();let r,m;if(m=y[o]&&y[o][n])r=new _(t,e,i,s,m);else{if(!(m=y[n]&&y[n][o]))return null;r=new _(i,s,t,e,m)}t=r.getFixtureA(),i=r.getFixtureB(),e=r.getChildIndexA(),s=r.getChildIndexB();const h=t.getBody(),c=i.getBody();return r.m_nodeA.contact=r,r.m_nodeA.other=c,r.m_nodeA.prev=null,r.m_nodeA.next=h.m_contactList,null!=h.m_contactList&&(h.m_contactList.prev=r.m_nodeA),h.m_contactList=r.m_nodeA,r.m_nodeB.contact=r,r.m_nodeB.other=h,r.m_nodeB.prev=null,r.m_nodeB.next=c.m_contactList,null!=c.m_contactList&&(c.m_contactList.prev=r.m_nodeB),c.m_contactList=r.m_nodeB,0==t.isSensor()&&0==i.isSensor()&&(h.setAwake(!0),c.setAwake(!0)),r},_.destroy=function(t,e){const i=t.m_fixtureA,s=t.m_fixtureB,o=i.getBody(),n=s.getBody();t.isTouching()&&e.endContact(t),t.m_nodeA.prev&&(t.m_nodeA.prev.next=t.m_nodeA.next),t.m_nodeA.next&&(t.m_nodeA.next.prev=t.m_nodeA.prev),t.m_nodeA==o.m_contactList&&(o.m_contactList=t.m_nodeA.next),t.m_nodeB.prev&&(t.m_nodeB.prev.next=t.m_nodeB.next),t.m_nodeB.next&&(t.m_nodeB.next.prev=t.m_nodeB.prev),t.m_nodeB==n.m_contactList&&(n.m_contactList=t.m_nodeB.next),t.m_manifold.pointCount>0&&0==i.isSensor()&&0==s.isSensor()&&(o.setAwake(!0),n.setAwake(!0));const r=i.getType(),m=s.getType(),h=y[r][m].destroyFcn;"function"==typeof h&&h(t)}},function(t,e,i){t.exports=o;i(2);const s=i(0);function o(t,e,i,o){"object"==typeof t&&null!==t?(this.ex=s.clone(t),this.ey=s.clone(e)):"number"==typeof t?(this.ex=s.neo(t,i),this.ey=s.neo(e,o)):(this.ex=s.zero(),this.ey=s.zero())}o.prototype.toString=function(){return JSON.stringify(this)},o.isValid=function(t){return t&&s.isValid(t.ex)&&s.isValid(t.ey)},o.assert=function(t){},o.prototype.set=function(t,e,i,s){"number"==typeof t&&"number"==typeof e&&"number"==typeof i&&"number"==typeof s?(this.ex.set(t,i),this.ey.set(e,s)):"object"==typeof t&&"object"==typeof e?(this.ex.set(t),this.ey.set(e)):"object"==typeof t&&(this.ex.set(t.ex),this.ey.set(t.ey))},o.prototype.setIdentity=function(){this.ex.x=1,this.ey.x=0,this.ex.y=0,this.ey.y=1},o.prototype.setZero=function(){this.ex.x=0,this.ey.x=0,this.ex.y=0,this.ey.y=0},o.prototype.getInverse=function(){const t=this.ex.x,e=this.ey.x,i=this.ex.y,s=this.ey.y;let n=t*s-e*i;0!=n&&(n=1/n);const r=new o;return r.ex.x=n*s,r.ey.x=-n*e,r.ex.y=-n*i,r.ey.y=n*t,r},o.prototype.solve=function(t){const e=this.ex.x,i=this.ey.x,o=this.ex.y,n=this.ey.y;let r=e*n-i*o;0!=r&&(r=1/r);const m=s.zero();return m.x=r*(n*t.x-i*t.y),m.y=r*(e*t.y-o*t.x),m},o.mul=function(t,e){if(e&&"x"in e&&"y"in e){const i=t.ex.x*e.x+t.ey.x*e.y,o=t.ex.y*e.x+t.ey.y*e.y;return s.neo(i,o)}if(e&&"ex"in e&&"ey"in e)return new o(s.mul(t,e.ex),s.mul(t,e.ey))},o.mulVec2=function(t,e){const i=t.ex.x*e.x+t.ey.x*e.y,o=t.ex.y*e.x+t.ey.y*e.y;return s.neo(i,o)},o.mulMat22=function(t,e){return new o(s.mul(t,e.ex),s.mul(t,e.ey))},o.mulT=function(t,e){if(e&&"x"in e&&"y"in e)return s.neo(s.dot(e,t.ex),s.dot(e,t.ey));if(e&&"ex"in e&&"ey"in e){return new o(s.neo(s.dot(t.ex,e.ex),s.dot(t.ey,e.ex)),s.neo(s.dot(t.ex,e.ey),s.dot(t.ey,e.ey)))}},o.mulTVec2=function(t,e){return s.neo(s.dot(e,t.ex),s.dot(e,t.ey))},o.mulTMat22=function(t,e){return new o(s.neo(s.dot(t.ex,e.ex),s.dot(t.ey,e.ex)),s.neo(s.dot(t.ex,e.ey),s.dot(t.ey,e.ey)))},o.abs=function(t){return new o(s.abs(t.ex),s.abs(t.ey))},o.add=function(t,e){return new o(s.add(t.ex+e.ex),s.add(t.ey+e.ey))}},function(t,e,i){const s=i(0),o=i(6),n=i(1),r=i(3);function m(){this.type,this.localNormal=s.zero(),this.localPoint=s.zero(),this.points=[new h,new h],this.pointCount=0}function h(){this.localPoint=s.zero(),this.normalImpulse=0,this.tangentImpulse=0,this.id=new c}function c(){this.cf=new l}function l(){this.indexA,this.indexB,this.typeA,this.typeB}function a(){this.normal,this.points=[],this.separations=[]}m.e_circles=0,m.e_faceA=1,m.e_faceB=2,m.e_vertex=0,m.e_face=1,Object.defineProperty(c.prototype,"key",{get:function(){return this.cf.indexA+4*this.cf.indexB+16*this.cf.typeA+64*this.cf.typeB},enumerable:!0,configurable:!0}),c.prototype.set=function(t){this.cf.set(t.cf)},l.prototype.set=function(t){this.indexA=t.indexA,this.indexB=t.indexB,this.typeA=t.typeA,this.typeB=t.typeB},m.prototype.getWorldManifold=function(t,e,i,h,c){if(0==this.pointCount)return;let l=(t=t||new a).normal;const _=t.points,u=t.separations;switch(this.type){case m.e_circles:{l=s.neo(1,0);let t=o.mulVec2(e,this.localPoint),r=o.mulVec2(h,this.points[0].localPoint),m=s.sub(r,t);s.lengthSquared(m)>n.EPSILON*n.EPSILON&&(l.set(m),l.normalize()),_[0]=s.mid(t,r),u[0]=-c-i,_.length=1,u.length=1;break}case m.e_faceA:{l=r.mulVec2(e.q,this.localNormal);let t=o.mulVec2(e,this.localPoint);for(let e=0;e<this.pointCount;++e){let n=o.mulVec2(h,this.points[e].localPoint),r=s.clone(n).addMul(i-s.dot(s.sub(n,t),l),l),m=s.clone(n).subMul(c,l);_[e]=s.mid(r,m),u[e]=s.dot(s.sub(m,r),l)}_.length=this.pointCount,u.length=this.pointCount;break}case m.e_faceB:{l=r.mulVec2(h.q,this.localNormal);let t=o.mulVec2(h,this.localPoint);for(let n=0;n<this.pointCount;++n){let r=o.mulVec2(e,this.points[n].localPoint),m=s.combine(1,r,c-s.dot(s.sub(r,t),l),l),h=s.combine(1,r,-i,l);_[n]=s.mid(h,m),u[n]=s.dot(s.sub(h,m),l)}_.length=this.pointCount,u.length=this.pointCount,l.mul(-1);break}}return t.normal=l,t.points=_,t.separations=u,t};let _={nullState:0,addState:1,persistState:2,removeState:3};function u(){this.v=s.zero(),this.id=new c}u.prototype.set=function(t){this.v.set(t.v),this.id.set(t.id)},t.exports=m,t.exports.clipSegmentToLine=function(t,e,i,o,n){let r=0;const h=s.dot(i,e[0].v)-o,c=s.dot(i,e[1].v)-o;if(h<=0&&t[r++].set(e[0]),c<=0&&t[r++].set(e[1]),h*c<0){const i=h/(h-c);t[r].v.setCombine(1-i,e[0].v,i,e[1].v),t[r].id.cf.indexA=n,t[r].id.cf.indexB=e[0].id.cf.indexB,t[r].id.cf.typeA=m.e_vertex,t[r].id.cf.typeB=m.e_face,++r}return r},t.exports.clipVertex=u,t.exports.getPointStates=function(t,e,i,s){for(let e=0;e<i.pointCount;++e){let o=i.points[e].id;t[e]=_.removeState;for(let i=0;i<s.pointCount;++i)if(s.points[i].id.key==o.key){t[e]=_.persistState;break}}for(let t=0;t<s.pointCount;++t){let o=s.points[t].id;e[t]=_.addState;for(let s=0;s<i.pointCount;++s)if(i.points[s].id.key==o.key){e[t]=_.persistState;break}}},t.exports.PointState=_},function(t,e,i){const s=i(1),o=i(0);function n(t,e){if(pc.markPhysics2dModuleAsUsed(),!(this instanceof n))return new n(t,e);this.lowerBound=o.zero(),this.upperBound=o.zero(),"object"==typeof t&&this.lowerBound.set(t),"object"==typeof e&&this.upperBound.set(e)}t.exports=n,n.prototype.isValid=function(){return n.isValid(this)},n.prototype.containsPoints=function(t,e,i){if(void 0===this.radius||void 0===this.vertex1||void 0===this.vertex2&&void 0!==i)return!1;const o=this.radius-t;return-s.EPSILON<=o&&o<=s.EPSILON&&this.vertex1.closeTo(e)&&(this.vertex2===i||this.vertex2.closeTo(i))},n.prototype.storePoints=function(t,e,i){void 0===this.vertex1?this.vertex1=o.clone(e):this.vertex1.set(e),void 0===i?this.vertex2=i:void 0===this.vertex2?this.vertex2=o.clone(i):this.vertex2.set(i),this.radius=t},n.isValid=function(t){const e=o.sub(t.upperBound,t.lowerBound);return e.x>=0&&e.y>=0&&o.isValid(t.lowerBound)&&o.isValid(t.upperBound)},n.assert=function(t){},n.prototype.getCenter=function(){return o.neo(.5*(this.lowerBound.x+this.upperBound.x),.5*(this.lowerBound.y+this.upperBound.y))},n.prototype.getExtents=function(){return o.neo(.5*(this.upperBound.x-this.lowerBound.x),.5*(this.upperBound.y-this.lowerBound.y))},n.prototype.getPerimeter=function(){return 2*(this.upperBound.x-this.lowerBound.x+this.upperBound.y-this.lowerBound.y)},n.prototype.combine=function(t,e){const i=t.lowerBound,o=t.upperBound,n=e.lowerBound,r=e.upperBound,m=s.min(i.x,n.x),h=s.min(i.y,n.y),c=s.max(r.x,o.x),l=s.max(r.y,o.y);this.lowerBound.set(m,h),this.upperBound.set(c,l)},n.prototype.combinePoints=function(t,e){this.lowerBound.set(s.min(t.x,e.x),s.min(t.y,e.y)),this.upperBound.set(s.max(t.x,e.x),s.max(t.y,e.y))},n.prototype.set=function(t){this.lowerBound.set(t.lowerBound.x,t.lowerBound.y),this.upperBound.set(t.upperBound.x,t.upperBound.y)},n.prototype.contains=function(t){let e=!0;return e=e&&this.lowerBound.x<=t.lowerBound.x,e=e&&this.lowerBound.y<=t.lowerBound.y,e=e&&t.upperBound.x<=this.upperBound.x,e=e&&t.upperBound.y<=this.upperBound.y,e},n.prototype.extend=function(t){n.extend(this,t)},n.extend=function(t,e){t.lowerBound.x-=e,t.lowerBound.y-=e,t.upperBound.x+=e,t.upperBound.y+=e},n.testOverlap=function(t,e){return!(e.lowerBound.x>t.upperBound.x||e.lowerBound.y>t.upperBound.y||t.lowerBound.x>e.upperBound.x||t.lowerBound.y>e.upperBound.y)},n.areEqual=function(t,e){return o.areEqual(t.lowerBound,e.lowerBound)&&o.areEqual(t.upperBound,e.upperBound)},n.diff=function(t,e){const i=s.max(0,s.min(t.upperBound.x,e.upperBound.x)-s.max(e.lowerBound.x,t.lowerBound.x)),o=s.max(0,s.min(t.upperBound.y,e.upperBound.y)-s.max(e.lowerBound.y,t.lowerBound.y));return(t.upperBound.x-t.lowerBound.x)*(t.upperBound.y-t.lowerBound.y)+(e.upperBound.x-e.lowerBound.x)*(e.upperBound.y-e.lowerBound.y)-i*o},n.prototype.rayCast=function(t,e){let i=-1/0,n=1/0;const r=e.p1,m=o.sub(e.p2,e.p1),h=o.abs(m),c=o.zero();for(let t="x";null!==t;t="x"===t?"y":null)if(h.x<s.EPSILON){if(r[t]<this.lowerBound[t]||this.upperBound[t]<r[t])return!1}else{const e=1/m[t];let o=(this.lowerBound[t]-r[t])*e,h=(this.upperBound[t]-r[t])*e,l=-1;if(o>h){const t=o;o=h,h=t,l=1}if(o>i&&(c.setZero(),c[t]=l,i=o),n=s.min(n,h),i>n)return!1}return!(i<0||e.maxFraction<i)&&(t.fraction=i,t.normal=c,!0)},n.prototype.toString=function(){return JSON.stringify(this)}},function(t,e){function i(){this.m_type,this.m_radius}t.exports=i,i.isValid=function(t){return!!t},i.prototype.getRadius=function(){return this.m_radius},i.prototype.getType=function(){return this.m_type},i.prototype._clone=function(){},i.prototype.getChildCount=function(){},i.prototype.testPoint=function(t,e){},i.prototype.rayCast=function(t,e,i,s){},i.prototype.computeAABB=function(t,e,i){},i.prototype.setAABB=function(t,e,i){},i.prototype.resetAABB=function(t,e,i){return null},i.prototype.computeMass=function(t,e){},i.prototype.computeDistanceProxy=function(t){}},function(t,e,i){t.exports=_,t.exports.Input=c,t.exports.Output=l,t.exports.Proxy=u,t.exports.Cache=a;const s=i(4),o=(i(2),i(22)),n=i(1),r=i(0),m=i(3),h=i(6);function c(){this.proxyA=new u,this.proxyB=new u,this.transformA=null,this.transformB=null,this.useRadii=!1,this.overlap=!1}function l(){this.pointA=r.zero(),this.pointB=r.zero(),this.distance,this.iterations}function a(){this.metric=0,this.indexA=[],this.indexB=[],this.count=0}function _(t,e,i){++o.gjkCalls;const c=i.proxyA,l=i.proxyB,a=i.transformA,_=i.transformB,u=new d;u.readCache(e,c,a,l,_);const p=u.m_v,y=s.maxDistnceIterations,f=[],x=[];let g=0,v=1/0,A=1/0,b=0;for(;b<y;){g=u.m_count;for(let t=0;t<g;++t)f[t]=p[t].indexA,x[t]=p[t].indexB;if(u.solve(),3==u.m_count)break;A=u.getClosestPoint().lengthSquared(),v=A;const t=u.getSearchDirection();if(t.lengthSquared()<n.EPSILON*n.EPSILON)break;const e=p[u.m_count];e.indexA=c.getSupport(m.mulTVec2(a.q,r.neg(t))),e.wA=h.mulVec2(a,c.getVertex(e.indexA)),e.indexB=l.getSupport(m.mulTVec2(_.q,t)),e.wB=h.mulVec2(_,l.getVertex(e.indexB)),e.w=r.sub(e.wB,e.wA),++b,++o.gjkIters;let i=!1;for(let t=0;t<g;++t)if(e.indexA==f[t]&&e.indexB==x[t]){i=!0;break}if(i)break;++u.m_count}if(o.gjkMaxIters=n.max(o.gjkMaxIters,b),u.getWitnessPoints(t.pointA,t.pointB),t.distance=r.distance(t.pointA,t.pointB),t.iterations=b,u.writeCache(e),i.useRadii){const e=c.m_radius,s=l.m_radius;if(i.overlap||t.distance>e+s&&t.distance>n.EPSILON){t.distance-=e+s;const i=r.sub(t.pointB,t.pointA);i.normalize(),t.pointA.addMul(e,i),t.pointB.subMul(s,i)}else{let e=r.mid(t.pointA,t.pointB);t.pointA.set(e),t.pointB.set(e),t.distance=0}}}function u(){this.m_buffer=[],this.m_vertices=[],this.m_count=0,this.m_radius=0}function p(){this.indexA,this.indexB,this.wA=r.zero(),this.wB=r.zero(),this.w=r.zero(),this.a}function d(){this.m_v1=new p,this.m_v2=new p,this.m_v3=new p,this.m_v=[this.m_v1,this.m_v2,this.m_v3],this.m_count}o.gjkCalls=0,o.gjkIters=0,o.gjkMaxIters=0,c.prototype.clear=function(){this.proxyA.clear(),this.proxyB.clear(),this.transformA=null,this.transformB=null,this.useRadii=!1,this.overlap=!1},l.prototype.clear=function(){this.pointA.setZero(),this.pointB.setZero(),this.distance=0,this.iterations=0},a.prototype.clear=function(){this.metric=0,this.indexA.length=0,this.indexB.length=0,this.count=0},u.prototype.clear=function(){this.m_buffer.length=0,this.m_vertices=[],this.m_count=0,this.m_radius=0},u.prototype.getVertexCount=function(){return this.m_count},u.prototype.getVertex=function(t){return this.m_vertices[t]},u.prototype.getSupport=function(t){let e=0,i=r.dot(this.m_vertices[0],t);for(let s=0;s<this.m_count;++s){const o=r.dot(this.m_vertices[s],t);o>i&&(e=s,i=o)}return e},u.prototype.getSupportVertex=function(t){return this.m_vertices[this.getSupport(t)]},u.prototype.set=function(t,e){t.computeDistanceProxy(this,e)},p.prototype.set=function(t){this.indexA=t.indexA,this.indexB=t.indexB,this.wA=r.clone(t.wA),this.wB=r.clone(t.wB),this.w=r.clone(t.w),this.a=t.a},d.prototype.print=function(){return 3==this.m_count?["+"+this.m_count,this.m_v1.a,this.m_v1.wA.x,this.m_v1.wA.y,this.m_v1.wB.x,this.m_v1.wB.y,this.m_v2.a,this.m_v2.wA.x,this.m_v2.wA.y,this.m_v2.wB.x,this.m_v2.wB.y,this.m_v3.a,this.m_v3.wA.x,this.m_v3.wA.y,this.m_v3.wB.x,this.m_v3.wB.y].toString():2==this.m_count?["+"+this.m_count,this.m_v1.a,this.m_v1.wA.x,this.m_v1.wA.y,this.m_v1.wB.x,this.m_v1.wB.y,this.m_v2.a,this.m_v2.wA.x,this.m_v2.wA.y,this.m_v2.wB.x,this.m_v2.wB.y].toString():1==this.m_count?["+"+this.m_count,this.m_v1.a,this.m_v1.wA.x,this.m_v1.wA.y,this.m_v1.wB.x,this.m_v1.wB.y].toString():"+"+this.m_count},d.prototype.readCache=function(t,e,i,s,o){this.m_count=t.count;for(let n=0;n<this.m_count;++n){let m=this.m_v[n];m.indexA=t.indexA[n],m.indexB=t.indexB[n];let c=e.getVertex(m.indexA),l=s.getVertex(m.indexB);m.wA=h.mulVec2(i,c),m.wB=h.mulVec2(o,l),m.w=r.sub(m.wB,m.wA),m.a=0}if(this.m_count>1){const e=t.metric,i=this.getMetric();(i<.5*e||2*e<i||i<n.EPSILON)&&(this.m_count=0)}if(0==this.m_count){let t=this.m_v[0];t.indexA=0,t.indexB=0;let n=e.getVertex(0),m=s.getVertex(0);t.wA=h.mulVec2(i,n),t.wB=h.mulVec2(o,m),t.w=r.sub(t.wB,t.wA),t.a=1,this.m_count=1}},d.prototype.writeCache=function(t){t.metric=this.getMetric(),t.count=this.m_count;for(let e=0;e<this.m_count;++e)t.indexA[e]=this.m_v[e].indexA,t.indexB[e]=this.m_v[e].indexB},d.prototype.getSearchDirection=function(){switch(this.m_count){case 1:return r.neg(this.m_v1.w);case 2:{const t=r.sub(this.m_v2.w,this.m_v1.w);return r.cross(t,r.neg(this.m_v1.w))>0?r.cross(1,t):r.cross(t,1)}default:return r.zero()}},d.prototype.getClosestPoint=function(){switch(this.m_count){default:return r.zero();case 1:return r.clone(this.m_v1.w);case 2:return r.combine(this.m_v1.a,this.m_v1.w,this.m_v2.a,this.m_v2.w)}},d.prototype.getWitnessPoints=function(t,e){switch(this.m_count){default:break;case 1:t.set(this.m_v1.wA),e.set(this.m_v1.wB);break;case 2:t.setCombine(this.m_v1.a,this.m_v1.wA,this.m_v2.a,this.m_v2.wA),e.setCombine(this.m_v1.a,this.m_v1.wB,this.m_v2.a,this.m_v2.wB);break;case 3:t.setCombine(this.m_v1.a,this.m_v1.wA,this.m_v2.a,this.m_v2.wA),t.addMul(this.m_v3.a,this.m_v3.wA),e.set(t)}},d.prototype.getMetric=function(){switch(this.m_count){default:return 0;case 2:return r.distance(this.m_v1.w,this.m_v2.w);case 3:return r.cross(r.sub(this.m_v2.w,this.m_v1.w),r.sub(this.m_v3.w,this.m_v1.w))}},d.prototype.solve=function(){switch(this.m_count){case 1:break;case 2:this.solve2();break;case 3:this.solve3()}},d.prototype.solve2=function(){const t=this.m_v1.w,e=this.m_v2.w,i=r.sub(e,t),s=-r.dot(t,i);if(s<=0)return this.m_v1.a=1,void(this.m_count=1);const o=r.dot(e,i);if(o<=0)return this.m_v2.a=1,this.m_count=1,void this.m_v1.set(this.m_v2);const n=1/(o+s);this.m_v1.a=o*n,this.m_v2.a=s*n,this.m_count=2},d.prototype.solve3=function(){const t=this.m_v1.w,e=this.m_v2.w,i=this.m_v3.w,s=r.sub(e,t),o=r.dot(t,s),n=r.dot(e,s),m=-o,h=r.sub(i,t),c=r.dot(t,h),l=r.dot(i,h),a=-c,_=r.sub(i,e),u=r.dot(e,_),p=r.dot(i,_),d=-u,y=r.cross(s,h),f=y*r.cross(e,i),x=y*r.cross(i,t),g=y*r.cross(t,e);if(m<=0&&a<=0)return this.m_v1.a=1,void(this.m_count=1);if(n>0&&m>0&&g<=0){const t=1/(n+m);return this.m_v1.a=n*t,this.m_v2.a=m*t,void(this.m_count=2)}if(l>0&&a>0&&x<=0){const t=1/(l+a);return this.m_v1.a=l*t,this.m_v3.a=a*t,this.m_count=2,void this.m_v2.set(this.m_v3)}if(n<=0&&d<=0)return this.m_v2.a=1,this.m_count=1,void this.m_v1.set(this.m_v2);if(l<=0&&p<=0)return this.m_v3.a=1,this.m_count=1,void this.m_v1.set(this.m_v3);if(p>0&&d>0&&f<=0){const t=1/(p+d);return this.m_v2.a=p*t,this.m_v3.a=d*t,this.m_count=2,void this.m_v1.set(this.m_v3)}const v=1/(f+x+g);this.m_v1.a=f*v,this.m_v2.a=x*v,this.m_v3.a=g*v,this.m_count=3},_.testOverlap=function(t,e,i,s,o,r){const m=_.getInput();m.clear(),m.proxyA.set(t,e),m.proxyB.set(i,s),m.transformA=o,m.transformB=r,m.useRadii=!0;const h=_.getCache();h.clear();const c=_.getOutput();return c.clear(),_(c,h,m),c.distance<10*n.EPSILON},_.getInput=function(){return _._input=_._input||new c},_.getCache=function(){return _._cache=_._cache||new a},_.getOutput=function(){return _._output=_._output||new l}},function(t,e,i){t.exports=h;i(2);const s=i(5),o=i(1),n=i(3),r=i(0),m=i(13);function h(t,e){if(pc.markPhysics2dModuleAsUsed(),!(this instanceof h))return new h(t,e);h._super.call(this),this.m_type=h.TYPE,this.m_p=r.zero(),this.m_radius=1,"object"==typeof t&&r.isValid(t)?(this.m_p.set(t),"number"==typeof e&&(this.m_radius=e)):"number"==typeof t&&(this.m_radius=t)}h._super=m,h.prototype=s(h._super.prototype),h.TYPE="circle",h.prototype.getRadius=function(){return this.m_radius},h.prototype.setRadius=function(t){this.m_radius=t},h.prototype.getCenter=function(){return this.m_p},h.prototype.getVertex=function(t){return this.m_p},h.prototype.getVertexCount=function(t){return 1},h.prototype._clone=function(){const t=new h;return t.m_type=this.m_type,t.m_radius=this.m_radius,t.m_p=this.m_p.clone(),t},h.prototype.getChildCount=function(){return 1},h.prototype.testPoint=function(t,e){const i=r.add(t.p,n.mulVec2(t.q,this.m_p)),s=r.sub(e,i);return r.dot(s,s)<=this.m_radius*this.m_radius},h.prototype.rayCast=function(t,e,i,s){const m=r.add(i.p,n.mulVec2(i.q,this.m_p)),h=r.sub(e.p1,m),c=r.dot(h,h)-this.m_radius*this.m_radius,l=r.sub(e.p2,e.p1);if(c<0)return t.fraction=0,t.normal=l.neg().normal(),!0;const a=r.dot(h,l),_=r.dot(l,l),u=a*a-_*c;if(u<0||_<o.EPSILON)return!1;let p=-(a+o.sqrt(u));return p>=0&&p<=e.maxFraction*_&&(p/=_,t.fraction=p,t.normal=r.add(h,r.mul(p,l)).normal(),!0)},h.prototype.computeAABB=function(t,e,i){const s=r.add(e.p,n.mulVec2(e.q,this.m_p));t.lowerBound.set(s.x-this.m_radius,s.y-this.m_radius),t.upperBound.set(s.x+this.m_radius,s.y+this.m_radius)},h.prototype.setAABB=function(t,e,i){this.computeAABB(t,e,i),t.storePoints(this.m_radius,this.m_p)},h.prototype.resetAABB=function(t,e,i){return t.containsPoints(this.m_radius,this.m_p)?null:(this.computeAABB(t,e,i),t.storePoints(this.m_radius,this.m_p),t)},h.prototype.computeMass=function(t,e){t.mass=e*o.PI*this.m_radius*this.m_radius,t.center=this.m_p,t.I=t.mass*(.5*this.m_radius*this.m_radius+r.dot(this.m_p,this.m_p))},h.prototype.computeDistanceProxy=function(t){t.m_vertices.push(this.m_p),t.m_count=1,t.m_radius=this.m_radius}},function(t,e,i){t.exports=f;i(2);const s=i(5),o=i(1),n=i(6),r=i(3),m=i(0),h=i(4),c=i(13),l=new m;let a=new m,_=new m;const u=new m,p=new m;let d=new m;const y=new r;function f(t){if(pc.markPhysics2dModuleAsUsed(),!(this instanceof f))return new f(t);f._super.call(this),this.m_type=f.TYPE,this.m_radius=h.polygonRadius,this.m_edgeRadius=0,this.m_centroid=m.zero(),this.m_vertices=[],this.m_normals=[],this.m_count=0,this.m_outsidePoint=new m(1,1),t&&t.length&&this._set(t)}f._super=c,f.prototype=s(f._super.prototype),f.TYPE="polygon",f.prototype.setRadius=function(t){this.m_radius=h.polygonRadius,t>0?(this.m_edgeRadius=t,this.m_radius+=t):this.m_edgeRadius=0},f.prototype.getRadius=function(){return this.m_edgeRadius},f.prototype.getVertex=function(t){return this.m_vertices[t]},f.prototype._clone=function(){const t=new f;t.m_type=this.m_type,t.m_radius=this.m_radius,t.m_count=this.m_count,t.m_centroid.set(this.m_centroid),t.m_outsidePoint.set(this.m_outsidePoint);for(let e=0;e<this.m_count;e++)t.m_vertices.push(this.m_vertices[e].clone());for(let e=0;e<this.m_normals.length;e++)t.m_normals.push(this.m_normals[e].clone());return t},f.prototype.getChildCount=function(){return 1},f.prototype._set=function(t){if(t.length<3)return void this._setAsBox(1,1);let e=o.min(t.length,h.maxPolygonVertices);const i=[];let s=0;for(let o=0;o<e;++o){const e=t[o];let n=!0;for(let t=0;t<s;++t)if(e.x===i[t].x&&e.y===i[t].y){n=!1;break}n&&(i[s++]=e)}if(e=s,e<3)return void this._setAsBox(1,1);let n=0,r=i[0].x;for(let t=1;t<e;++t){const e=i[t].x;(e>r||e===r&&i[t].y<i[n].y)&&(n=t,r=e)}const c=[];let l=0,a=n;for(;;){c[l]=a;let t=0;for(let s=1;s<e;++s){if(t===a){t=s;continue}const e=m.sub(i[t],i[c[l]]),o=m.sub(i[s],i[c[l]]),n=m.cross(e,o);n<0&&(t=s),0===n&&o.lengthSquared()>e.lengthSquared()&&(t=s)}if(++l,a=t,t===n)break}if(l<3)this._setAsBox(1,1);else{if(this.m_count=l,l>0){let t=-1/0,e=t;for(let s,o=0;o<l;++o)s=this.m_vertices[o]=i[c[o]],s.x>t&&(t=s.x),s.y>e&&(e=s.y);this.m_outsidePoint.x=t+1,this.m_outsidePoint.y=e+1}for(let t=0;t<l;++t){const e=t,i=t+1<l?t+1:0,s=m.sub(this.m_vertices[i],this.m_vertices[e]);this.m_normals[t]=m.cross(s,1),this.m_normals[t].normalize()}this.m_centroid=function(t,e){const i=m.zero();let s=0;const o=m.zero(),n=1/3;for(let r=0;r<e;++r){const h=o,c=t[r],l=r+1<e?t[r+1]:t[0],a=m.sub(c,h),_=m.sub(l,h),u=.5*m.cross(a,_);s+=u,i.addMul(u*n,h),i.addMul(u*n,c),i.addMul(u*n,l)}return i.mul(1/s),i}(this.m_vertices,l)}},f.prototype._setAsBox=function(t,e,i,s){if(this.m_vertices[3]?(this.m_vertices[0].set(-t,-e),this.m_vertices[1].set(t,-e),this.m_vertices[2].set(t,e),this.m_vertices[3].set(-t,e)):(this.m_vertices[0]=m.neo(-t,-e),this.m_vertices[1]=m.neo(t,-e),this.m_vertices[2]=m.neo(t,e),this.m_vertices[3]=m.neo(-t,e)),this.m_normals[3]?(this.m_normals[0].set(0,-1),this.m_normals[1].set(1,0),this.m_normals[2].set(0,1),this.m_normals[3].set(-1,0)):(this.m_normals[0]=m.neo(0,-1),this.m_normals[1]=m.neo(1,0),this.m_normals[2]=m.neo(0,1),this.m_normals[3]=m.neo(-1,0)),this.m_count=4,m.isValid(i)&&(i.x<-o.EPSILON||o.EPSILON<i.x||i.y<-o.EPSILON||o.EPSILON<i.y)){s=s||0,this.m_centroid.set(i),y.set(s);let t=-1/0,e=t;for(let s,o=0;o<this.m_count;++o)s=this.m_vertices[o]=this.m_vertices[o].rot(y).add(i),this.m_normals[o]=this.m_normals[o].rot(y),s.x>t&&(t=s.x),s.y>e&&(e=s.y);this.m_outsidePoint.x=t+1,this.m_outsidePoint.y=e+1}else this.m_outsidePoint.x=this.m_outsidePoint.y=(t>e?t:e)+1},f.prototype.testPoint=function(t,e){const i=l.set(e).sub(t.p).rotT(t.q);for(let t=0;t<this.m_count;++t){if(m.dot(this.m_normals[t],a.set(i).sub(this.m_vertices[t]))>0)return!1}return!0},f.prototype.rayCast=function(t,e,i,s){a.set(e.p1),_.set(e.p2),a=a.sub(i.p).rotT(i.q),_=_.sub(i.p).rotT(i.q),d=d.set(_).sub(a);const n=m.dot(d,d)<=o.EPSILON;n&&(d=d.set(this.m_outsidePoint).sub(a));const r=e.maxFraction;let h,c,y=r,f=-1,x=0;for(let e=this.m_count,s=0;s<e;++s){u.set(this.m_vertices[s]);const e=this.m_normals[s],_=m.dot(e,l.set(u).sub(a)),g=m.dot(e,d);if(-o.EPSILON<=g&&g<=o.EPSILON)continue;const v=_/g;l.set(d).mul(v).add(a),p.set(this.m_vertices[s+1<this.m_count?s+1:0]);const A=m.dot(u.sub(l),p.sub(l));let b=A<o.EPSILON;if(b){if(h=0,c=r,b=v>=0,b&&(A>-o.EPSILON?g<0?x-=.5:x+=.5:x+=1),g<0&&b){if(h<=c)return!n&&(t.fraction=v,t.normal=d.set(this.m_normals[s]).rot(i.q),!0);h=v}else{if(!(g>0&&v<c))continue;c=v}h<=c&&v<=y&&(f=s,y=v)}}return x<0&&(x=-x),o.abs(x%2-1)<o.EPSILON?(t.fraction=0,t.normal=n?m.ZERO:d.neg().normal().rot(i.q),!0):f>=0&&!n&&(t.fraction=y,t.normal=d.set(this.m_normals[f]).rot(i.q),!0)},f.prototype.computeAABB=function(t,e,i){let s=1/0,r=1/0,m=-1/0,h=-1/0;for(let t=0;t<this.m_count;++t){const i=n.mulVec2(e,this.m_vertices[t],u);s=o.min(s,i.x),m=o.max(m,i.x),r=o.min(r,i.y),h=o.max(h,i.y)}t.lowerBound.set(s,r),t.upperBound.set(m,h),t.extend(this.m_radius)},f.prototype.setAABB=f.prototype.computeAABB,f.prototype.resetAABB=function(t,e,i){return this.computeAABB(t,e,i),t},f.prototype.computeMass=function(t,e){const i=m.zero();let s=0,o=0;const n=m.zero();for(let t=0;t<this.m_count;++t)n.add(this.m_vertices[t]);n.mul(1/this.m_count);const r=1/3;for(let t=0;t<this.m_count;++t){const e=m.sub(this.m_vertices[t],n),h=t+1<this.m_count?m.sub(this.m_vertices[t+1],n):m.sub(this.m_vertices[0],n),c=m.cross(e,h),l=.5*c;s+=l,i.addCombine(l*r,e,l*r,h);const a=e.x,_=e.y,u=h.x,p=h.y;o+=.25*r*c*(a*a+u*a+u*u+(_*_+p*_+p*p))}t.mass=e*s,i.mul(1/s),t.center.setCombine(1,i,1,n),t.I=e*o,t.I+=t.mass*(m.dot(t.center,t.center)-m.dot(i,i))},f.prototype.validate=function(){for(let t=0;t<this.m_count;++t){const e=t,i=t<this.m_count-1?e+1:0,s=this.m_vertices[e],o=m.sub(this.m_vertices[i],s);for(let t=0;t<this.m_count;++t){if(t===e||t===i)continue;const n=m.sub(this.m_vertices[t],s);if(m.cross(o,n)<0)return!1}}return!0},f.prototype.computeDistanceProxy=function(t){t.m_vertices=this.m_vertices,t.m_count=this.m_count,t.m_radius=this.m_radius}},function(t,e,i){t.exports=o;i(2);const s=i(1);function o(t,e,i){if(!(this instanceof o))return new o(t,e,i);void 0===t?(this.x=0,this.y=0,this.z=0):"object"==typeof t?(this.x=t.x,this.y=t.y,this.z=t.z):(this.x=t,this.y=e,this.z=i)}o.neo=function(t,e,i){const s=Object.create(o.prototype);return s.x=t,s.y=e,s.z=i,s},o.clone=function(t){return o.neo(t.x,t.y,t.z)},o.prototype.toString=function(){return JSON.stringify(this)},o.isValid=function(t){return t&&s.isFinite(t.x)&&s.isFinite(t.y)&&s.isFinite(t.z)},o.assert=function(t){},o.prototype.setZero=function(){return this.x=0,this.y=0,this.z=0,this},o.prototype.set=function(t,e,i){return this.x=t,this.y=e,this.z=i,this},o.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},o.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this},o.prototype.mul=function(t){return this.x*=t,this.y*=t,this.z*=t,this},o.areEqual=function(t,e){return t==e||"object"==typeof t&&null!==t&&"object"==typeof e&&null!==e&&t.x===e.x&&t.y===e.y&&t.z===e.z},o.dot=function(t,e){return t.x*e.x+t.y*e.y+t.z*e.z},o.cross=function(t,e){return new o(t.y*e.z-t.z*e.y,t.z*e.x-t.x*e.z,t.x*e.y-t.y*e.x)},o.add=function(t,e){return new o(t.x+e.x,t.y+e.y,t.z+e.z)},o.sub=function(t,e){return new o(t.x-e.x,t.y-e.y,t.z-e.z)},o.mul=function(t,e){return new o(e*t.x,e*t.y,e*t.z)},o.prototype.neg=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},o.neg=function(t){return new o(-t.x,-t.y,-t.z)}},function(t,e,i){t.exports=y;const s=i(5),o=i(4),n=i(13),r=i(1),m=i(6),h=i(3),c=i(0);let l=new c,a=new c,_=new c,u=new c,p=new c,d=new c;function y(t,e,i){if(pc.markPhysics2dModuleAsUsed(),!(this instanceof y))return new y(t,e,i);y._super.call(this),this.m_type=y.TYPE,this.m_vertex1=t?c.clone(t):c.zero(),this.m_vertex2=e?c.clone(e):c.zero(),this.setRadius(i),this.m_vertex0=c.zero(),this.m_vertex3=c.zero(),this.m_hasVertex0=!1,this.m_hasVertex3=!1,this.m_noAlignRot=!0}y._super=n,y.prototype=s(y._super.prototype),y.TYPE="edge",y.prototype.setRadius=function(t){this.m_radius=o.polygonRadius,t>0?(this.m_edgeRadius=t,this.m_radius+=t):this.m_edgeRadius=0},y.prototype.getRadius=function(){return this.m_edgeRadius},y.prototype.setVertex1=function(t,e){this.m_vertex1.set(t,e),this.m_noAlignRot=!0},y.prototype.setVertex2=function(t,e){this.m_vertex2.set(t,e),this.m_noAlignRot=!0},y.prototype.setNext=function(t){return t?(this.m_vertex3.set(t),this.m_hasVertex3=!0):(this.m_vertex3.setZero(),this.m_hasVertex3=!1),this},y.prototype.setPrev=function(t){return t?(this.m_vertex0.set(t),this.m_hasVertex0=!0):(this.m_vertex0.setZero(),this.m_hasVertex0=!1),this},y.prototype._set=function(t,e){return this.m_vertex1.set(t),this.m_vertex2.set(e),this.m_hasVertex0=!1,this.m_hasVertex3=!1,this.m_noAlignRot=!0,this},y.prototype._clone=function(){const t=new y;return t.m_type=this.m_type,t.m_radius=this.m_radius,t.m_vertex1.set(this.m_vertex1),t.m_vertex2.set(this.m_vertex2),t.m_vertex0.set(this.m_vertex0),t.m_vertex3.set(this.m_vertex3),t.m_hasVertex0=this.m_hasVertex0,t.m_hasVertex3=this.m_hasVertex3,t.m_edgeRadius=this.m_edgeRadius,t},y.prototype.getChildCount=function(){return 1},y.prototype.testPoint=function(t,e){if(this.m_edgeRadius<=0)return!1;e=a.set(e).sub(t.p).rotT(t.q),this.m_noAlignRot&&(this.m_alignRot=this._getAlignRot(),this.m_alignedV2=this._alignPoint((this.m_alignedV2||new c).set(this.m_vertex2))),e=this._alignPoint(e);const i=this.m_alignedV2,s=this.m_edgeRadius;if(e.y>i.y){const t=e.x-i.x,o=e.y-i.y;return t*t+o*o<=s*s}return e.y<0?e.x*e.x+e.y*e.y<=s*s:-s<=e.x&&e.x<=s},y.prototype._getAlignRot=function(){const t=this.m_alignRot=this.m_alignRot||new h;this.m_noAlignRot=!1;const e=this.m_vertex1,i=this.m_vertex2,s=d.set(i).sub(e).length();return s<=r.EPSILON||(t.c=d.y/s,t.s=d.x/s),t},y.prototype._alignPoint=function(t){return t.sub(this.m_vertex1).rot(this.m_alignRot)},y.prototype.rayCast=function(t,e,i,s){if(this.m_edgeRadius>0)return this.rayCastWithRadius(t,e,i);u=u.set(this.m_vertex1),p=p.set(this.m_vertex2),p=p.sub(u);const o=p;l=l.set(o.y,-o.x);const n=l,m=n.normalize();if(m<=r.EPSILON)return!1;a=a.set(e.p1).sub(i.p).rotT(i.q),_=_.set(e.p2).sub(i.p).rotT(i.q),d=d.set(_).sub(a);const h=c.dot(n,d);if(h<=r.EPSILON)return!1;_=_.set(u).sub(a);const y=c.dot(n,_),f=y/h;if(f<0||e.maxFraction<f)return!1;const x=m*m;d=d.mul(f),a=a.add(d);let g=a;g=g.sub(u);const v=c.dot(g,o)/x;return!(v<0||v>1)&&(t.fraction=f,t.normal=y>0?n.rot(i.q).neg():n.rot(i.q),!0)},y.prototype.rayCastWithRadius=function(t,e,i){l=l.set(e.p2).sub(e.p1);const s=l.normalize();if(r.EPSILON>=s&&s>=-r.EPSILON)return!!this.testPoint(i,e.p1)&&(t.fraction=0,t.normal=l.neg(),!0);const o=this.m_edgeRadius,n=function(t,e,i,s,o){const n=u,m=p,h=d;n.set(s).sub(i),m.set(t).sub(i);const l=c.dot(n,n),a=c.dot(n,e),_=c.dot(n,m),y=c.dot(e,m),f=c.dot(m,m),x=l-a*a;let g=l*y-_*a,v=l*f-_*_-o*o*l,A=g*g-x*v;if(A>=0){const i=(-g-r.sqrt(A))/x,n=_+i*a;if(n>0&&n<l)return i;if(n<=0?h.set(m):h.set(t).sub(s),g=c.dot(e,h),v=c.dot(h,h)-o*o,A=g*g-v,A>0)return-g-r.sqrt(A)}return 1/0}(e.p1,l,this.m_vertex1,this.m_vertex2,o);if(n>s)return!1;if(n<=0)return!!this.testPoint(i,e.p1)&&(t.fraction=0,t.normal=l.neg(),!0);this.m_noAlignRot&&(this.m_alignRot=this._getAlignRot(),this.m_alignedV2=this._alignPoint((this.m_alignedV2||new c).set(this.m_vertex2)));const m=this.m_alignedV2.y;return l=this._alignPoint(l.mul(n).add(e.p1)),l.y>m?l.y-=m:l.y>0&&(l.y=0),t.normal=l.mul(1/o).rotT(this.m_alignRot).rot(i.q),t.fraction=n/s,!0},y.prototype.computeAABB=function(t,e,i){const s=m.mulVec2(e,this.m_vertex1),o=m.mulVec2(e,this.m_vertex2);t.combinePoints(s,o),t.extend(this.m_radius)},y.prototype.setAABB=function(t,e,i){this.computeAABB(t,e,i),t.storePoints(this.m_radius,this.m_vertex1,this.m_vertex2)},y.prototype.resetAABB=function(t,e,i){return t.containsPoints(this.m_radius,this.m_vertex1,this.m_vertex2)?null:(this.computeAABB(t,e,i),t.storePoints(this.m_radius,this.m_vertex1,this.m_vertex2),t)},y.prototype.computeMass=function(t,e){t.mass=0,t.center.setCombine(.5,this.m_vertex1,.5,this.m_vertex2),t.I=0},y.prototype.computeDistanceProxy=function(t){t.m_vertices.push(this.m_vertex1),t.m_vertices.push(this.m_vertex2),t.m_count=2,t.m_radius=this.m_radius}},function(t,e,i){t.exports=n;i(2);const s=i(0),o=i(17);function n(t,e,i){"object"==typeof t&&null!==t?(this.ex=o.clone(t),this.ey=o.clone(e),this.ez=o.clone(i)):(this.ex=o(),this.ey=o(),this.ez=o())}n.prototype.toString=function(){return JSON.stringify(this)},n.isValid=function(t){return t&&o.isValid(t.ex)&&o.isValid(t.ey)&&o.isValid(t.ez)},n.assert=function(t){},n.prototype.setZero=function(){return this.ex.setZero(),this.ey.setZero(),this.ez.setZero(),this},n.prototype.solve33=function(t){let e=o.dot(this.ex,o.cross(this.ey,this.ez));0!=e&&(e=1/e);const i=new o;return i.x=e*o.dot(t,o.cross(this.ey,this.ez)),i.y=e*o.dot(this.ex,o.cross(t,this.ez)),i.z=e*o.dot(this.ex,o.cross(this.ey,t)),i},n.prototype.solve22=function(t){const e=this.ex.x,i=this.ey.x,o=this.ex.y,n=this.ey.y;let r=e*n-i*o;0!=r&&(r=1/r);const m=s.zero();return m.x=r*(n*t.x-i*t.y),m.y=r*(e*t.y-o*t.x),m},n.prototype.getInverse22=function(t){const e=this.ex.x,i=this.ey.x,s=this.ex.y,o=this.ey.y;let n=e*o-i*s;0!=n&&(n=1/n),t.ex.x=n*o,t.ey.x=-n*i,t.ex.z=0,t.ex.y=-n*s,t.ey.y=n*e,t.ey.z=0,t.ez.x=0,t.ez.y=0,t.ez.z=0},n.prototype.getSymInverse33=function(t){let e=o.dot(this.ex,o.cross(this.ey,this.ez));0!=e&&(e=1/e);const i=this.ex.x,s=this.ey.x,n=this.ez.x,r=this.ey.y,m=this.ez.y,h=this.ez.z;t.ex.x=e*(r*h-m*m),t.ex.y=e*(n*m-s*h),t.ex.z=e*(s*m-n*r),t.ey.x=t.ex.y,t.ey.y=e*(i*h-n*n),t.ey.z=e*(n*s-i*m),t.ez.x=t.ex.z,t.ez.y=t.ey.z,t.ez.z=e*(i*r-s*s)},n.mul=function(t,e){if(e&&"z"in e&&"y"in e&&"x"in e){let i=t.ex.x*e.x+t.ey.x*e.y+t.ez.x*e.z,s=t.ex.y*e.x+t.ey.y*e.y+t.ez.y*e.z;const n=t.ex.z*e.x+t.ey.z*e.y+t.ez.z*e.z;return new o(i,s,n)}if(e&&"y"in e&&"x"in e){let i=t.ex.x*e.x+t.ey.x*e.y,o=t.ex.y*e.x+t.ey.y*e.y;return s.neo(i,o)}},n.mulVec3=function(t,e){const i=t.ex.x*e.x+t.ey.x*e.y+t.ez.x*e.z,s=t.ex.y*e.x+t.ey.y*e.y+t.ez.y*e.z,n=t.ex.z*e.x+t.ey.z*e.y+t.ez.z*e.z;return new o(i,s,n)},n.mulVec2=function(t,e){const i=t.ex.x*e.x+t.ey.x*e.y,o=t.ex.y*e.x+t.ey.y*e.y;return s.neo(i,o)},n.add=function(t,e){return new n(o.add(t.ex+e.ex),o.add(t.ey+e.ey),o.add(t.ez+e.ez))}},function(t,e,i){t.exports=h;const s=i(5),o=i(4),n=i(0),r=i(18),m=i(1);function h(t,e,i){if(pc.markPhysics2dModuleAsUsed(),!(this instanceof h))return new h(t,e,i);h._super.call(this,t,e,i),this.m_type=h.TYPE}h._super=r,h.prototype=s(h._super.prototype),h.TYPE="capsule",h.prototype.computeMass=function(t,e){const i=t.center.setCombine(.5,this.m_vertex1,.5,this.m_vertex2),s=this.m_vertex1.x-i.x,o=this.m_vertex1.y-i.y,n=m.sqrt(s*s+o*o),r=this.m_radius,h=r*r,c=e*(m.PI*h),l=.5*c,a=3/8*r,_=a+n,u=.5*(.5*c*h)-l*a*a+l*_*_,p=2*e*n,d=p*(h+n*n)/3;t.mass=c+p,t.I=d+2*u},h.prototype.initCollisionData=function(){this.m_vertices||(this.m_vertices=[new n,new n,new n,new n],this.m_normals=[new n,new n,new n,new n],this.m_centroid=new n,this.m_count=4);const t=this.m_vertices,e=this.m_normals,i=.01*o.polygonRadius,s=e[1].set(this.m_vertex2).sub(this.m_vertex1).normal(),r=e[0].set(s.y,-s.x);t[0].set(this.m_vertex1).addMul(-i,s).addMul(i,r),t[1].set(this.m_vertex2).addMul(i,s).addMul(i,r),t[2].set(this.m_vertex2).addMul(i,s).addMul(-i,r),t[3].set(this.m_vertex1).addMul(-i,s).addMul(-i,r),e[2].set(r).mul(-1),e[3].set(s).mul(-1),this.m_centroid.set(this.m_vertex1).add(this.m_vertex2).mul(.5)}},function(t,e,i){t.exports=l;const s=i(5),o=i(0),n=i(4),r=i(13),m=i(16),h=i(31);let c;function l(t){if(pc.markPhysics2dModuleAsUsed(),!(this instanceof l))return new l(t);l._super.call(this),this.m_type=l.TYPE,this.m_radius=n.polygonRadius,this.m_polygons=[],this.m_count=0,t&&t.length&&this._set(t)}l._super=r,l.prototype=s(l._super.prototype),l.TYPE="composite_polygon",l.prototype._clone=function(){const t=new l;t.m_type=this.m_type,t.m_radius=this.m_radius,t.m_count=this.m_count;for(let e=0;e<this.m_count;e++)t.m_polygons.push(this.m_polygons[e].clone());return t},l.prototype.getChildCount=function(){return this.m_count},l.prototype.getChildPolygon=function(t){return this.m_polygons[t]},l.prototype._set=function(t){const e=h.tesselate({contours:t,windingRule:h.WINDING_ODD,elementType:h.POLYGONS,polySize:8,vertexSize:2}),i=e.vertices,s=e.elements,n=s.length;this.m_polygons=new Array(e.elementCount);for(let t=0,e=0;t<n;t+=8){const n=[];for(let e=0;e<8;++e){const r=s[t+e];r<0||n.push(new o(i[2*r],i[2*r+1]))}this.m_polygons[e++]=new m(n)}this.m_count=this.m_polygons.length},l.prototype.testPoint=function(t,e){for(let i=0;i<this.m_count;++i)if(this.m_polygons[i].testPoint(t,e))return!0;return!1},l.prototype.rayCast=function(t,e,i,s){return this.m_polygons[s].rayCast(t,e,i,0)},l.prototype.computeAABB=function(t,e,i){this.m_polygons[i].computeAABB(t,e,0)},l.prototype.setAABB=l.prototype.computeAABB,l.prototype.resetAABB=function(t,e,i){return this.computeAABB(t,e,i),t},l.prototype.computeMass=function(t,e){const i=this.m_count;if(1===i)return void this.m_polygons[0].computeMass(t,e);const s=t.center.setZero();let n=t.mass=0,r=t.I=0;if(!(i<1)){c=c||{center:new o,mass:0,I:0};for(let t=0;t<i;++t){this.m_polygons[t].computeMass(c,e);const i=c.mass,m=c.center;s.addMul(i,m),n+=i,r+=c.I+i*o.dot(m,m)}n>0?s.mul(1/n):(s.setZero(),n=0),r>0&&(r-=n*o.dot(s,s)),r<0&&(r=0),t.mass=n,t.I=r}},l.prototype.computeDistanceProxy=function(t,e){this.m_polygons[e].computeDistanceProxy(t)}},function(t,e){e.toString=function(t){t="string"==typeof t?t:"\n";let e="";for(const i in this)"function"!=typeof this[i]&&"object"!=typeof this[i]&&(e+=i+": "+this[i]+t);return e}},function(t,e,i){const s=1e-4;t.exports=y;i(2);const o=i(7),n=i(0),r=i(3),m=(i(1),i(24)),h=i(6),c=i(35),l=i(36),a=i(28),_=y.STATIC="static",u=y.KINEMATIC="kinematic",p=y.DYNAMIC="dynamic",d={type:_,position:n.zero(),angle:0,linearVelocity:n.zero(),angularVelocity:0,linearDamping:0,angularDamping:0,fixedRotation:!1,fixedX:!1,fixedY:!1,bullet:!1,gravityScale:1,allowSleep:!0,awake:!0,active:!0,userData:null,defaultMass:1};function y(t,e){e=o(e,d),this.m_world=t,this.m_awakeFlag=e.awake,this.m_autoSleepFlag=e.allowSleep,this.m_bulletFlag=e.bullet,this.m_fixedRotationFlag=e.fixedRotation,this.m_fixedXFlag=e.fixedX,this.m_fixedYFlag=e.fixedY,this.m_activeFlag=e.active,this.m_islandFlag=!1,this.m_toiFlag=!1,this.m_dirtyTransformFlag=!0,this.m_userData=e.userData,this.m_type=e.type,this.m_defaultMass=e.defaultMass>s?e.defaultMass:s,this.m_mass=this.m_defaultMass,this.m_invMass=this.m_type==p?1/this.m_mass:0,this.m_blankFixturesFlag=!0,this.m_I=0,this.m_invI=0,this.m_xf=h.identity(),this.m_xf.p=n.clone(e.position),this.m_xf.q.setAngle(e.angle),this.m_sweep=new m,this.m_sweep.setTransform(this.m_xf),this.c_velocity=new c,this.c_position=new l,this.m_force=n.zero(),this.m_torque=0,this.m_linearVelocity=n.clone(e.linearVelocity),this.m_angularVelocity=e.angularVelocity,this.m_linearDamping=e.linearDamping,this.m_angularDamping=e.angularDamping,this.m_gravityScale=e.gravityScale,this.m_sleepTime=0,this.m_jointList=null,this.m_contactList=null,this.m_fixtureList=null,this.m_prev=null,this.m_next=null,this.m_destroyed=!1,this.m_layer=0,this.m_layerMask=0}function f(){this.mass=0,this.center=n.zero(),this.I=0}y.prototype.isWorldLocked=function(){return!(!this.m_world||!this.m_world.isLocked())},y.prototype.getWorld=function(){return this.m_world},y.prototype.getNext=function(){return this.m_next},y.prototype.setUserData=function(t){this.m_userData=t},y.prototype.getUserData=function(){return this.m_userData},y.prototype.getFixtureList=function(){return this.m_fixtureList},y.prototype.getJointList=function(){return this.m_jointList},y.prototype.getContactList=function(){return this.m_contactList},y.prototype.isStatic=function(){return this.m_type==_},y.prototype.isDynamic=function(){return this.m_type==p},y.prototype.isKinematic=function(){return this.m_type==u},y.prototype.setStatic=function(){return this.setType(_),this},y.prototype.setDynamic=function(){return this.setType(p),this},y.prototype.setKinematic=function(){return this.setType(u),this},y.prototype.getType=function(){return this.m_type},y.prototype.setType=function(t){if(1==this.isWorldLocked())return;if(this.m_type==t)return;this.m_type=t,this.resetMassData(),this.m_type==_&&(this.m_linearVelocity.setZero(),this.m_angularVelocity=0,this.m_sweep.forward(),this.synchronizeFixtures()),this.setAwake(!0),this.m_force.setZero(),this.m_torque=0;let e=this.m_contactList;for(;e;){const t=e;e=e.next,this.m_world.destroyContact(t.contact)}this.m_contactList=null;const i=this.m_world.m_broadPhase;for(let t=this.m_fixtureList;t;t=t.m_next){const e=t.m_proxyCount;for(let s=0;s<e;++s)i.touchProxy(t.m_proxies[s].proxyId)}},y.prototype.isBullet=function(){return this.m_bulletFlag},y.prototype.setBullet=function(t){this.m_bulletFlag=!!t},y.prototype.isSleepingAllowed=function(){return this.m_autoSleepFlag},y.prototype.setSleepingAllowed=function(t){this.m_autoSleepFlag=!!t,0==this.m_autoSleepFlag&&this.setAwake(!0)},y.prototype.isAwake=function(){return this.m_awakeFlag},y.prototype.setAwake=function(t){t?0==this.m_awakeFlag&&(this.m_awakeFlag=!0,this.m_sleepTime=0):(this.m_awakeFlag=!1,this.m_sleepTime=0,this.m_linearVelocity.setZero(),this.m_angularVelocity=0,this.m_force.setZero(),this.m_torque=0)},y.prototype.isActive=function(){return this.m_activeFlag},y.prototype.setActive=function(t){if(t!=this.m_activeFlag)if(this.m_activeFlag=!!t,this.m_activeFlag){let t=this.m_world.m_broadPhase;for(let e=this.m_fixtureList;e;e=e.m_next)e.createProxies(t,this.m_xf)}else{let t=this.m_world.m_broadPhase;for(let e=this.m_fixtureList;e;e=e.m_next)e.destroyProxies(t);let e=this.m_contactList;for(;e;){const t=e;e=e.next,this.m_world.destroyContact(t.contact)}this.m_contactList=null}},y.prototype.isFixedRotation=function(){return this.m_fixedRotationFlag},y.prototype.setFixedRotation=function(t){this.m_fixedRotationFlag!=t&&(this.m_fixedRotationFlag=!!t,this.m_angularVelocity=0,this.resetMassData())},y.prototype.isFixedX=function(){return this.m_fixedXFlag},y.prototype.setFixedX=function(t){this.m_fixedXFlag!=t&&(this.m_fixedXFlag=!!t,this.m_linearVelocity.x=0)},y.prototype.isFixedY=function(){return this.m_fixedYFlag},y.prototype.setFixedY=function(t){this.m_fixedYFlag!=t&&(this.m_fixedYFlag=!!t,this.m_linearVelocity.y=0)},y.prototype.getTransform=function(){return this.m_xf},y.prototype.setTransform=function(t,e){if(1==this.isWorldLocked())return;this.m_xf.set(t,e),this.m_sweep.setTransform(this.m_xf);const i=this.m_world.m_broadPhase;for(let t=this.m_fixtureList;t;t=t.m_next)t.synchronize(i,this.m_xf,this.m_xf);this.setAwake(!0),this.m_dirtyTransformFlag=!0},y.prototype.synchronizeTransform=function(){this.m_sweep.getTransform(this.m_xf,1),this.m_dirtyTransformFlag=!0},y.prototype.dirtifyTransform=function(t){this.m_dirtyTransformFlag=t},y.prototype.isDirtyTransform=function(){return this.m_dirtyTransformFlag},y.prototype.synchronizeFixtures=function(){const t=h.identity();this.m_sweep.getTransform(t,0);const e=this.m_world.m_broadPhase;for(let i=this.m_fixtureList;i;i=i.m_next)i.synchronize(e,t,this.m_xf)},y.prototype.advance=function(t){this.m_sweep.advance(t),this.m_sweep.c.set(this.m_sweep.c0),this.m_sweep.a=this.m_sweep.a0,this.m_sweep.getTransform(this.m_xf,1)},y.prototype.getPosition=function(){return this.m_xf.p},y.prototype.setPosition=function(t){this.setTransform(t,this.m_sweep.a)},y.prototype.getAngle=function(){return this.m_sweep.a},y.prototype.setAngle=function(t){this.setTransform(this.m_xf.p,t)},y.prototype.getWorldCenter=function(){return this.m_sweep.c},y.prototype.getLocalCenter=function(){return this.m_sweep.localCenter},y.prototype.setLocalCenter=function(t){if(this.m_localCenter){if(!t)return this.m_localCenter=t,void this.resetMassData();if(this.m_localCenter.closeTo(t))return}if(!t)return void(this.m_localCenter=t);if(this.m_localCenter=t=n.clone(t),this.isStatic()||this.isKinematic())return this.m_sweep.setLocalCenter(t,this.m_xf),void(this.m_sweep.a0=this.m_sweep.a);const e=n.clone(this.m_sweep.c),i=n.clone(this.m_sweep.localCenter);this.m_sweep.setLocalCenter(t,this.m_xf),this.m_Inertia>0?this.setInertia(this.m_Inertia):this.m_I>0&&0==this.m_fixedRotationFlag?(this.m_I+=this.m_mass*(n.dot(i,i)-n.dot(t,t)),this.m_invI=1/this.m_I):(this.m_I=0,this.m_invI=0),this.m_linearVelocity.add(n.cross(this.m_angularVelocity,n.sub(this.m_sweep.c,e)))},y.prototype.getLinearVelocity=function(){return this.m_linearVelocity},y.prototype.getLinearVelocityFromWorldPoint=function(t){const e=n.sub(t,this.m_sweep.c);return n.add(this.m_linearVelocity,n.cross(this.m_angularVelocity,e))},y.prototype.getLinearVelocityFromLocalPoint=function(t){return this.getLinearVelocityFromWorldPoint(this.getWorldPoint(t))},y.prototype.setLinearVelocity=function(t){this.m_type!=_&&(n.dot(t,t)>0&&this.setAwake(!0),this.m_linearVelocity.set(t))},y.prototype.getAngularVelocity=function(){return this.m_angularVelocity},y.prototype.setAngularVelocity=function(t){this.m_type!=_&&(t*t>0&&this.setAwake(!0),this.m_angularVelocity=t)},y.prototype.getLinearDamping=function(){return this.m_linearDamping},y.prototype.setLinearDamping=function(t){this.m_linearDamping=t},y.prototype.getAngularDamping=function(){return this.m_angularDamping},y.prototype.setAngularDamping=function(t){this.m_angularDamping=t},y.prototype.getGravityScale=function(){return this.m_gravityScale},y.prototype.setGravityScale=function(t){this.m_gravityScale=t},y.prototype.getMass=function(){return this.m_mass},y.prototype.fixturesAreBlank=function(){return this.m_blankFixturesFlag},y.prototype.getInertia=function(){return this.m_I+this.m_mass*n.dot(this.m_sweep.localCenter,this.m_sweep.localCenter)},y.prototype.setInertia=function(t){this.m_Inertia=t;const e=this.m_mass*n.dot(this.m_sweep.localCenter,this.m_sweep.localCenter);this.m_I=t-=e,t>0&&0==this.m_fixedRotationFlag?this.m_invI=1/t:(this.m_I=0,this.m_invI=0,this.m_Inertia=e)},y.prototype.getDefaultMass=function(){return this.m_defaultMass},y.prototype.setDefaultMass=function(t){this.m_defaultMass=t>s?t:s},y.prototype.getMassData=function(t){t.mass=this.m_mass,t.I=this.getInertia(),t.center.set(this.m_sweep.localCenter)},y.prototype.resetMassData=function(){if(this.m_I=0,this.m_invI=0,this.m_invMass=0,this.m_localCenter||this.m_sweep.localCenter.setZero(),this.isStatic()||this.isKinematic())return this.m_localCenter||(this.m_sweep.c0.set(this.m_xf.p),this.m_sweep.c.set(this.m_xf.p),this.m_sweep.a0=this.m_sweep.a),void(this.m_mass=this.m_defaultMass);this.m_mass=0;const t=this.m_localCenter||n.zero();for(let e=this.m_fixtureList;e;e=e.m_next){if(0==e.m_density)continue;const i=new f;e.getMassData(i);const s=i.mass,o=i.center;this.m_mass+=s,this.m_localCenter||t.addMul(s,o),this.m_I+=i.I+s*n.dot(o,o)}this.m_mass>s?(this.m_invMass=1/this.m_mass,this.m_localCenter||t.mul(this.m_invMass),this.m_blankFixturesFlag=!1):(this.m_mass=1,this.m_invMass=1,this.m_blankFixturesFlag=!0);let e=null;this.m_localCenter||(e=n.clone(this.m_sweep.c),this.m_sweep.setLocalCenter(t,this.m_xf)),this.m_Inertia>0?this.setInertia(this.m_Inertia):this.m_I>0&&0==this.m_fixedRotationFlag?(this.m_I-=this.m_mass*n.dot(t,t),this.m_I<=0&&(this.m_I=1),this.m_invI=1/this.m_I):0==this.m_fixedRotationFlag?(this.m_I=1,this.m_invI=1):(this.m_I=0,this.m_invI=0),this.m_localCenter||this.m_linearVelocity.add(n.cross(this.m_angularVelocity,n.sub(this.m_sweep.c,e)))},y.prototype.setMassData=function(t){if(1==this.isWorldLocked())return;if(this.m_type!=p)return;if(this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_mass=t.mass,this.m_mass<=0&&(this.m_mass=this.m_defaultMass),this.m_invMass=1/this.m_mass,t.I>0&&0==this.m_fixedRotationFlag&&(this.m_I=t.I-this.m_mass*n.dot(t.center,t.center),this.m_I<=0&&(this.m_I=1),this.m_invI=1/this.m_I),this.m_localCenter)return;const e=n.clone(this.m_sweep.c);this.m_sweep.setLocalCenter(t.center,this.m_xf),this.m_linearVelocity.add(n.cross(this.m_angularVelocity,n.sub(this.m_sweep.c,e)))},y.prototype.applyForce=function(t,e,i){this.m_type==p&&(i&&0==this.m_awakeFlag&&this.setAwake(!0),this.m_awakeFlag&&(this.m_force.add(t),this.m_torque+=n.cross(n.sub(e,this.m_sweep.c),t)))},y.prototype.applyForceToCenter=function(t,e){this.m_type==p&&(e&&0==this.m_awakeFlag&&this.setAwake(!0),this.m_awakeFlag&&this.m_force.add(t))},y.prototype.applyTorque=function(t,e){this.m_type==p&&(e&&0==this.m_awakeFlag&&this.setAwake(!0),this.m_awakeFlag&&(this.m_torque+=t))},y.prototype.applyLinearImpulse=function(t,e,i){this.m_type==p&&(i&&0==this.m_awakeFlag&&this.setAwake(!0),this.m_awakeFlag&&(this.m_linearVelocity.addMul(this.m_invMass,t),this.m_angularVelocity+=this.m_invI*n.cross(n.sub(e,this.m_sweep.c),t)))},y.prototype.applyLinearImpulseToCenter=function(t,e){this.m_type==p&&(e&&0==this.m_awakeFlag&&this.setAwake(!0),this.m_awakeFlag&&this.m_linearVelocity.addMul(this.m_invMass,t))},y.prototype.applyAngularImpulse=function(t,e){this.m_type==p&&(e&&0==this.m_awakeFlag&&this.setAwake(!0),this.m_awakeFlag&&(this.m_angularVelocity+=this.m_invI*t))},y.prototype.setLayer=function(t){this.m_layer=t;for(let t=this.getFixtureList();t;t=t.getNext())t.refilter()},y.prototype.setLayerMask=function(t){this.m_layerMask=t},y.prototype.shouldCollide=function(t){if(this.m_world.collision_matrix[this.m_layer]&t.m_layerMask)return!1;for(let e=this.m_jointList;e;e=e.next)if(e.other.equals(t)&&0==e.joint.m_collideConnected)return!1;return!0},y.prototype.createFixture=function(t,e){if(1==this.isWorldLocked())return null;const i=new a(this,t,e);if(this.m_activeFlag&&i.isActive()){const t=this.m_world.m_broadPhase;i.createProxies(t,this.m_xf)}return i.m_next=this.m_fixtureList,this.m_fixtureList=i,i.m_density>0&&this.resetMassData(),this.m_world.m_newFixture=i.isActive(),i},y.prototype.destroyFixture=function(t){if(1==this.isWorldLocked())return;let e=!1;if(this.m_fixtureList===t)this.m_fixtureList=t.m_next,e=!0;else{let i=this.m_fixtureList;for(;null!=i;){if(i.m_next===t){i.m_next=t.m_next,e=!0;break}i=i.m_next}}let i=this.m_contactList;for(;i;){const e=i.contact;i=i.next;const s=e.getFixtureA(),o=e.getFixtureB();t!=s&&t!=o||this.m_world.destroyContact(e)}if(this.m_activeFlag){const e=this.m_world.m_broadPhase;t.destroyProxies(e)}t.m_body=null,t.m_next=null,this.m_world.publish("remove-fixture",t),this.resetMassData()},y.prototype.getWorldPoint=function(t,e){return h.mulVec2(this.m_xf,t,e)},y.prototype.getWorldVector=function(t){return r.mulVec2(this.m_xf.q,t)},y.prototype.getLocalPoint=function(t,e){return h.mulTVec2(this.m_xf,t,e)},y.prototype.getLocalVector=function(t){return r.mulTVec2(this.m_xf.q,t)},y.prototype.equals=function(t){return this===t}},function(t,e,i){t.exports=m;i(2);const s=i(1),o=i(0),n=i(3),r=i(6);function m(t,e){this.localCenter=o.zero(),this.c=o.zero(),this.a=0,this.alpha0=0,this.c0=o.zero(),this.c1=o.zero(),this.a0=0}m.prototype.setTransform=function(t){const e=r.mulVec2(t,this.localCenter);this.c.set(e),this.c0.set(e),this.a=t.q.getAngle(),this.a0=t.q.getAngle()},m.prototype.setLocalCenter=function(t,e){this.localCenter.set(t);const i=r.mulVec2(e,this.localCenter);this.c.set(i),this.c0.set(i)},m.prototype.getTransform=function(t,e){e=void 0===e?0:e,t.q.setAngle((1-e)*this.a0+e*this.a),t.p.setCombine(1-e,this.c0,e,this.c),t.p.sub(n.mulVec2(t.q,this.localCenter))},m.prototype.advance=function(t){const e=(t-this.alpha0)/(1-this.alpha0);this.c0.setCombine(e,this.c,1-e,this.c0),this.a0=e*this.a+(1-e)*this.a0,this.alpha0=t},m.prototype.forward=function(){this.a0=this.a,this.c0.set(this.c)},m.prototype.normalize=function(){const t=s.mod(this.a0,-s.PI,+s.PI);this.a-=this.a0-t,this.a0=t},m.prototype.clone=function(){const t=new m;return t.localCenter.set(this.localCenter),t.alpha0=this.alpha0,t.a0=this.a0,t.a=this.a,t.c0.set(this.c0),t.c.set(this.c),t},m.prototype.set=function(t){this.localCenter.set(t.localCenter),this.alpha0=t.alpha0,this.a0=t.a0,this.a=t.a,this.c0.set(t.c0),this.c.set(t.c)}},function(t,e,i){t.exports=function(t,e){const i=o.now();++n.toiCalls,t.state=y.e_unknown,t.t=e.tMax;const m=e.proxyA,h=e.proxyB,c=e.sweepA,p=e.sweepB;c.normalize(),p.normalize();const x=e.tMax,g=m.m_radius+h.m_radius,v=r.max(s.linearSlop,g-3*s.linearSlop),A=.25*s.linearSlop;let b=0;const B=s.maxTOIIterations;let w=0;const C=new d;t.cache=C;const I=new _;for(I.proxyA=e.proxyA,I.proxyB=e.proxyB,I.useRadii=!1;;){const e=l.identity(),i=l.identity();c.getTransform(e,b),p.getTransform(i,b),I.transformA=e,I.transformB=i;const o=new u;if(a(o,C,I),o.distance<=0){t.state=y.e_overlapped,t.t=0;break}if(o.distance<v+A){t.state=y.e_touching,t.t=b;break}const _=new f;_.initialize(C,m,c,h,p,b);let d=!1,g=x,M=0;for(;;){let e=_.findMinSeparation(g);if(e>v+A){t.state=y.e_separated,t.t=x,d=!0;break}if(e>v-A){b=g;break}let i=_.evaluate(b);if(i<v-A){t.state=y.e_failed,t.t=b,d=!0;break}if(i<=v+A){t.state=y.e_touching,t.t=b,d=!0;break}let o=0,m=b,h=g;for(;;){let t;t=1&o?m+(v-i)*(h-m)/(e-i):.5*(m+h),++o,++n.toiRootIters;const s=_.evaluate(t);if(r.abs(s-v)<A){g=t;break}if(s>v?(m=t,i=s):(h=t,e=s),50==o)break}if(n.toiMaxRootIters=r.max(n.toiMaxRootIters,o),++M,M==s.maxPolygonVertices)break}if(++w,++n.toiIters,d)break;if(w==B){t.state=y.e_failed,t.t=b;break}}n.toiMaxIters=r.max(n.toiMaxIters,w);const M=o.diff(i);n.toiMaxTime=r.max(n.toiMaxTime,M),n.toiTime+=M},t.exports.Input=function(){this.proxyA=new p,this.proxyB=new p,this.sweepA=new c,this.sweepB=new c,this.tMax},t.exports.Output=y;const s=i(4),o=(i(2),i(40)),n=i(22),r=i(1),m=i(0),h=i(3),c=i(24),l=i(6),a=i(14),_=a.Input,u=a.Output,p=a.Proxy,d=a.Cache;function y(){this.state,this.t,this.cache}y.e_unknown=0,y.e_failed=1,y.e_overlapped=2,y.e_touching=3,y.e_separated=4,n.toiTime=0,n.toiMaxTime=0,n.toiCalls=0,n.toiIters=0,n.toiMaxIters=0,n.toiRootIters=0,n.toiMaxRootIters=0;function f(){this.m_proxyA=new p,this.m_proxyB=new p,this.m_sweepA,this.m_sweepB,this.m_type,this.m_localPoint=m.zero(),this.m_axis=m.zero()}f.prototype.initialize=function(t,e,i,s,o,n){this.m_proxyA=e,this.m_proxyB=s;const r=t.count;this.m_sweepA=i,this.m_sweepB=o;const c=l.identity(),a=l.identity();if(this.m_sweepA.getTransform(c,n),this.m_sweepB.getTransform(a,n),1==r){this.m_type=1;let e=this.m_proxyA.getVertex(t.indexA[0]),i=this.m_proxyB.getVertex(t.indexB[0]),s=l.mulVec2(c,e),o=l.mulVec2(a,i);return this.m_axis.setCombine(1,o,-1,s),this.m_axis.normalize()}if(t.indexA[0]==t.indexA[1]){this.m_type=3;const i=s.getVertex(t.indexB[0]),o=s.getVertex(t.indexB[1]);this.m_axis=m.cross(m.sub(o,i),1),this.m_axis.normalize();let n=h.mulVec2(a.q,this.m_axis);this.m_localPoint=m.mid(i,o);let r=l.mulVec2(a,this.m_localPoint),_=e.getVertex(t.indexA[0]),u=l.mulVec2(c,_),p=m.dot(u,n)-m.dot(r,n);return p<0&&(this.m_axis=m.neg(this.m_axis),p=-p),p}{this.m_type=2;const e=this.m_proxyA.getVertex(t.indexA[0]),i=this.m_proxyA.getVertex(t.indexA[1]);this.m_axis=m.cross(m.sub(i,e),1),this.m_axis.normalize();let s=h.mulVec2(c.q,this.m_axis);this.m_localPoint=m.mid(e,i);let o=l.mulVec2(c,this.m_localPoint),n=this.m_proxyB.getVertex(t.indexB[0]),r=l.mulVec2(a,n),_=m.dot(r,s)-m.dot(o,s);return _<0&&(this.m_axis=m.neg(this.m_axis),_=-_),_}},f.prototype.compute=function(t,e){const i=l.identity(),s=l.identity();switch(this.m_sweepA.getTransform(i,e),this.m_sweepB.getTransform(s,e),this.m_type){case 1:{if(t){let t=h.mulTVec2(i.q,this.m_axis),e=h.mulTVec2(s.q,m.neg(this.m_axis));this.indexA=this.m_proxyA.getSupport(t),this.indexB=this.m_proxyB.getSupport(e)}let e=this.m_proxyA.getVertex(this.indexA),o=this.m_proxyB.getVertex(this.indexB),n=l.mulVec2(i,e),r=l.mulVec2(s,o);return m.dot(r,this.m_axis)-m.dot(n,this.m_axis)}case 2:{let e=h.mulVec2(i.q,this.m_axis),o=l.mulVec2(i,this.m_localPoint);if(t){let t=h.mulTVec2(s.q,m.neg(e));this.indexA=-1,this.indexB=this.m_proxyB.getSupport(t)}let n=this.m_proxyB.getVertex(this.indexB),r=l.mulVec2(s,n);return m.dot(r,e)-m.dot(o,e)}case 3:{let e=h.mulVec2(s.q,this.m_axis),o=l.mulVec2(s,this.m_localPoint);if(t){let t=h.mulTVec2(i.q,m.neg(e));this.indexB=-1,this.indexA=this.m_proxyA.getSupport(t)}let n=this.m_proxyA.getVertex(this.indexA),r=l.mulVec2(i,n);return m.dot(r,e)-m.dot(o,e)}default:return t&&(this.indexA=-1,this.indexB=-1),0}},f.prototype.findMinSeparation=function(t){return this.compute(!0,t)},f.prototype.evaluate=function(t){return this.compute(!1,t)}},function(t,e,i){t.exports=m;const s=i(5),o=i(16),n=i(0),r=new(i(3));function m(t,e,i,s){if(pc.markPhysics2dModuleAsUsed(),!(this instanceof m))return new m(t,e,i,s);m._super.call(this),this.hx=1,this.hy=1,this.center=n.zero(),this.angle=0,"number"==typeof t&&(this.hx=t),"number"==typeof e&&(this.hy=e),"object"==typeof i&&n.isValid(i)&&(this.center=i),"number"==typeof s&&(this.angle=s),this._setAsBox(this.hx,this.hy,this.center,this.angle)}m._super=o,m.prototype=s(m._super.prototype),m.TYPE="polygon",m.prototype.setSize=function(t,e){this.hx=t,this.hy=e,this._setAsBox(this.hx,this.hy,this.center,this.angle)},m.prototype.setAngle=function(t){this.angle=t,this._setAsBox(this.hx,this.hy,this.center,this.angle)},m.prototype.setCenter=function(t){this.center=t,this._setAsBox(this.hx,this.hy,this.center,this.angle)},m.prototype._setAsBox=function(t,e,i,s){this.m_vertices[3]?(this.m_vertices[0].set(-t,-e),this.m_vertices[1].set(t,-e),this.m_vertices[2].set(t,e),this.m_vertices[3].set(-t,e)):(this.m_vertices[0]=n.neo(-t,-e),this.m_vertices[1]=n.neo(t,-e),this.m_vertices[2]=n.neo(t,e),this.m_vertices[3]=n.neo(-t,e)),this.m_normals[3]?(this.m_normals[0].set(0,-1),this.m_normals[1].set(1,0),this.m_normals[2].set(0,1),this.m_normals[3].set(-1,0)):(this.m_normals[0]=n.neo(0,-1),this.m_normals[1]=n.neo(1,0),this.m_normals[2]=n.neo(0,1),this.m_normals[3]=n.neo(-1,0)),this.m_count=4,s=s||0,this.m_centroid.set(i),r.set(s);let o=-1/0,m=o;for(let t,e=0;e<this.m_count;++e)t=this.m_vertices[e]=this.m_vertices[e].rot(r).add(i),this.m_normals[e]=this.m_normals[e].rot(r),t.x>o&&(o=t.x),t.y>m&&(m=t.y);this.m_outsidePoint.x=o+1,this.m_outsidePoint.y=m+1}},function(t,e,i){t.exports=l;i(2);const s=i(5),o=i(6),n=i(0),r=i(4),m=i(13),h=i(18);let c;function l(t,e,i){if(pc.markPhysics2dModuleAsUsed(),!(this instanceof l))return new l(t,e,i);l._super.call(this),this.m_type=l.TYPE,this.m_radius=r.polygonRadius,this.m_vertices=[],this.m_count=0,this.m_prevVertex=null,this.m_nextVertex=null,this.m_hasPrevVertex=!1,this.m_hasNextVertex=!1,i>0?(this.m_edgeRadius=i,this.m_radius+=i):this.m_edgeRadius=0,t&&t.length&&(e?this._createLoop(t):this._createChain(t))}l._super=m,l.prototype=s(l._super.prototype),l.TYPE="chain",l.prototype._createLoop=function(t){this.m_vertices.length=0,this.m_count=t.length+1;for(let e=0;e<t.length;++e)this.m_vertices[e]=t[e].clone();return this.m_vertices[t.length]=t[0].clone(),this.m_prevVertex=this.m_vertices[this.m_count-2],this.m_nextVertex=this.m_vertices[1],this.m_hasPrevVertex=!0,this.m_hasNextVertex=!0,this},l.prototype._createChain=function(t){this.m_count=this.m_vertices.length=t.length;for(let e=0;e<t.length;++e)this.m_vertices[e]=t[e].clone();return this.m_hasPrevVertex=!1,this.m_hasNextVertex=!1,this.m_prevVertex=null,this.m_nextVertex=null,this},l.prototype._setPrevVertex=function(t){this.m_prevVertex=t,this.m_hasPrevVertex=!0},l.prototype._setNextVertex=function(t){this.m_nextVertex=t,this.m_hasNextVertex=!0},l.prototype.setRadius=function(t){this.m_radius=r.polygonRadius,t>0?(this.m_edgeRadius=t,this.m_radius+=t):this.m_edgeRadius=0},l.prototype.getRadius=function(){return this.m_edgeRadius},l.prototype._clone=function(){const t=new l;return t.createChain(this.m_vertices),t.m_type=this.m_type,t.m_radius=this.m_radius,t.m_prevVertex=this.m_prevVertex,t.m_nextVertex=this.m_nextVertex,t.m_hasPrevVertex=this.m_hasPrevVertex,t.m_hasNextVertex=this.m_hasNextVertex,t},l.prototype.getChildCount=function(){return this.m_count>0?this.m_count-1:0},l.prototype.getChildEdge=function(t,e){t.m_type=h.TYPE,t.m_radius=this.m_radius,t.m_edgeRadius=this.m_edgeRadius,t.m_vertex1=this.m_vertices[e],t.m_vertex2=this.m_vertices[e+1],e>0?(t.m_vertex0=this.m_vertices[e-1],t.m_hasVertex0=!0):(t.m_vertex0=this.m_prevVertex,t.m_hasVertex0=this.m_hasPrevVertex),e<this.m_count-2?(t.m_vertex3=this.m_vertices[e+2],t.m_hasVertex3=!0):(t.m_vertex3=this.m_nextVertex,t.m_hasVertex3=this.m_hasNextVertex)},l.prototype.getVertex=function(t){return t<this.m_count?this.m_vertices[t]:this.m_vertices[0]},l.prototype.testPoint=function(t,e){if(this.m_edgeRadius<=0||this.m_count<2)return!1;const i=this.m_vertices;if(c?(c._set(i[0],i[1]),c.setRadius(this.m_edgeRadius)):c=new h(i[0],i[1],this.m_edgeRadius),c.testPoint(t,e))return!0;for(let s=this.m_count,o=2;o<s;++o)if(c._set(i[o-1],i[o]),c.testPoint(t,e))return!0;return!1},l.prototype.rayCast=function(t,e,i,s){return c?(c._set(this.getVertex(s),this.getVertex(s+1)),c.setRadius(this.m_edgeRadius)):c=new h(this.getVertex(s),this.getVertex(s+1),this.m_edgeRadius),c.rayCast(t,e,i,0)},l.prototype.computeAABB=function(t,e,i){const s=o.mulVec2(e,this.getVertex(i)),n=o.mulVec2(e,this.getVertex(i+1));t.combinePoints(s,n),t.extend(this.m_radius)},l.prototype.setAABB=function(t,e,i){let s=this.getVertex(i),n=this.getVertex(i+1);const r=this.m_radius;t.storePoints(r,s,n),s=o.mulVec2(e,s),n=o.mulVec2(e,n),t.combinePoints(s,n),t.extend(r)},l.prototype.resetAABB=function(t,e,i){let s=this.getVertex(i),n=this.getVertex(i+1);const r=this.m_radius;return t.containsPoints(r,s,n)?null:(t.storePoints(r,s,n),s=o.mulVec2(e,s),n=o.mulVec2(e,n),t.combinePoints(s,n),t.extend(r),t)},l.prototype.computeMass=function(t,e){t.mass=0,t.center=n.zero(),t.I=0},l.prototype.computeDistanceProxy=function(t,e){t.m_buffer[0]=this.getVertex(e),t.m_buffer[1]=this.getVertex(e+1),t.m_vertices=t.m_buffer,t.m_count=2,t.m_radius=this.m_radius}},function(t,e,i){t.exports=l;i(2);const s=i(7),o=i(1),n=i(0),r=i(12),m=i(14),h={userData:null,friction:.2,restitution:0,density:0,isSensor:!1,active:!0,filterGroupIndex:0,filterCategoryBits:1,filterMaskBits:65535};function c(t,e){this.aabb=new r,this.fixture=t,this.childIndex=e,this.proxyId=null}function l(t,e,i){if(e.shape?(i=e,e=e.shape):"number"==typeof i&&(i={density:i}),i=s(i,h),this.m_body=t,this.m_friction=i.friction,this.m_restitution=i.restitution,this.m_density=i.density,this.m_isSensor=i.isSensor,this.m_activeFlag=i.active,this.m_filterGroupIndex=i.filterGroupIndex,this.m_filterCategoryBits=i.filterCategoryBits,this.m_filterMaskBits=i.filterMaskBits,this.m_shape=e,this.m_next=null,this.m_proxies=[],this.m_proxyCount=0,this.m_activeFlag){const t=this.m_proxyCount=this.m_shape.getChildCount();for(let e=0;e<t;++e)this.m_proxies[e]=new c(this,e)}this.m_userData=i.userData}l.prototype.getType=function(){return this.m_shape.getType()},l.prototype.getShape=function(){return this.m_shape},l.prototype.isSensor=function(){return this.m_isSensor},l.prototype.setSensor=function(t){t!=this.m_isSensor&&(this.m_body.setAwake(!0),this.m_isSensor=t)},l.prototype.getUserData=function(){return this.m_userData},l.prototype.setUserData=function(t){this.m_userData=t},l.prototype.getBody=function(){return this.m_body},l.prototype.getNext=function(){return this.m_next},l.prototype.getDensity=function(){return this.m_density},l.prototype.setDensity=function(t){this.m_density=t},l.prototype.getFriction=function(){return this.m_friction},l.prototype.setFriction=function(t){this.m_friction=t},l.prototype.getRestitution=function(){return this.m_restitution},l.prototype.setRestitution=function(t){this.m_restitution=t},l.prototype.testPoint=function(t){return this.m_shape.testPoint(this.m_body.getTransform(),t)},l.prototype.rayCast=function(t,e,i){return this.m_shape.rayCast(t,e,this.m_body.getTransform(),i)},l.prototype.getMassData=function(t){this.m_shape.computeMass(t,this.m_density)},l.prototype.getAABB=function(t){return this.m_proxies[t].aabb},l.prototype.getProxyId=function(t){return this.m_proxies[t].proxyId},l.prototype.getProxyCount=function(){return this.m_proxyCount},l.prototype.createProxies=function(t,e){if(!this.m_activeFlag)return;let i;t=t||this.m_body.getWorld().m_broadPhase,e=e||this.m_body.getTransform(),this.m_proxyCount=this.m_shape.getChildCount();let s=this.m_proxies.length,n=0;for(let r=o.min(this.m_proxyCount,s);n<r;++n)i=this.m_proxies[n],null===i.proxyId?(this.m_shape.setAABB(i.aabb,e,n),i.proxyId=t.createProxy(i.aabb,i)):this.m_shape.resetAABB(i.aabb,e,n)&&(t.destroyProxy(i.proxyId),i.proxyId=t.createProxy(i.aabb,i));if(s>this.m_proxyCount){for(;n<s;++n)this.m_proxies[n].proxyId&&t.destroyProxy(this.m_proxies[n].proxyId);this.m_proxies.length=this.m_proxyCount}else if(s<this.m_proxyCount)for(s=this.m_proxies.length=this.m_proxyCount;n<s;++n)i=this.m_proxies[n]=new c(this,n),this.m_shape.setAABB(i.aabb,e,n),i.proxyId=t.createProxy(i.aabb,i);this.refilter()},l.prototype.destroyProxies=function(t){for(let e=0;e<this.m_proxyCount;++e){const i=this.m_proxies[e];i.proxyId&&(t.destroyProxy(i.proxyId),i.proxyId=null)}this.m_proxyCount=0},l.prototype.synchronize=function(t,e,i){if(this.m_activeFlag)for(let s=0;s<this.m_proxyCount;++s){const o=this.m_proxies[s];if(o.fixture._isFaux)continue;const m=new r,h=new r;this.m_shape.computeAABB(m,e,o.childIndex),this.m_shape.computeAABB(h,i,o.childIndex),o.aabb.combine(m,h);const c=n.sub(i.p,e.p);t.moveProxy(o.proxyId,o.aabb,c)}},l.prototype.setFilterData=function(t){this.m_filterGroupIndex=t.groupIndex,this.m_filterCategoryBits=t.categoryBits,this.m_filterMaskBits=t.maskBits,this.refilter()},l.prototype.getFilterGroupIndex=function(){return this.m_filterGroupIndex},l.prototype.getFilterCategoryBits=function(){return this.m_filterCategoryBits},l.prototype.getFilterMaskBits=function(){return this.m_filterMaskBits},l.prototype.refilter=function(){if(null==this.m_body||!this.m_activeFlag)return;let t=this.m_body.getContactList();for(;t;){const e=t.contact,i=e.getFixtureA(),s=e.getFixtureB();i!=this&&s!=this||e.flagForFiltering(),t=t.next}const e=this.m_body.getWorld();if(null==e)return;const i=e.m_broadPhase;for(let t=0;t<this.m_proxyCount;++t)i.touchProxy(this.m_proxies[t].proxyId)},l.prototype.shouldCollide=function(t){if(t.m_filterGroupIndex==this.m_filterGroupIndex&&0!=t.m_filterGroupIndex)return t.m_filterGroupIndex>0;return 0!=(t.m_filterMaskBits&this.m_filterCategoryBits)&&0!=(t.m_filterCategoryBits&this.m_filterMaskBits)},l.prototype.isActive=function(){return this.m_activeFlag},l.prototype.setActive=function(t){if(t==this.m_activeFlag)return;this.m_activeFlag=!!t;const e=this.m_body;this.m_activeFlag?this.createProxies(e.getWorld().m_broadPhase,e.getTransform()):this.destroyProxies(e.getWorld().m_broadPhase)},l.prototype.queryOverlaps=function(t){if(!this.m_activeFlag||0==this.m_proxyCount)return;const e=this.m_body.getWorld();if(null!=e){this._reportOverlap==l.prototype._reportOverlap&&(this._reportOverlap=this._reportOverlap.bind(this)),this._overlaps={},this._overlapCallback=t,this._transform=this.m_body.getTransform();for(let t=0;t<this.m_proxyCount;++t)this._childIndex=t,e.queryAABB(this.m_proxies[t].aabb,this._reportOverlap);this._transform=this._childIndex=this._overlaps=this._overlapCallback=t=null}},l.prototype._reportOverlap=function(t,e){if(t==this)return!0;const i=t.m_proxies[0].proxyId;return!(!this._overlaps[i]&&m.testOverlap(this.m_shape,this._childIndex,t.m_shape,e.childIndex,this._transform,t.m_body.getTransform()))||(this._overlaps[i]=!0,this._overlapCallback(t))}},function(t,e,i){const s=i(4),o=(i(2),i(39)),n=i(0),r=i(1),m=i(12);function h(t){this.id=t,this.aabb=new m,this.userData=null,this.parent=null,this.child1=null,this.child2=null,this.height=-1,this.toString=function(){return this.id+": "+this.userData}}function c(){this.m_root=null,this.m_nodes={},this.m_lastProxyId=0,this.m_pool=new o({create:function(){return new h}})}t.exports=c,h.prototype.isLeaf=function(){return null==this.child1},c.prototype.getUserData=function(t){const e=this.m_nodes[t];return e.userData},c.prototype.getFatAABB=function(t){const e=this.m_nodes[t];return e.aabb},c.prototype.allocateNode=function(){const t=this.m_pool.allocate();return t.id=++this.m_lastProxyId,t.userData=null,t.parent=null,t.child1=null,t.child2=null,t.height=-1,this.m_nodes[t.id]=t,t},c.prototype.freeNode=function(t){this.m_pool.release(t),t.height=-1,delete this.m_nodes[t.id]},c.prototype.createProxy=function(t,e){const i=this.allocateNode();return i.aabb.set(t),m.extend(i.aabb,s.aabbExtension),i.userData=e,i.height=0,this.insertLeaf(i),i.id},c.prototype.destroyProxy=function(t){const e=this.m_nodes[t];this.removeLeaf(e),this.freeNode(e)},c.prototype.moveProxy=function(t,e,i){const o=this.m_nodes[t];return!o.aabb.contains(e)&&(this.removeLeaf(o),o.aabb.set(e),e=o.aabb,m.extend(e,s.aabbExtension),i.x<0?e.lowerBound.x+=i.x*s.aabbMultiplier:e.upperBound.x+=i.x*s.aabbMultiplier,i.y<0?e.lowerBound.y+=i.y*s.aabbMultiplier:e.upperBound.y+=i.y*s.aabbMultiplier,this.insertLeaf(o),!0)},c.prototype.insertLeaf=function(t){if(null==this.m_root)return this.m_root=t,void(this.m_root.parent=null);const e=t.aabb;let i=this.m_root;for(;0==i.isLeaf();){let t=i.child1,s=i.child2;const o=i.aabb.getPerimeter(),n=new m;n.combine(i.aabb,e);const r=n.getPerimeter(),h=2*r,c=2*(r-o);let l,a;if(t.isLeaf()){let i=new m;i.combine(e,t.aabb),l=i.getPerimeter()+c}else{let i=new m;i.combine(e,t.aabb);let s=t.aabb.getPerimeter();l=i.getPerimeter()-s+c}if(s.isLeaf()){let t=new m;t.combine(e,s.aabb),a=t.getPerimeter()+c}else{let t=new m;t.combine(e,s.aabb);let i=s.aabb.getPerimeter();a=t.getPerimeter()-i+c}if(h<l&&h<a)break;i=l<a?t:s}const s=i,o=s.parent,n=this.allocateNode();for(n.parent=o,n.userData=null,n.aabb.combine(e,s.aabb),n.height=s.height+1,null!=o?(o.child1==s?o.child1=n:o.child2=n,n.child1=s,n.child2=t,s.parent=n,t.parent=n):(n.child1=s,n.child2=t,s.parent=n,t.parent=n,this.m_root=n),i=t.parent;null!=i;){i=this.balance(i);let t=i.child1,e=i.child2;i.height=1+r.max(t.height,e.height),i.aabb.combine(t.aabb,e.aabb),i=i.parent}},c.prototype.removeLeaf=function(t){if(t==this.m_root)return void(this.m_root=null);const e=t.parent,i=e.parent;let s;if(s=e.child1==t?e.child2:e.child1,null!=i){i.child1==e?i.child1=s:i.child2=s,s.parent=i,this.freeNode(e);let t=i;for(;null!=t;){t=this.balance(t);const e=t.child1,i=t.child2;t.aabb.combine(e.aabb,i.aabb),t.height=1+r.max(e.height,i.height),t=t.parent}}else this.m_root=s,s.parent=null,this.freeNode(e)},c.prototype.balance=function(t){const e=t;if(e.isLeaf()||e.height<2)return t;const i=e.child1,s=e.child2,o=s.height-i.height;if(o>1){const o=s.child1,n=s.child2;return s.child1=e,s.parent=e.parent,e.parent=s,null!=s.parent?s.parent.child1==t?s.parent.child1=s:s.parent.child2=s:this.m_root=s,o.height>n.height?(s.child2=o,e.child2=n,n.parent=e,e.aabb.combine(i.aabb,n.aabb),s.aabb.combine(e.aabb,o.aabb),e.height=1+r.max(i.height,n.height),s.height=1+r.max(e.height,o.height)):(s.child2=n,e.child2=o,o.parent=e,e.aabb.combine(i.aabb,o.aabb),s.aabb.combine(e.aabb,n.aabb),e.height=1+r.max(i.height,o.height),s.height=1+r.max(e.height,n.height)),s}if(o<-1){const t=i.child1,o=i.child2;return i.child1=e,i.parent=e.parent,e.parent=i,null!=i.parent?i.parent.child1==e?i.parent.child1=i:i.parent.child2=i:this.m_root=i,t.height>o.height?(i.child2=t,e.child1=o,o.parent=e,e.aabb.combine(s.aabb,o.aabb),i.aabb.combine(e.aabb,t.aabb),e.height=1+r.max(s.height,o.height),i.height=1+r.max(e.height,t.height)):(i.child2=o,e.child1=t,t.parent=e,e.aabb.combine(s.aabb,t.aabb),i.aabb.combine(e.aabb,o.aabb),e.height=1+r.max(s.height,t.height),i.height=1+r.max(e.height,o.height)),i}return e},c.prototype.getHeight=function(){return null==this.m_root?0:this.m_root.height},c.prototype.getAreaRatio=function(){if(null==this.m_root)return 0;const t=this.m_root.aabb.getPerimeter();let e,i=0;const s=_.allocate().preorder();for(;e=s.next();)e.height<0||(i+=e.aabb.getPerimeter());return _.release(s),i/t},c.prototype.validateStructure=function(t){if(null==t)return;this.m_root;const e=t.child1,i=t.child2;t.isLeaf()||(this.validateStructure(e),this.validateStructure(i))},c.prototype.validateMetrics=function(t){if(null==t)return;const e=t.child1,i=t.child2;if(t.isLeaf())return;const s=this.m_nodes[e].height,o=this.m_nodes[i].height,n=(r.max(s,o),new m);n.combine(e.aabb,i.aabb),this.validateMetrics(e),this.validateMetrics(i)},c.prototype.getMaxBalance=function(){let t,e=0;const i=_.allocate().preorder();for(;t=i.next();){if(t.height<=1)continue;const i=r.abs(t.child2.height-t.child1.height);e=r.max(e,i)}return _.release(i),e},c.prototype.rebuildBottomUp=function(){const t=[];let e,i=0;const s=_.allocate().preorder();for(;e=s.next();)e.height<0||(e.isLeaf()?(e.parent=null,t[i]=e,++i):this.freeNode(e));for(_.release(s);i>1;){let e=1/0,s=-1,o=-1;for(let n=0;n<i;++n){const r=t[n].aabb;for(let h=n+1;h<i;++h){const i=t[h].aabb,c=new m;c.combine(r,i);const l=c.getPerimeter();l<e&&(s=n,o=h,e=l)}}const n=t[s],h=t[o],c=this.allocateNode();c.child1=n,c.child2=h,c.height=1+r.max(n.height,h.height),c.aabb.combine(n.aabb,h.aabb),c.parent=null,n.parent=c,h.parent=c,t[o]=t[i-1],t[s]=c,--i}this.m_root=t[0]},c.prototype.shiftOrigin=function(t){let e;const i=_.allocate().preorder();for(;e=i.next();){const i=e.aabb;i.lowerBound.x-=t.x,i.lowerBound.y-=t.y,i.upperBound.x-=t.x,i.upperBound.y-=t.y}_.release(i)},c.prototype.query=function(t,e){const i=a.allocate();for(i.push(this.m_root);i.length>0;){const s=i.pop();if(null!=s&&m.testOverlap(s.aabb,t))if(s.isLeaf()){if(0==e(s.id,s.userData))return}else i.push(s.child1),i.push(s.child2)}a.release(i)},c.prototype.rayCast=function(t,e,i,s,o){i=i||t.p1,s=s||t.p2;const h=n.sub(s,i);h.normalize();const c=n.cross(1,h),_=n.abs(c);o=o>=0?o:t.maxFraction;const u=new m;let p=n.combine(1-o,i,o,s);u.combinePoints(i,p);const d=a.allocate(),y=l.allocate();for(d.push(this.m_root);d.length>0;){const t=d.pop();if(null==t)continue;if(0==m.testOverlap(t.aabb,u))continue;const h=t.aabb.getCenter(),l=t.aabb.getExtents();if(!(r.abs(n.dot(c,n.sub(i,h)))-n.dot(_,l)>0))if(t.isLeaf()){y.p1=n.clone(i),y.p2=n.clone(s),y.maxFraction=o;const r=e(y,t.id,t.userData);if(0==r)break;r>0&&(o=r,p=n.combine(1-o,i,o,s),u.combinePoints(i,p))}else d.push(t.child1),d.push(t.child2)}a.release(d),l.release(y)};let l=new o({create:function(){return{}},release:function(t){}}),a=new o({create:function(){return[]},release:function(t){t.length=0}}),_=new o({create:function(){return new u},release:function(t){t.close()}});function u(){const t=[],e=[];return{preorder:function(i){return t.length=0,t.push(i),e.length=0,e.push(0),this},next:function(){for(;t.length>0;){const i=t.length-1,s=t[i];if(0===e[i])return e[i]=1,s;if(1===e[i]&&(e[i]=2,s.child1))return t.push(s.child1),e.push(1),s.child1;if(2===e[i]&&(e[i]=3,s.child2))return t.push(s.child2),e.push(1),s.child2;t.pop(),e.pop()}},close:function(){t.length=0}}}},function(t,e,i){const s=i(25),o=s.Input,n=s.Output,r=i(6),m=i(0),h=i(12),c=i(1),l=i(15),a=i(26),_=i(20);function u(t){this.world=t,this.shape,this.distance,this.currentDistance,this.callback,this.proxies,this.xfA=new r,this.cA=new m,this.fraction=1,this.scale=1,this.canReduceAaab=!0,this.aabbStart=new h,this.aabbEnd=new h,this.aabb=new h,this.handleFixture=this.handleFixture.bind(this),this.circle,this.box,this.capsule}function p(t,e,i,o,r){const m=new n;if(s(m,t),m.state!==n.e_touching&&m.state!==n.e_overlapped)return;const h=new y,c=h.evaluate(m.cache,t.proxyA,t.sweepA,t.proxyB,t.sweepB,m.t);this.normal=m.state===n.e_touching?h.m_normalB:h.m_normalB.neg(),this.centroid=h.m_centroid,i*=m.t,this.distance=i,this.fraction=i/o,this.point=h.m_type===d?h.m_pointA.addMul(-.5*(c+r),this.normal):h.m_pointB.addMul(.5*(c-r),this.normal),this.fixture=e}t.exports=u,u.prototype.castCircle=function(t,e,i,s,o){this.circle?this.circle.setRadius(e):this.circle=new l(e),this.execute(this.circle,t,0,i,s,o)},u.prototype.castBox=function(t,e,i,s,o,n,r){this.box?this.box._setAsBox(e,i):this.box=new a(e,i),this.execute(this.box,t,s,o,n,r)},u.prototype.castCapsule=function(t,e,i,s,o,n,r,m){this.capsule?(this.capsule.setVertex1(e),this.capsule.setVertex2(i),this.capsule.setRadius(s)):this.capsule=new _(e,i,s),this.execute(this.capsule,t,o,n,r,m)},u.prototype.execute=function(t,e,i,s,o,n){this.shape=t,this.callback=n;const r=this.xfA;r.p.set(e),r.q.setAngle(i);const m=s.normalize();this.scale=m>0?m:1,this.distance=o,this.fraction=1,this.canReduceAaab=!0,this.proxies={};const h=this.aabbStart,c=this.aabbEnd,l=this.aabb;for(t.computeAABB(h,r,0);this.canReduceAaab;)this.canReduceAaab=!1,this.currentDistance=this.fraction*o,this.cA.set(e).addMul(this.currentDistance,s),r.p.set(this.cA),t.computeAABB(c,r,0),l.combine(h,c),r.p.set(e),this.world.queryAABB(l,this.handleFixture);this.callback=this.proxies=null},u.prototype.handleFixture=function(t,e){const i=e.proxyId;if(this.proxies[i])return!0;this.proxies[i]=!0;const s=this.getIntersection(t,e.childIndex);if(!s.fixture)return!0;const o=this.callback(s,s.distance/this.distance);return!(o<this.fraction)||(this.fraction=o,this.canReduceAaab=!0,!1)},u.prototype.getIntersection=function(t,e){const i=new o;i.sweepA.setTransform(this.xfA),i.sweepA.c.set(this.cA),i.proxyA.set(this.shape,0),i.sweepB.setTransform(t.m_body.getTransform());const s=t.getShape();return i.proxyB.set(s,e),i.tMax=1,new p(i,t,this.currentDistance,this.scale,this.shape.m_radius-s.m_radius)};let d=3;function y(){this.m_type,this.m_normalB,this.m_pointA,this.m_pointB,this.m_centroid}y.prototype.evaluate=function(t,e,i,s,o,n){const h=r.identity(),l=r.identity();if(i.getTransform(h,n),o.getTransform(l,n),this.m_centroid=h.p,1===t.count){this.m_type=1;let i=e.getVertex(t.indexA[0]),o=s.getVertex(t.indexB[0]),n=r.mulVec2(h,i),c=r.mulVec2(l,o);return this.m_normalB=m.combine(1,n,-1,c),this.m_pointA=n,this.m_pointB=c,this.m_normalB.normalize()}if(t.indexA[0]==t.indexA[1]){this.m_type=d;const i=s.getVertex(t.indexB[0]),o=s.getVertex(t.indexB[1]);let n=m.sub(o,i);n.set(n.y,-n.x).normalize();let c=n.rot(l.q),a=m.mid(i,o),_=r.mulVec2(l,a,a),u=e.getVertex(t.indexA[0]),p=r.mulVec2(h,u),y=m.dot(p,c)-m.dot(_,c);return this.m_pointA=p,this.m_pointB=_,y<0?(this.m_normalB=c.neg(),y=-y):this.m_normalB=c,y}if(t.indexB[0]==t.indexB[1]){this.m_type=2;const i=e.getVertex(t.indexA[0]),o=e.getVertex(t.indexA[1]);let n=m.sub(o,i);n.set(n.y,-n.x).normalize();let c=n.rot(h.q),a=m.mid(i,o),_=r.mulVec2(h,a,a),u=s.getVertex(t.indexB[0]),p=r.mulVec2(l,u),d=m.dot(p,c)-m.dot(_,c);return this.m_pointA=_,this.m_pointB=p,d<0?(this.m_normalB=c,d=-d):this.m_normalB=c.neg(),d}{this.m_type=d;const i=r.mulVec2(h,e.getVertex(t.indexA[0])),o=r.mulVec2(h,e.getVertex(t.indexA[1])),n=r.mulVec2(l,s.getVertex(t.indexB[0])),a=r.mulVec2(l,s.getVertex(t.indexB[1]));let _=m.mid(i,o),u=m.mid(n,a);const p=m.mid(_,u),y=o.sub(i),f=p.clone().sub(i),x=m.dot(y,y);this.m_pointA=x<c.EPSILON?i:y.mul(m.dot(f,y)/x).add(i);const g=a.sub(n),v=p.clone().sub(n),A=m.dot(g,g);this.m_pointB=A<c.EPSILON?n:g.mul(m.dot(v,g)/A).add(n),this.m_normalB=p.set(this.m_pointA).sub(this.m_pointB);let b=this.m_normalB.normalize();return b<=c.EPSILON&&this.m_normalB.set(0,1),b}}},function(t,e){const i={},s={};t.exports=i,i.WINDING_ODD=0,i.WINDING_NONZERO=1,i.WINDING_POSITIVE=2,i.WINDING_NEGATIVE=3,i.WINDING_ABS_GEQ_TWO=4,i.POLYGONS=0,i.CONNECTED_POLYGONS=1,i.BOUNDARY_CONTOURS=2,i.tesselate=function(t){const e=t.debug||!1,s=new y;for(let e=0;e<t.contours.length;e++)s.addContour(t.vertexSize||2,t.contours[e]);return s.tesselate(t.windingRule||i.WINDING_ODD,t.elementType||i.POLYGONS,t.polySize||3,t.vertexSize||2,t.normal||[0,0,1]),{vertices:s.vertices,vertexIndices:s.vertexIndices,vertexCount:s.vertexCount,elements:s.elements,elementCount:s.elementCount,mesh:e?s.mesh:void 0}};const o=function(t){if(!t)throw new Error("Assertion Failed!")};function n(){this.next=null,this.prev=null,this.anEdge=null,this.coords=[0,0,0],this.s=0,this.t=0,this.pqHandle=0,this.n=0,this.idx=0}function r(){this.next=null,this.prev=null,this.anEdge=null,this.trail=null,this.n=0,this.marked=!1,this.inside=!1}function m(t){this.next=null,this.Sym=null,this.Onext=null,this.Lnext=null,this.Org=null,this.Lface=null,this.activeRegion=null,this.winding=0,this.side=t}function h(){const t=new n,e=new r,i=new m(0),s=new m(1);t.next=t.prev=t,t.anEdge=null,e.next=e.prev=e,e.anEdge=null,e.trail=null,e.marked=!1,e.inside=!1,i.next=i,i.Sym=s,i.Onext=null,i.Lnext=null,i.Org=null,i.Lface=null,i.winding=0,i.activeRegion=null,s.next=s,s.Sym=i,s.Onext=null,s.Lnext=null,s.Org=null,s.Lface=null,s.winding=0,s.activeRegion=null,this.vHead=t,this.fHead=e,this.eHead=i,this.eHeadSym=s}function c(){this.key=null,this.next=null,this.prev=null}function l(t,e){this.head=new c,this.head.next=this.head,this.head.prev=this.head,this.frame=t,this.leq=e}function a(){this.handle=null}function _(){this.key=null,this.node=null}function u(t,e){let i;for(this.size=0,this.max=t,this.nodes=[],this.nodes.length=t+1,i=0;i<this.nodes.length;i++)this.nodes[i]=new a;for(this.handles=[],this.handles.length=t+1,i=0;i<this.handles.length;i++)this.handles[i]=new _;this.initialized=!1,this.freeList=0,this.leq=e,this.nodes[1].handle=1,this.handles[1].key=null}function p(){this.eUp=null,this.nodeUp=null,this.windingNumber=0,this.inside=!1,this.sentinel=!1,this.dirty=!1,this.fixUpperEdge=!1}m.prototype={get Rface(){return this.Sym.Lface},set Rface(t){this.Sym.Lface=t},get Dst(){return this.Sym.Org},set Dst(t){this.Sym.Org=t},get Oprev(){return this.Sym.Lnext},set Oprev(t){this.Sym.Lnext=t},get Lprev(){return this.Onext.Sym},set Lprev(t){this.Onext.Sym=t},get Dprev(){return this.Lnext.Sym},set Dprev(t){this.Lnext.Sym=t},get Rprev(){return this.Sym.Onext},set Rprev(t){this.Sym.Onext=t},get Dnext(){return this.Sym.Onext.Sym},set Dnext(t){this.Sym.Onext.Sym=t},get Rnext(){return this.Sym.Lnext.Sym},set Rnext(t){this.Sym.Lnext.Sym=t}},h.prototype={makeEdge_:function(t){const e=new m(0),i=new m(1);t.Sym.side<t.side&&(t=t.Sym);const s=t.Sym.next;return i.next=s,s.Sym.next=e,e.next=t,t.Sym.next=i,e.Sym=i,e.Onext=e,e.Lnext=i,e.Org=null,e.Lface=null,e.winding=0,e.activeRegion=null,i.Sym=e,i.Onext=i,i.Lnext=e,i.Org=null,i.Lface=null,i.winding=0,i.activeRegion=null,e},splice_:function(t,e){const i=t.Onext,s=e.Onext;i.Sym.Lnext=e,s.Sym.Lnext=t,t.Onext=s,e.Onext=i},makeVertex_:function(t,e,i){const s=t;o(null!==s);const n=i.prev;s.prev=n,n.next=s,s.next=i,i.prev=s,s.anEdge=e;let r=e;do{r.Org=s,r=r.Onext}while(r!==e)},makeFace_:function(t,e,i){const s=t;o(null!==s);const n=i.prev;s.prev=n,n.next=s,s.next=i,i.prev=s,s.anEdge=e,s.trail=null,s.marked=!1,s.inside=i.inside;let r=e;do{r.Lface=s,r=r.Lnext}while(r!==e)},killEdge_:function(t){t.Sym.side<t.side&&(t=t.Sym);const e=t.next,i=t.Sym.next;e.Sym.next=i,i.Sym.next=e},killVertex_:function(t,e){const i=t.anEdge;let s=i;do{s.Org=e,s=s.Onext}while(s!==i);const o=t.prev,n=t.next;n.prev=o,o.next=n},killFace_:function(t,e){const i=t.anEdge;let s=i;do{s.Lface=e,s=s.Lnext}while(s!==i);const o=t.prev,n=t.next;n.prev=o,o.next=n},makeEdge:function(){const t=new n,e=new n,i=new r,s=this.makeEdge_(this.eHead);return this.makeVertex_(t,s,this.vHead),this.makeVertex_(e,s.Sym,this.vHead),this.makeFace_(i,s,this.fHead),s},splice:function(t,e){let i=!1,s=!1;if(t!==e){if(e.Org!==t.Org&&(s=!0,this.killVertex_(e.Org,t.Org)),e.Lface!==t.Lface&&(i=!0,this.killFace_(e.Lface,t.Lface)),this.splice_(e,t),!s){const i=new n;this.makeVertex_(i,e,t.Org),t.Org.anEdge=t}if(!i){const i=new r;this.makeFace_(i,e,t.Lface),t.Lface.anEdge=t}}},delete:function(t){const e=t.Sym;let i=!1;if(t.Lface!==t.Rface&&(i=!0,this.killFace_(t.Lface,t.Rface)),t.Onext===t)this.killVertex_(t.Org,null);else if(t.Rface.anEdge=t.Oprev,t.Org.anEdge=t.Onext,this.splice_(t,t.Oprev),!i){const e=new r;this.makeFace_(e,t,t.Lface)}e.Onext===e?(this.killVertex_(e.Org,null),this.killFace_(e.Lface,null)):(t.Lface.anEdge=e.Oprev,e.Org.anEdge=e.Onext,this.splice_(e,e.Oprev)),this.killEdge_(t)},addEdgeVertex:function(t){const e=this.makeEdge_(t),i=e.Sym;this.splice_(e,t.Lnext),e.Org=t.Dst;const s=new n;return this.makeVertex_(s,i,e.Org),e.Lface=i.Lface=t.Lface,e},splitEdge:function(t,e){const i=this.addEdgeVertex(t).Sym;return this.splice_(t.Sym,t.Sym.Oprev),this.splice_(t.Sym,i),t.Dst=i.Org,i.Dst.anEdge=i.Sym,i.Rface=t.Rface,i.winding=t.winding,i.Sym.winding=t.Sym.winding,i},connect:function(t,e){let i=!1;const s=this.makeEdge_(t),o=s.Sym;if(e.Lface!==t.Lface&&(i=!0,this.killFace_(e.Lface,t.Lface)),this.splice_(s,t.Lnext),this.splice_(o,e),s.Org=t.Dst,o.Org=e.Org,s.Lface=o.Lface=t.Lface,t.Lface.anEdge=o,!i){const e=new r;this.makeFace_(e,s,t.Lface)}return s},zapFace:function(t){const e=t.anEdge;let i,s,o;s=e.Lnext;do{i=s,s=i.Lnext,i.Lface=null,null===i.Rface&&(i.Onext===i?this.killVertex_(i.Org,null):(i.Org.anEdge=i.Onext,this.splice_(i,i.Oprev)),o=i.Sym,o.Onext===o?this.killVertex_(o.Org,null):(o.Org.anEdge=o.Onext,this.splice_(o,o.Oprev)),this.killEdge_(i))}while(i!==e);const n=t.prev,r=t.next;r.prev=n,n.next=r},countFaceVerts_:function(t){let e=t.anEdge,i=0;do{i++,e=e.Lnext}while(e!==t.anEdge);return i},mergeConvexFaces:function(t){let e,i,o,n,r,m,h;for(e=this.fHead.next;e!==this.fHead;e=e.next)if(e.inside)for(i=e.anEdge,r=i.Org;o=i.Lnext,n=i.Sym,n&&n.Lface&&n.Lface.inside&&(m=this.countFaceVerts_(e),h=this.countFaceVerts_(n.Lface),m+h-2<=t&&s.vertCCW(i.Lprev.Org,i.Org,n.Lnext.Lnext.Org)&&s.vertCCW(n.Lprev.Org,n.Org,i.Lnext.Lnext.Org)&&(o=n.Lnext,this.delete(n),i=null,n=null)),!i||i.Lnext.Org!==r;)i=o;return!0},check:function(){const t=this.fHead,e=this.vHead,i=this.eHead;let s,n,r,m,h,c;for(n=t,n=t;(s=n.next)!==t;n=s){o(s.prev===n),h=s.anEdge;do{o(h.Sym!==h),o(h.Sym.Sym===h),o(h.Lnext.Onext.Sym===h),o(h.Onext.Sym.Lnext===h),o(h.Lface===s),h=h.Lnext}while(h!==s.anEdge)}for(o(s.prev===n&&null===s.anEdge),m=e,m=e;(r=m.next)!==e;m=r){o(r.prev===m),h=r.anEdge;do{o(h.Sym!==h),o(h.Sym.Sym===h),o(h.Lnext.Onext.Sym===h),o(h.Onext.Sym.Lnext===h),o(h.Org===r),h=h.Onext}while(h!==r.anEdge)}for(o(r.prev===m&&null===r.anEdge),c=i,c=i;(h=c.next)!==i;c=h)o(h.Sym.next===c.Sym),o(h.Sym!==h),o(h.Sym.Sym===h),o(null!==h.Org),o(null!==h.Dst),o(h.Lnext.Onext.Sym===h),o(h.Onext.Sym.Lnext===h);o(h.Sym.next===c.Sym&&h.Sym===this.eHeadSym&&h.Sym.Sym===h&&null===h.Org&&null===h.Dst&&null===h.Lface&&null===h.Rface)}},s.vertEq=function(t,e){return t.s===e.s&&t.t===e.t},s.vertLeq=function(t,e){return t.s<e.s||t.s===e.s&&t.t<=e.t},s.transLeq=function(t,e){return t.t<e.t||t.t===e.t&&t.s<=e.s},s.edgeGoesLeft=function(t){return s.vertLeq(t.Dst,t.Org)},s.edgeGoesRight=function(t){return s.vertLeq(t.Org,t.Dst)},s.vertL1dist=function(t,e){return Math.abs(t.s-e.s)+Math.abs(t.t-e.t)},s.edgeEval=function(t,e,i){o(s.vertLeq(t,e)&&s.vertLeq(e,i));const n=e.s-t.s,r=i.s-e.s;return n+r>0?n<r?e.t-t.t+(t.t-i.t)*(n/(n+r)):e.t-i.t+(i.t-t.t)*(r/(n+r)):0},s.edgeSign=function(t,e,i){o(s.vertLeq(t,e)&&s.vertLeq(e,i));const n=e.s-t.s,r=i.s-e.s;return n+r>0?(e.t-i.t)*n+(e.t-t.t)*r:0},s.transEval=function(t,e,i){o(s.transLeq(t,e)&&s.transLeq(e,i));const n=e.t-t.t,r=i.t-e.t;return n+r>0?n<r?e.s-t.s+(t.s-i.s)*(n/(n+r)):e.s-i.s+(i.s-t.s)*(r/(n+r)):0},s.transSign=function(t,e,i){o(s.transLeq(t,e)&&s.transLeq(e,i));const n=e.t-t.t,r=i.t-e.t;return n+r>0?(e.s-i.s)*n+(e.s-t.s)*r:0},s.vertCCW=function(t,e,i){return t.s*(e.t-i.t)+e.s*(i.t-t.t)+i.s*(t.t-e.t)>=0},s.interpolate=function(t,e,i,s){return(t=t<0?0:t)<=(i=i<0?0:i)?0===i?(e+s)/2:e+t/(t+i)*(s-e):s+i/(t+i)*(e-s)},s.intersect=function(t,e,i,o,n){let r,m,h;s.vertLeq(t,e)||(h=t,t=e,e=h),s.vertLeq(i,o)||(h=i,i=o,o=h),s.vertLeq(t,i)||(h=t,t=i,i=h,h=e,e=o,o=h),s.vertLeq(i,e)?s.vertLeq(e,o)?(r=s.edgeEval(t,i,e),m=s.edgeEval(i,e,o),r+m<0&&(r=-r,m=-m),n.s=s.interpolate(r,i.s,m,e.s)):(r=s.edgeSign(t,i,e),m=-s.edgeSign(t,o,e),r+m<0&&(r=-r,m=-m),n.s=s.interpolate(r,i.s,m,o.s)):n.s=(i.s+e.s)/2,s.transLeq(t,e)||(h=t,t=e,e=h),s.transLeq(i,o)||(h=i,i=o,o=h),s.transLeq(t,i)||(h=t,t=i,i=h,h=e,e=o,o=h),s.transLeq(i,e)?s.transLeq(e,o)?(r=s.transEval(t,i,e),m=s.transEval(i,e,o),r+m<0&&(r=-r,m=-m),n.t=s.interpolate(r,i.t,m,e.t)):(r=s.transSign(t,i,e),m=-s.transSign(t,o,e),r+m<0&&(r=-r,m=-m),n.t=s.interpolate(r,i.t,m,o.t)):n.t=(i.t+e.t)/2},l.prototype={min:function(){return this.head.next},max:function(){return this.head.prev},insert:function(t){return this.insertBefore(this.head,t)},search:function(t){let e=this.head;do{e=e.next}while(null!==e.key&&!this.leq(this.frame,t,e.key));return e},insertBefore:function(t,e){do{t=t.prev}while(null!==t.key&&!this.leq(this.frame,t.key,e));const i=new c;return i.key=e,i.next=t.next,t.next.prev=i,i.prev=t,t.next=i,i},delete:function(t){t.next.prev=t.prev,t.prev.next=t.next}},u.prototype={floatDown_:function(t){const e=this.nodes,i=this.handles;let s,n;const r=e[t].handle;for(;;){if(n=t<<1,n<this.size&&this.leq(i[e[n+1].handle].key,i[e[n].handle].key)&&++n,o(n<=this.max),s=e[n].handle,n>this.size||this.leq(i[r].key,i[s].key)){e[t].handle=r,i[r].node=t;break}e[t].handle=s,i[s].node=t,t=n}},floatUp_:function(t){const e=this.nodes,i=this.handles;let s,o;const n=e[t].handle;for(;;){if(o=t>>1,s=e[o].handle,0===o||this.leq(i[s].key,i[n].key)){e[t].handle=n,i[n].node=t;break}e[t].handle=s,i[s].node=t,t=o}},init:function(){for(let t=this.size;t>=1;--t)this.floatDown_(t);this.initialized=!0},min:function(){return this.handles[this.nodes[1].handle].key},insert:function(t){let e;const i=++this.size;if(2*i>this.max){let t,e;for(this.max*=2,e=this.nodes.length,this.nodes.length=this.max+1,t=e;t<this.nodes.length;t++)this.nodes[t]=new a;for(e=this.handles.length,this.handles.length=this.max+1,t=e;t<this.handles.length;t++)this.handles[t]=new _}return 0===this.freeList?e=i:(e=this.freeList,this.freeList=this.handles[e].node),this.nodes[i].handle=e,this.handles[e].node=i,this.handles[e].key=t,this.initialized&&this.floatUp_(i),e},extractMin:function(){const t=this.nodes,e=this.handles,i=t[1].handle,s=e[i].key;return this.size>0&&(t[1].handle=t[this.size].handle,e[t[1].handle].node=1,e[i].key=null,e[i].node=this.freeList,this.freeList=i,--this.size,this.size>0&&this.floatDown_(1)),s},delete:function(t){const e=this.nodes,i=this.handles;o(t>=1&&t<=this.max&&null!==i[t].key);const s=i[t].node;e[s].handle=e[this.size].handle,i[e[s].handle].node=s,--this.size,s<=this.size&&(s<=1||this.leq(i[e[s>>1].handle].key,i[e[s].handle].key)?this.floatDown_(s):this.floatUp_(s)),i[t].key=null,i[t].node=this.freeList,this.freeList=t}};const d={};function y(){this.mesh=null,this.normal=[0,0,0],this.sUnit=[0,0,0],this.tUnit=[0,0,0],this.bmin=[0,0],this.bmax=[0,0],this.windingRule=i.WINDING_ODD,this.dict=null,this.pq=null,this.event=null,this.vertexIndexCounter=0,this.vertices=[],this.vertexIndices=[],this.vertexCount=0,this.elements=[],this.elementCount=0}d.regionBelow=function(t){return t.nodeUp.prev.key},d.regionAbove=function(t){return t.nodeUp.next.key},d.debugEvent=function(t){},d.addWinding=function(t,e){t.winding+=e.winding,t.Sym.winding+=e.Sym.winding},d.edgeLeq=function(t,e,i){const o=t.event,n=e.eUp,r=i.eUp;if(n.Dst===o)return r.Dst===o?s.vertLeq(n.Org,r.Org)?s.edgeSign(r.Dst,n.Org,r.Org)<=0:s.edgeSign(n.Dst,r.Org,n.Org)>=0:s.edgeSign(r.Dst,o,r.Org)<=0;if(r.Dst===o)return s.edgeSign(n.Dst,o,n.Org)>=0;return s.edgeEval(n.Dst,o,n.Org)>=s.edgeEval(r.Dst,o,r.Org)},d.deleteRegion=function(t,e){e.fixUpperEdge&&o(0===e.eUp.winding),e.eUp.activeRegion=null,t.dict.delete(e.nodeUp)},d.fixUpperEdge=function(t,e,i){o(e.fixUpperEdge),t.mesh.delete(e.eUp),e.fixUpperEdge=!1,e.eUp=i,i.activeRegion=e},d.topLeftRegion=function(t,e){const i=e.eUp.Org;let s;do{e=d.regionAbove(e)}while(e.eUp.Org===i);if(e.fixUpperEdge){if(s=t.mesh.connect(d.regionBelow(e).eUp.Sym,e.eUp.Lnext),null===s)return null;d.fixUpperEdge(t,e,s),e=d.regionAbove(e)}return e},d.topRightRegion=function(t){const e=t.eUp.Dst;do{t=d.regionAbove(t)}while(t.eUp.Dst===e);return t},d.addRegionBelow=function(t,e,i){const s=new p;return s.eUp=i,s.nodeUp=t.dict.insertBefore(e.nodeUp,s),s.fixUpperEdge=!1,s.sentinel=!1,s.dirty=!1,i.activeRegion=s,s},d.isWindingInside=function(t,e){switch(t.windingRule){case i.WINDING_ODD:return 0!=(1&e);case i.WINDING_NONZERO:return 0!==e;case i.WINDING_POSITIVE:return e>0;case i.WINDING_NEGATIVE:return e<0;case i.WINDING_ABS_GEQ_TWO:return e>=2||e<=-2}return o(!1),!1},d.computeWinding=function(t,e){e.windingNumber=d.regionAbove(e).windingNumber+e.eUp.winding,e.inside=d.isWindingInside(t,e.windingNumber)},d.finishRegion=function(t,e){const i=e.eUp,s=i.Lface;s.inside=e.inside,s.anEdge=i,d.deleteRegion(t,e)},d.finishLeftRegions=function(t,e,i){let s,o=null,n=e,r=e.eUp;for(;n!==i;){if(n.fixUpperEdge=!1,o=d.regionBelow(n),s=o.eUp,s.Org!==r.Org){if(!o.fixUpperEdge){d.finishRegion(t,n);break}s=t.mesh.connect(r.Lprev,s.Sym),d.fixUpperEdge(t,o,s)}r.Onext!==s&&(t.mesh.splice(s.Oprev,s),t.mesh.splice(r,s)),d.finishRegion(t,n),r=o.eUp,n=o}return r},d.addRightEdges=function(t,e,i,n,r,m){let h,c,l,a,_=!0;l=i;do{o(s.vertLeq(l.Org,l.Dst)),d.addRegionBelow(t,e,l.Sym),l=l.Onext}while(l!==n);for(null===r&&(r=d.regionBelow(e).eUp.Rprev),c=e,a=r;h=d.regionBelow(c),l=h.eUp.Sym,l.Org===a.Org;)l.Onext!==a&&(t.mesh.splice(l.Oprev,l),t.mesh.splice(a.Oprev,l)),h.windingNumber=c.windingNumber-l.winding,h.inside=d.isWindingInside(t,h.windingNumber),c.dirty=!0,!_&&d.checkForRightSplice(t,c)&&(d.addWinding(l,a),d.deleteRegion(t,c),t.mesh.delete(a)),_=!1,c=h,a=l;c.dirty=!0,o(c.windingNumber-l.winding===h.windingNumber),m&&d.walkDirtyRegions(t,c)},d.spliceMergeVertices=function(t,e,i){t.mesh.splice(e,i)},d.vertexWeights=function(t,e,i){const o=s.vertL1dist(e,t),n=s.vertL1dist(i,t),r=.5*n/(o+n),m=.5*o/(o+n);t.coords[0]+=r*e.coords[0]+m*i.coords[0],t.coords[1]+=r*e.coords[1]+m*i.coords[1],t.coords[2]+=r*e.coords[2]+m*i.coords[2]},d.getIntersectData=function(t,e,i,s,o,n){e.coords[0]=e.coords[1]=e.coords[2]=0,e.idx=-1,d.vertexWeights(e,i,s),d.vertexWeights(e,o,n)},d.checkForRightSplice=function(t,e){const i=d.regionBelow(e),o=e.eUp,n=i.eUp;if(s.vertLeq(o.Org,n.Org)){if(s.edgeSign(n.Dst,o.Org,n.Org)>0)return!1;s.vertEq(o.Org,n.Org)?o.Org!==n.Org&&(t.pq.delete(o.Org.pqHandle),d.spliceMergeVertices(t,n.Oprev,o)):(t.mesh.splitEdge(n.Sym),t.mesh.splice(o,n.Oprev),e.dirty=i.dirty=!0)}else{if(s.edgeSign(o.Dst,n.Org,o.Org)<0)return!1;d.regionAbove(e).dirty=e.dirty=!0,t.mesh.splitEdge(o.Sym),t.mesh.splice(n.Oprev,o)}return!0},d.checkForLeftSplice=function(t,e){const i=d.regionBelow(e),n=e.eUp,r=i.eUp;let m;if(o(!s.vertEq(n.Dst,r.Dst)),s.vertLeq(n.Dst,r.Dst)){if(s.edgeSign(n.Dst,r.Dst,n.Org)<0)return!1;d.regionAbove(e).dirty=e.dirty=!0,m=t.mesh.splitEdge(n),t.mesh.splice(r.Sym,m),m.Lface.inside=e.inside}else{if(s.edgeSign(r.Dst,n.Dst,r.Org)>0)return!1;e.dirty=i.dirty=!0,m=t.mesh.splitEdge(r),t.mesh.splice(n.Lnext,r.Sym),m.Rface.inside=e.inside}return!0},d.checkForIntersect=function(t,e){let i=d.regionBelow(e),r=e.eUp,m=i.eUp;const h=r.Org,c=m.Org,l=r.Dst,a=m.Dst,_=new n;let u,p;if(o(!s.vertEq(a,l)),o(s.edgeSign(l,t.event,h)<=0),o(s.edgeSign(a,t.event,c)>=0),o(h!==t.event&&c!==t.event),o(!e.fixUpperEdge&&!i.fixUpperEdge),h===c)return!1;if(Math.min(h.t,l.t)>Math.max(c.t,a.t))return!1;if(s.vertLeq(h,c)){if(s.edgeSign(a,h,c)>0)return!1}else if(s.edgeSign(l,c,h)<0)return!1;return d.debugEvent(t),s.intersect(l,h,a,c,_),o(Math.min(h.t,l.t)<=_.t),o(_.t<=Math.max(c.t,a.t)),o(Math.min(a.s,l.s)<=_.s),o(_.s<=Math.max(c.s,h.s)),s.vertLeq(_,t.event)&&(_.s=t.event.s,_.t=t.event.t),u=s.vertLeq(h,c)?h:c,s.vertLeq(u,_)&&(_.s=u.s,_.t=u.t),s.vertEq(_,h)||s.vertEq(_,c)?(d.checkForRightSplice(t,e),!1):!s.vertEq(l,t.event)&&s.edgeSign(l,t.event,_)>=0||!s.vertEq(a,t.event)&&s.edgeSign(a,t.event,_)<=0?a===t.event?(t.mesh.splitEdge(r.Sym),t.mesh.splice(m.Sym,r),e=d.topLeftRegion(t,e),r=d.regionBelow(e).eUp,d.finishLeftRegions(t,d.regionBelow(e),i),d.addRightEdges(t,e,r.Oprev,r,r,!0),!0):l===t.event?(t.mesh.splitEdge(m.Sym),t.mesh.splice(r.Lnext,m.Oprev),i=e,e=d.topRightRegion(e),p=d.regionBelow(e).eUp.Rprev,i.eUp=m.Oprev,m=d.finishLeftRegions(t,i,null),d.addRightEdges(t,e,m.Onext,r.Rprev,p,!0),!0):(s.edgeSign(l,t.event,_)>=0&&(d.regionAbove(e).dirty=e.dirty=!0,t.mesh.splitEdge(r.Sym),r.Org.s=t.event.s,r.Org.t=t.event.t),s.edgeSign(a,t.event,_)<=0&&(e.dirty=i.dirty=!0,t.mesh.splitEdge(m.Sym),m.Org.s=t.event.s,m.Org.t=t.event.t),!1):(t.mesh.splitEdge(r.Sym),t.mesh.splitEdge(m.Sym),t.mesh.splice(m.Oprev,r),r.Org.s=_.s,r.Org.t=_.t,r.Org.pqHandle=t.pq.insert(r.Org),d.getIntersectData(t,r.Org,h,l,c,a),d.regionAbove(e).dirty=e.dirty=i.dirty=!0,!1)},d.walkDirtyRegions=function(t,e){let i,s,o=d.regionBelow(e);for(;;){for(;o.dirty;)e=o,o=d.regionBelow(o);if(!e.dirty&&(o=e,null===(e=d.regionAbove(e))||!e.dirty))return;if(e.dirty=!1,i=e.eUp,s=o.eUp,i.Dst!==s.Dst&&d.checkForLeftSplice(t,e)&&(o.fixUpperEdge?(d.deleteRegion(t,o),t.mesh.delete(s),o=d.regionBelow(e),s=o.eUp):e.fixUpperEdge&&(d.deleteRegion(t,e),t.mesh.delete(i),i=(e=d.regionAbove(o)).eUp)),i.Org!==s.Org)if(i.Dst===s.Dst||e.fixUpperEdge||o.fixUpperEdge||i.Dst!==t.event&&s.Dst!==t.event)d.checkForRightSplice(t,e);else if(d.checkForIntersect(t,e))return;i.Org===s.Org&&i.Dst===s.Dst&&(d.addWinding(s,i),d.deleteRegion(t,e),t.mesh.delete(i),e=d.regionAbove(o))}},d.connectRightVertex=function(t,e,i){let o,n=i.Onext;const r=d.regionBelow(e),m=e.eUp,h=r.eUp;let c=!1;m.Dst!==h.Dst&&d.checkForIntersect(t,e),s.vertEq(m.Org,t.event)&&(t.mesh.splice(n.Oprev,m),e=d.topLeftRegion(t,e),n=d.regionBelow(e).eUp,d.finishLeftRegions(t,d.regionBelow(e),r),c=!0),s.vertEq(h.Org,t.event)&&(t.mesh.splice(i,h.Oprev),i=d.finishLeftRegions(t,r,null),c=!0),c?d.addRightEdges(t,e,i.Onext,n,n,!0):(o=s.vertLeq(h.Org,m.Org)?h.Oprev:m,o=t.mesh.connect(i.Lprev,o),d.addRightEdges(t,e,o,o.Onext,o.Onext,!1),o.Sym.activeRegion.fixUpperEdge=!0,d.walkDirtyRegions(t,e))},d.connectLeftDegenerate=function(t,e,i){let n,r,m,h,c;return n=e.eUp,s.vertEq(n.Org,i)?(o(!1),void d.spliceMergeVertices(t,n,i.anEdge)):s.vertEq(n.Dst,i)?(o(!1),e=d.topRightRegion(e),c=d.regionBelow(e),m=c.eUp.Sym,r=h=m.Onext,c.fixUpperEdge&&(o(r!==m),d.deleteRegion(t,c),t.mesh.delete(m),m=r.Oprev),t.mesh.splice(i.anEdge,m),s.edgeGoesLeft(r)||(r=null),void d.addRightEdges(t,e,m.Onext,h,r,!0)):(t.mesh.splitEdge(n.Sym),e.fixUpperEdge&&(t.mesh.delete(n.Onext),e.fixUpperEdge=!1),t.mesh.splice(i.anEdge,n),void d.sweepEvent(t,i))},d.connectLeftVertex=function(t,e){let i,o,n,r,m,h;const c=new p;if(c.eUp=e.anEdge.Sym,i=t.dict.search(c).key,o=d.regionBelow(i),o)if(r=i.eUp,m=o.eUp,0!==s.edgeSign(r.Dst,e,r.Org))if(n=s.vertLeq(m.Dst,r.Dst)?i:o,i.inside||n.fixUpperEdge){if(n===i)h=t.mesh.connect(e.anEdge.Sym,r.Lnext);else{h=t.mesh.connect(m.Dnext,e.anEdge).Sym}n.fixUpperEdge?d.fixUpperEdge(t,n,h):d.computeWinding(t,d.addRegionBelow(t,i,h)),d.sweepEvent(t,e)}else d.addRightEdges(t,i,e.anEdge,e.anEdge,null,!0);else d.connectLeftDegenerate(t,i,e)},d.sweepEvent=function(t,e){t.event=e,d.debugEvent(t);let i=e.anEdge;for(;null===i.activeRegion;)if(i=i.Onext,i===e.anEdge)return void d.connectLeftVertex(t,e);const s=d.topLeftRegion(t,i.activeRegion);o(null!==s);const n=d.regionBelow(s),r=n.eUp,m=d.finishLeftRegions(t,n,null);m.Onext===r?d.connectRightVertex(t,s,m):d.addRightEdges(t,s,m.Onext,r,r,!0)},d.addSentinel=function(t,e,i,s){const o=new p,n=t.mesh.makeEdge();n.Org.s=i,n.Org.t=s,n.Dst.s=e,n.Dst.t=s,t.event=n.Dst,o.eUp=n,o.windingNumber=0,o.inside=!1,o.fixUpperEdge=!1,o.sentinel=!0,o.dirty=!1,o.nodeUp=t.dict.insert(o)},d.initEdgeDict=function(t){t.dict=new l(t,d.edgeLeq);const e=t.bmax[0]-t.bmin[0],i=t.bmax[1]-t.bmin[1],s=t.bmin[0]-e,o=t.bmax[0]+e,n=t.bmin[1]-i,r=t.bmax[1]+i;d.addSentinel(t,s,o,n),d.addSentinel(t,s,o,r)},d.doneEdgeDict=function(t){let e,i=0;for(;null!==(e=t.dict.min().key);)e.sentinel||(o(e.fixUpperEdge),o(1==++i)),o(0===e.windingNumber),d.deleteRegion(t,e)},d.removeDegenerateEdges=function(t){let e,i,o;const n=t.mesh.eHead;for(e=n.next;e!==n;e=i)i=e.next,o=e.Lnext,s.vertEq(e.Org,e.Dst)&&e.Lnext.Lnext!==e&&(d.spliceMergeVertices(t,o,e),t.mesh.delete(e),e=o,o=e.Lnext),o.Lnext===e&&(o!==e&&(o!==i&&o!==i.Sym||(i=i.next),t.mesh.delete(o)),e!==i&&e!==i.Sym||(i=i.next),t.mesh.delete(e))},d.initPriorityQ=function(t){let e,i,o,n=0;for(o=t.mesh.vHead,i=o.next;i!==o;i=i.next)n++;for(n+=8,e=t.pq=new u(n,s.vertLeq),o=t.mesh.vHead,i=o.next;i!==o;i=i.next)i.pqHandle=e.insert(i);return i===o&&(e.init(),!0)},d.donePriorityQ=function(t){t.pq=null},d.removeDegenerateFaces=function(t,e){let i,s,n;for(i=e.fHead.next;i!==e.fHead;i=s)s=i.next,n=i.anEdge,o(n.Lnext!==n),n.Lnext.Lnext===n&&(d.addWinding(n.Onext,n),t.mesh.delete(n));return!0},d.computeInterior=function(t){let e,i;if(d.removeDegenerateEdges(t),!d.initPriorityQ(t))return!1;for(d.initEdgeDict(t);null!==(e=t.pq.extractMin());){for(;i=t.pq.min(),null!==i&&s.vertEq(i,e);)i=t.pq.extractMin(),d.spliceMergeVertices(t,e.anEdge,i.anEdge);d.sweepEvent(t,e)}return t.event=t.dict.min().key.eUp.Org,d.debugEvent(t),d.doneEdgeDict(t),d.donePriorityQ(t),!!d.removeDegenerateFaces(t,t.mesh)&&(t.mesh.check(),!0)},y.prototype={dot_:function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},normalize_:function(t){let e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2];o(e>0),e=Math.sqrt(e),t[0]/=e,t[1]/=e,t[2]/=e},longAxis_:function(t){let e=0;return Math.abs(t[1])>Math.abs(t[0])&&(e=1),Math.abs(t[2])>Math.abs(t[e])&&(e=2),e},computeNormal_:function(t){let e,i,s,o,n,r;const m=[0,0,0],h=[0,0,0],c=[0,0,0],l=[0,0,0],a=[0,0,0],_=[null,null,null],u=[null,null,null],p=this.mesh.vHead;let d;for(e=p.next,d=0;d<3;++d)o=e.coords[d],h[d]=o,u[d]=e,m[d]=o,_[d]=e;for(e=p.next;e!==p;e=e.next)for(d=0;d<3;++d)o=e.coords[d],o<h[d]&&(h[d]=o,u[d]=e),o>m[d]&&(m[d]=o,_[d]=e);if(d=0,m[1]-h[1]>m[0]-h[0]&&(d=1),m[2]-h[2]>m[d]-h[d]&&(d=2),h[d]>=m[d])return t[0]=0,t[1]=0,void(t[2]=1);for(r=0,i=u[d],s=_[d],c[0]=i.coords[0]-s.coords[0],c[1]=i.coords[1]-s.coords[1],c[2]=i.coords[2]-s.coords[2],e=p.next;e!==p;e=e.next)l[0]=e.coords[0]-s.coords[0],l[1]=e.coords[1]-s.coords[1],l[2]=e.coords[2]-s.coords[2],a[0]=c[1]*l[2]-c[2]*l[1],a[1]=c[2]*l[0]-c[0]*l[2],a[2]=c[0]*l[1]-c[1]*l[0],n=a[0]*a[0]+a[1]*a[1]+a[2]*a[2],n>r&&(r=n,t[0]=a[0],t[1]=a[1],t[2]=a[2]);r<=0&&(t[0]=t[1]=t[2]=0,t[this.longAxis_(c)]=1)},checkOrientation_:function(){let t,e;const i=this.mesh.fHead;let s;const o=this.mesh.vHead;let n;for(t=0,e=i.next;e!==i;e=e.next)if(n=e.anEdge,!(n.winding<=0))do{t+=(n.Org.s-n.Dst.s)*(n.Org.t+n.Dst.t),n=n.Lnext}while(n!==e.anEdge);if(t<0){for(s=o.next;s!==o;s=s.next)s.t=-s.t;this.tUnit[0]=-this.tUnit[0],this.tUnit[1]=-this.tUnit[1],this.tUnit[2]=-this.tUnit[2]}},projectPolygon_:function(){let t;const e=this.mesh.vHead,i=[0,0,0];let s,o,n,r,m=!1;for(i[0]=this.normal[0],i[1]=this.normal[1],i[2]=this.normal[2],0===i[0]&&0===i[1]&&0===i[2]&&(this.computeNormal_(i),m=!0),s=this.sUnit,o=this.tUnit,n=this.longAxis_(i),s[n]=0,s[(n+1)%3]=1,s[(n+2)%3]=0,o[n]=0,o[(n+1)%3]=0,o[(n+2)%3]=i[n]>0?1:-1,t=e.next;t!==e;t=t.next)t.s=this.dot_(t.coords,s),t.t=this.dot_(t.coords,o);for(m&&this.checkOrientation_(),r=!0,t=e.next;t!==e;t=t.next)r?(this.bmin[0]=this.bmax[0]=t.s,this.bmin[1]=this.bmax[1]=t.t,r=!1):(t.s<this.bmin[0]&&(this.bmin[0]=t.s),t.s>this.bmax[0]&&(this.bmax[0]=t.s),t.t<this.bmin[1]&&(this.bmin[1]=t.t),t.t>this.bmax[1]&&(this.bmax[1]=t.t))},addWinding_:function(t,e){t.winding+=e.winding,t.Sym.winding+=e.Sym.winding},tessellateMonoRegion_:function(t,e){let i,n;for(i=e.anEdge,o(i.Lnext!==i&&i.Lnext.Lnext!==i);s.vertLeq(i.Dst,i.Org);i=i.Lprev);for(;s.vertLeq(i.Org,i.Dst);i=i.Lnext);for(n=i.Lprev;i.Lnext!==n;)if(s.vertLeq(i.Dst,n.Org)){for(;n.Lnext!==i&&(s.edgeGoesLeft(n.Lnext)||s.edgeSign(n.Org,n.Dst,n.Lnext.Dst)<=0);){n=t.connect(n.Lnext,n).Sym}n=n.Lprev}else{for(;n.Lnext!==i&&(s.edgeGoesRight(i.Lprev)||s.edgeSign(i.Dst,i.Org,i.Lprev.Org)>=0);){i=t.connect(i,i.Lprev).Sym}i=i.Lnext}for(o(n.Lnext!==i);n.Lnext.Lnext!==i;){n=t.connect(n.Lnext,n).Sym}return!0},tessellateInterior_:function(t){let e,i;for(e=t.fHead.next;e!==t.fHead;e=i)if(i=e.next,e.inside&&!this.tessellateMonoRegion_(t,e))return!1;return!0},discardExterior_:function(t){let e,i;for(e=t.fHead.next;e!==t.fHead;e=i)i=e.next,e.inside||t.zapFace(e)},setWindingNumber_:function(t,e,i){let s,o;for(s=t.eHead.next;s!==t.eHead;s=o)o=s.next,s.Rface.inside!==s.Lface.inside?s.winding=s.Lface.inside?e:-e:i?t.delete(s):s.winding=0},getNeighbourFace_:function(t){return t.Rface&&t.Rface.inside?t.Rface.n:-1},outputPolymesh_:function(t,e,s,n){let r,m,h,c,l,a=0,_=0;for(s>3&&t.mergeConvexFaces(s),r=t.vHead.next;r!==t.vHead;r=r.next)r.n=-1;for(m=t.fHead.next;m!==t.fHead;m=m.next)if(m.n=-1,m.inside){h=m.anEdge,c=0;do{r=h.Org,-1===r.n&&(r.n=_,_++),c++,h=h.Lnext}while(h!==m.anEdge);o(c<=s),m.n=a,++a}for(this.elementCount=a,e===i.CONNECTED_POLYGONS&&(a*=2),this.elements=[],this.elements.length=a*s,this.vertexCount=_,this.vertices=[],this.vertices.length=_*n,this.vertexIndices=[],this.vertexIndices.length=_,r=t.vHead.next;r!==t.vHead;r=r.next)if(-1!==r.n){const t=r.n*n;this.vertices[t+0]=r.coords[0],this.vertices[t+1]=r.coords[1],n>2&&(this.vertices[t+2]=r.coords[2]),this.vertexIndices[r.n]=r.idx}let u=0;for(m=t.fHead.next;m!==t.fHead;m=m.next)if(m.inside){h=m.anEdge,c=0;do{r=h.Org,this.elements[u++]=r.n,c++,h=h.Lnext}while(h!==m.anEdge);for(l=c;l<s;++l)this.elements[u++]=-1;if(e===i.CONNECTED_POLYGONS){h=m.anEdge;do{this.elements[u++]=this.getNeighbourFace_(h),h=h.Lnext}while(h!==m.anEdge);for(l=c;l<s;++l)this.elements[u++]=-1}}},outputContours_:function(t,e){let i,s,o,n=0,r=0;for(this.vertexCount=0,this.elementCount=0,i=t.fHead.next;i!==t.fHead;i=i.next)if(i.inside){o=s=i.anEdge;do{this.vertexCount++,s=s.Lnext}while(s!==o);this.elementCount++}this.elements=[],this.elements.length=2*this.elementCount,this.vertices=[],this.vertices.length=this.vertexCount*e,this.vertexIndices=[],this.vertexIndices.length=this.vertexCount;let m=0,h=0,c=0;for(n=0,i=t.fHead.next;i!==t.fHead;i=i.next)if(i.inside){r=0,o=s=i.anEdge;do{this.vertices[m++]=s.Org.coords[0],this.vertices[m++]=s.Org.coords[1],e>2&&(this.vertices[m++]=s.Org.coords[2]),this.vertexIndices[h++]=s.Org.idx,r++,s=s.Lnext}while(s!==o);this.elements[c++]=n,this.elements[c++]=r,n+=r}},addContour:function(t,e){let i,s;for(null===this.mesh&&(this.mesh=new h),t<2&&(t=2),t>3&&(t=3),i=null,s=0;s<e.length;s+=t)null===i?(i=this.mesh.makeEdge(),this.mesh.splice(i,i.Sym)):(this.mesh.splitEdge(i),i=i.Lnext),i.Org.coords[0]=e[s+0],i.Org.coords[1]=e[s+1],i.Org.coords[2]=t>2?e[s+2]:0,i.Org.idx=this.vertexIndexCounter++,i.winding=1,i.Sym.winding=-1},tesselate:function(t,e,s,o,n){if(this.vertices=[],this.elements=[],this.vertexIndices=[],this.vertexIndexCounter=0,n&&(this.normal[0]=n[0],this.normal[1]=n[1],this.normal[2]=n[2]),this.windingRule=t,o<2&&(o=2),o>3&&(o=3),!this.mesh)return!1;this.projectPolygon_(),d.computeInterior(this);const r=this.mesh;return e===i.BOUNDARY_CONTOURS?this.setWindingNumber_(r,1,!0):this.tessellateInterior_(r),r.check(),e===i.BOUNDARY_CONTOURS?this.outputContours_(r,o):this.outputPolymesh_(r,e,s,o),!0}}},function(t,e,i){t.exports=p;i(2);const s=i(7),o=i(5),n=i(4),r=i(1),m=i(0),h=i(17),c=i(10),l=i(19),a=i(3),_=i(8);p.TYPE="revolute-joint",p._super=_,p.prototype=o(p._super.prototype);const u={lowerAngle:0,upperAngle:359*r.PI/180,maxMotorTorque:1e4,motorSpeed:0,enableLimit:!1,enableMotor:!1,active:!0};function p(t,e,i,o){if(pc.markPhysics2dModuleAsUsed(),!(this instanceof p))return new p(t,e,i,o);t=s(t,u),_.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=p.TYPE,this.m_localAnchorA=o?e.getLocalPoint(o):t.localAnchorA||m.zero(),this.m_localAnchorB=o?i.getLocalPoint(o):t.localAnchorB||m.zero(),r.isFinite(t.referenceAngle)?(this.m_referenceAngle=t.referenceAngle,this.m_autoReferenceAngle=!1):(this.m_referenceAngle=i.getAngle()-e.getAngle(),this.m_autoReferenceAngle=!0),this.m_impulse=h(),this.m_motorImpulse=0,this.m_lowerAngle=t.lowerAngle,this.m_upperAngle=t.upperAngle,this.m_maxMotorTorque=t.maxMotorTorque,this.m_motorSpeed=t.motorSpeed,this.m_enableLimit=t.enableLimit,this.m_enableMotor=t.enableMotor,this.m_rA=null,this.m_rB=null,this.m_localCenterA=null,this.m_localCenterB=null,this.m_invMassA=0,this.m_invMassB=0,this.m_invIA=0,this.m_invIB=0,this.m_mass=new l,this.m_motorMass=0,this.m_limitState=0}p.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},p.prototype.setLocalAnchorA=function(t){return this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_localAnchorA=t},p.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},p.prototype.setLocalAnchorB=function(t){return this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_localAnchorB=t},p.prototype.getReferenceAngle=function(){return this.m_referenceAngle},p.prototype.getJointAngle=function(){const t=this.m_bodyA;return this.m_bodyB.m_sweep.a-t.m_sweep.a-this.m_referenceAngle},p.prototype.getJointSpeed=function(){const t=this.m_bodyA;return this.m_bodyB.m_angularVelocity-t.m_angularVelocity},p.prototype.isMotorEnabled=function(){return this.m_enableMotor},p.prototype.enableMotor=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableMotor=t},p.prototype.getMotorTorque=function(t){return t*this.m_motorImpulse},p.prototype.setMotorSpeed=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_motorSpeed=t},p.prototype.getMotorSpeed=function(){return this.m_motorSpeed},p.prototype.setMaxMotorTorque=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_maxMotorTorque=t},p.prototype.isLimitEnabled=function(){return this.m_enableLimit},p.prototype.enableLimit=function(t){t!==this.m_enableLimit&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableLimit=t,this.m_impulse.z=0)},p.prototype.getLowerLimit=function(){return this.m_lowerAngle},p.prototype.getUpperLimit=function(){return this.m_upperAngle},p.prototype.setLimits=function(t,e){t===this.m_lowerAngle&&e===this.m_upperAngle||(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_impulse.z=0,this.m_lowerAngle=t,this.m_upperAngle=e)},p.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},p.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},p.prototype.getReactionForce=function(t,e){return e?e.set(this.m_impulse.x,this.m_impulse.y).mul(t):m.neo(this.m_impulse.x,this.m_impulse.y).mul(t)},p.prototype.getReactionTorque=function(t){return t*this.m_impulse.z},p.prototype.setBodyA=function(t){p._super.prototype.setBodyA.call(this,t),this.m_autoReferenceAngle&&(this.m_referenceAngle=this.m_bodyB.getAngle()-this.m_bodyA.getAngle())},p.prototype.setBodyB=function(t){p._super.prototype.setBodyB.call(this,t),this.m_autoReferenceAngle&&(this.m_referenceAngle=this.m_bodyB.getAngle()-this.m_bodyA.getAngle())},p.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;const e=this.m_bodyA.c_position.a,i=this.m_bodyA.c_velocity.v;let s=this.m_bodyA.c_velocity.w;const o=this.m_bodyB.c_position.a,h=this.m_bodyB.c_velocity.v;let c=this.m_bodyB.c_velocity.w;const l=a.neo(e),_=a.neo(o);this.m_rA=a.mulVec2(l,m.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=a.mulVec2(_,m.sub(this.m_localAnchorB,this.m_localCenterB));const u=this.m_invMassA,p=this.m_invMassB,d=this.m_invIA,y=this.m_invIB,f=d+y===0;if(this.m_mass.ex.x=u+p+this.m_rA.y*this.m_rA.y*d+this.m_rB.y*this.m_rB.y*y,this.m_mass.ey.x=-this.m_rA.y*this.m_rA.x*d-this.m_rB.y*this.m_rB.x*y,this.m_mass.ez.x=-this.m_rA.y*d-this.m_rB.y*y,this.m_mass.ex.y=this.m_mass.ey.x,this.m_mass.ey.y=u+p+this.m_rA.x*this.m_rA.x*d+this.m_rB.x*this.m_rB.x*y,this.m_mass.ez.y=this.m_rA.x*d+this.m_rB.x*y,this.m_mass.ex.z=this.m_mass.ez.x,this.m_mass.ey.z=this.m_mass.ez.y,this.m_mass.ez.z=d+y,this.m_motorMass=d+y,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass),(!1===this.m_enableMotor||f)&&(this.m_motorImpulse=0),this.m_enableLimit&&!1===f){const t=o-e-this.m_referenceAngle;r.abs(this.m_upperAngle-this.m_lowerAngle)<2*n.angularSlop?this.m_limitState=3:t<=this.m_lowerAngle?(1!==this.m_limitState&&(this.m_impulse.z=0),this.m_limitState=1):t>=this.m_upperAngle?(2!==this.m_limitState&&(this.m_impulse.z=0),this.m_limitState=2):(this.m_limitState=0,this.m_impulse.z=0)}else this.m_limitState=0;if(t.warmStarting){this.m_impulse.mul(t.dtRatio),this.m_motorImpulse*=t.dtRatio;const e=m.neo(this.m_impulse.x,this.m_impulse.y);i.subMul(u,e),s-=d*(m.cross(this.m_rA,e)+this.m_motorImpulse+this.m_impulse.z),h.addMul(p,e),c+=y*(m.cross(this.m_rB,e)+this.m_motorImpulse+this.m_impulse.z)}else this.m_impulse.setZero(),this.m_motorImpulse=0;this.m_bodyA.c_velocity.v=i,this.m_bodyA.c_velocity.w=s,this.m_bodyB.c_velocity.v=h,this.m_bodyB.c_velocity.w=c},p.prototype.solveVelocityConstraints=function(t){const e=this.m_bodyA.c_velocity.v;let i=this.m_bodyA.c_velocity.w;const s=this.m_bodyB.c_velocity.v;let o=this.m_bodyB.c_velocity.w;const n=this.m_invMassA,c=this.m_invMassB,l=this.m_invIA,a=this.m_invIB,_=l+a===0;if(this.m_enableMotor&&3!==this.m_limitState&&!1===_){let e=o-i-this.m_motorSpeed,s=-this.m_motorMass*e;const n=this.m_motorImpulse,m=t.dt*this.m_maxMotorTorque;this.m_motorImpulse=r.clamp(this.m_motorImpulse+s,-m,m),s=this.m_motorImpulse-n,i-=l*s,o+=a*s}if(this.m_enableLimit&&0!=this.m_limitState&&0==_){const t=m.zero();t.addCombine(1,s,1,m.cross(o,this.m_rB)),t.subCombine(1,e,1,m.cross(i,this.m_rA));const r=o-i;let _=h(t.x,t.y,r),u=h.neg(this.m_mass.solve33(_));if(3==this.m_limitState)this.m_impulse.add(u);else if(1==this.m_limitState){if(this.m_impulse.z+u.z<0){let e=m.combine(-1,t,this.m_impulse.z,m.neo(this.m_mass.ez.x,this.m_mass.ez.y)),i=this.m_mass.solve22(e);u.x=i.x,u.y=i.y,u.z=-this.m_impulse.z,this.m_impulse.x+=i.x,this.m_impulse.y+=i.y,this.m_impulse.z=0}else this.m_impulse.add(u)}else if(2==this.m_limitState){if(this.m_impulse.z+u.z>0){let e=m.combine(-1,t,this.m_impulse.z,m.neo(this.m_mass.ez.x,this.m_mass.ez.y)),i=this.m_mass.solve22(e);u.x=i.x,u.y=i.y,u.z=-this.m_impulse.z,this.m_impulse.x+=i.x,this.m_impulse.y+=i.y,this.m_impulse.z=0}else this.m_impulse.add(u)}const p=m.neo(u.x,u.y);e.subMul(n,p),i-=l*(m.cross(this.m_rA,p)+u.z),s.addMul(c,p),o+=a*(m.cross(this.m_rB,p)+u.z)}else{let t=m.zero();t.addCombine(1,s,1,m.cross(o,this.m_rB)),t.subCombine(1,e,1,m.cross(i,this.m_rA));let r=this.m_mass.solve22(m.neg(t));this.m_impulse.x+=r.x,this.m_impulse.y+=r.y,e.subMul(n,r),i-=l*m.cross(this.m_rA,r),s.addMul(c,r),o+=a*m.cross(this.m_rB,r)}this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v=s,this.m_bodyB.c_velocity.w=o},p.prototype.solvePositionConstraints=function(t){const e=this.m_bodyA.c_position.c;let i=this.m_bodyA.c_position.a;const s=this.m_bodyB.c_position.c;let o=this.m_bodyB.c_position.a;const h=a.neo(i),l=a.neo(o);let _=0,u=0;const p=this.m_invIA+this.m_invIB==0;if(this.m_enableLimit&&0!=this.m_limitState&&0==p){const t=o-i-this.m_referenceAngle;let e=0;if(3==this.m_limitState){let i=r.clamp(t-this.m_lowerAngle,-n.maxAngularCorrection,n.maxAngularCorrection);e=-this.m_motorMass*i,_=r.abs(i)}else if(1==this.m_limitState){let i=t-this.m_lowerAngle;_=-i,i=r.clamp(i+n.angularSlop,-n.maxAngularCorrection,0),e=-this.m_motorMass*i}else if(2==this.m_limitState){let i=t-this.m_upperAngle;_=i,i=r.clamp(i-n.angularSlop,0,n.maxAngularCorrection),e=-this.m_motorMass*i}i-=this.m_invIA*e,o+=this.m_invIB*e}{h.set(i),l.set(o);const t=a.mulVec2(h,m.sub(this.m_localAnchorA,this.m_localCenterA)),n=a.mulVec2(l,m.sub(this.m_localAnchorB,this.m_localCenterB));let r=m.zero();r.addCombine(1,s,1,n),r.subCombine(1,e,1,t),u=r.length();const _=this.m_invMassA,p=this.m_invMassB,d=this.m_invIA,y=this.m_invIB,f=new c;f.ex.x=_+p+d*t.y*t.y+y*n.y*n.y,f.ex.y=-d*t.x*t.y-y*n.x*n.y,f.ey.x=f.ex.y,f.ey.y=_+p+d*t.x*t.x+y*n.x*n.x;const x=m.neg(f.solve(r));e.subMul(_,x),i-=d*m.cross(t,x),s.addMul(p,x),o+=y*m.cross(n,x)}return this.m_bodyA.c_position.c.set(e),this.m_bodyA.c_position.a=i,this.m_bodyB.c_position.c.set(s),this.m_bodyB.c_position.a=o,u<=n.linearSlop&&_<=n.angularSlop}},function(t,e,i){t.exports=p;i(2);const s=i(7),o=i(5),n=i(4),r=i(1),m=i(0),h=i(17),c=i(10),l=i(19),a=i(3),_=i(8);p.TYPE="prismatic-joint",p._super=_,p.prototype=o(p._super.prototype);const u={enableLimit:!1,lowerTranslation:0,upperTranslation:0,enableMotor:!1,maxMotorForce:1e4,motorSpeed:0,active:!0};function p(t,e,i,o,n){if(pc.markPhysics2dModuleAsUsed(),!(this instanceof p))return new p(t,e,i,o,n);t=s(t,u),_.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=p.TYPE,this.m_localAnchorA=o?e.getLocalPoint(o):t.localAnchorA||m.zero(),this.m_localAnchorB=o?i.getLocalPoint(o):t.localAnchorB||m.zero(),this.m_localXAxisA=n?e.getLocalVector(n):t.localAxisA||m.neo(1,0),this.m_localXAxisA.normalize(),this.m_localYAxisA=m.cross(1,this.m_localXAxisA),this.m_referenceAngle=r.isFinite(t.referenceAngle)?t.referenceAngle:i.getAngle()-e.getAngle(),this.m_impulse=h(),this.m_motorMass=0,this.m_motorImpulse=0,this.m_lowerTranslation=t.lowerTranslation,this.m_upperTranslation=t.upperTranslation,this.m_maxMotorForce=t.maxMotorForce,this.m_motorSpeed=t.motorSpeed,this.m_enableLimit=t.enableLimit,this.m_enableMotor=t.enableMotor,this.m_limitState=0,this.m_axis=m.zero(),this.m_perp=m.zero(),this.m_localCenterA,this.m_localCenterB,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_axis,this.m_perp,this.m_s1,this.m_s2,this.m_a1,this.m_a2,this.m_K=new l,this.m_motorMass}p.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},p.prototype.setLocalAnchorA=function(t){return this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_localAnchorA=t},p.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},p.prototype.setLocalAnchorB=function(t){return this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_localAnchorB=t},p.prototype.getLocalAxisA=function(){return this.m_localXAxisA},p.prototype.setLocalAxisA=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_localXAxisA.set(t),this.m_localYAxisA.set(-t.y,t.x)},p.prototype.getReferenceAngle=function(){return this.m_referenceAngle},p.prototype.setReferenceAngle=function(t){return this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_referenceAngle=t},p.prototype.getJointTranslation=function(){const t=this.m_bodyA.getWorldPoint(this.m_localAnchorA),e=this.m_bodyB.getWorldPoint(this.m_localAnchorB),i=m.sub(e,t),s=this.m_bodyA.getWorldVector(this.m_localXAxisA);return m.dot(i,s)},p.prototype.getJointSpeed=function(){const t=this.m_bodyA,e=this.m_bodyB,i=a.mulVec2(t.m_xf.q,m.sub(this.m_localAnchorA,t.m_sweep.localCenter)),s=a.mulVec2(e.m_xf.q,m.sub(this.m_localAnchorB,e.m_sweep.localCenter)),o=m.add(t.m_sweep.c,i),n=m.add(e.m_sweep.c,s),r=m.sub(n,o),h=a.mulVec2(t.m_xf.q,this.m_localXAxisA),c=t.m_linearVelocity,l=e.m_linearVelocity,_=t.m_angularVelocity,u=e.m_angularVelocity;return m.dot(r,m.cross(_,h))+m.dot(h,m.sub(m.addCross(l,u,s),m.addCross(c,_,i)))},p.prototype.isLimitEnabled=function(){return this.m_enableLimit},p.prototype.enableLimit=function(t){t!=this.m_enableLimit&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableLimit=t,this.m_impulse.z=0)},p.prototype.getLowerLimit=function(){return this.m_lowerTranslation},p.prototype.getUpperLimit=function(){return this.m_upperTranslation},p.prototype.setLimits=function(t,e){t==this.m_lowerTranslation&&e==this.m_upperTranslation||(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_lowerTranslation=t,this.m_upperTranslation=e,this.m_impulse.z=0)},p.prototype.isMotorEnabled=function(){return this.m_enableMotor},p.prototype.enableMotor=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableMotor=t},p.prototype.setMotorSpeed=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_motorSpeed=t},p.prototype.setMaxMotorForce=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_maxMotorForce=t},p.prototype.getMotorSpeed=function(){return this.m_motorSpeed},p.prototype.getMotorForce=function(t){return t*this.m_motorImpulse},p.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},p.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},p.prototype.getReactionForce=function(t,e){return(e=e||m.zero()).setCombine(this.m_impulse.x,this.m_perp,this.m_motorImpulse+this.m_impulse.z,this.m_axis).mul(t)},p.prototype.getReactionTorque=function(t){return t*this.m_impulse.y},p.prototype.getLimitState=function(){return this.m_limitState},p.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;const e=this.m_bodyA.c_position.c,i=this.m_bodyA.c_position.a,s=this.m_bodyA.c_velocity.v;let o=this.m_bodyA.c_velocity.w;const h=this.m_bodyB.c_position.c,c=this.m_bodyB.c_position.a,l=this.m_bodyB.c_velocity.v;let _=this.m_bodyB.c_velocity.w;const u=a.neo(i),p=a.neo(c),d=a.mulVec2(u,m.sub(this.m_localAnchorA,this.m_localCenterA)),y=a.mulVec2(p,m.sub(this.m_localAnchorB,this.m_localCenterB)),f=m.zero();f.addCombine(1,h,1,y),f.subCombine(1,e,1,d);const x=this.m_invMassA,g=this.m_invMassB,v=this.m_invIA,A=this.m_invIB;this.m_axis=a.mulVec2(u,this.m_localXAxisA),this.m_a1=m.cross(m.add(f,d),this.m_axis),this.m_a2=m.cross(y,this.m_axis),this.m_motorMass=x+g+v*this.m_a1*this.m_a1+A*this.m_a2*this.m_a2,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass);{this.m_perp=a.mulVec2(u,this.m_localYAxisA),this.m_s1=m.cross(m.add(f,d),this.m_perp),this.m_s2=m.cross(y,this.m_perp);const t=x+g+v*this.m_s1*this.m_s1+A*this.m_s2*this.m_s2,e=v*this.m_s1+A*this.m_s2,i=v*this.m_s1*this.m_a1+A*this.m_s2*this.m_a2;let s=v+A;0==s&&(s=1);const o=v*this.m_a1+A*this.m_a2,n=x+g+v*this.m_a1*this.m_a1+A*this.m_a2*this.m_a2;this.m_K.ex.set(t,e,i),this.m_K.ey.set(e,s,o),this.m_K.ez.set(i,o,n)}if(this.m_enableLimit){const t=m.dot(this.m_axis,f);r.abs(this.m_upperTranslation-this.m_lowerTranslation)<2*n.linearSlop?this.m_limitState=3:t<=this.m_lowerTranslation?1!=this.m_limitState&&(this.m_limitState=1,this.m_impulse.z=0):t>=this.m_upperTranslation?2!=this.m_limitState&&(this.m_limitState=2,this.m_impulse.z=0):(this.m_limitState=0,this.m_impulse.z=0)}else this.m_limitState=0,this.m_impulse.z=0;if(0==this.m_enableMotor&&(this.m_motorImpulse=0),t.warmStarting){this.m_impulse.mul(t.dtRatio),this.m_motorImpulse*=t.dtRatio;const e=m.combine(this.m_impulse.x,this.m_perp,this.m_motorImpulse+this.m_impulse.z,this.m_axis),i=this.m_impulse.x*this.m_s1+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a1,n=this.m_impulse.x*this.m_s2+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a2;s.subMul(x,e),o-=v*i,l.addMul(g,e),_+=A*n}else this.m_impulse.setZero(),this.m_motorImpulse=0;this.m_bodyA.c_velocity.v.set(s),this.m_bodyA.c_velocity.w=o,this.m_bodyB.c_velocity.v.set(l),this.m_bodyB.c_velocity.w=_},p.prototype.solveVelocityConstraints=function(t){const e=this.m_bodyA.c_velocity.v;let i=this.m_bodyA.c_velocity.w;const s=this.m_bodyB.c_velocity.v;let o=this.m_bodyB.c_velocity.w;const n=this.m_invMassA,c=this.m_invMassB,l=this.m_invIA,a=this.m_invIB;if(this.m_enableMotor&&3!=this.m_limitState){let h=m.dot(this.m_axis,m.sub(s,e))+this.m_a2*o-this.m_a1*i,_=this.m_motorMass*(this.m_motorSpeed-h);const u=this.m_motorImpulse,p=t.dt*this.m_maxMotorForce;this.m_motorImpulse=r.clamp(this.m_motorImpulse+_,-p,p),_=this.m_motorImpulse-u;let d=m.mul(_,this.m_axis),y=_*this.m_a1,f=_*this.m_a2;e.subMul(n,d),i-=l*y,s.addMul(c,d),o+=a*f}const _=m.zero();if(_.x+=m.dot(this.m_perp,s)+this.m_s2*o,_.x-=m.dot(this.m_perp,e)+this.m_s1*i,_.y=o-i,this.m_enableLimit&&0!=this.m_limitState){let t=0;t+=m.dot(this.m_axis,s)+this.m_a2*o,t-=m.dot(this.m_axis,e)+this.m_a1*i;let u=h(_.x,_.y,t);const p=h(this.m_impulse);let d=this.m_K.solve33(h.neg(u));this.m_impulse.add(d),1==this.m_limitState?this.m_impulse.z=r.max(this.m_impulse.z,0):2==this.m_limitState&&(this.m_impulse.z=r.min(this.m_impulse.z,0));const y=m.combine(-1,_,-(this.m_impulse.z-p.z),m.neo(this.m_K.ez.x,this.m_K.ez.y)),f=m.add(this.m_K.solve22(y),m.neo(p.x,p.y));this.m_impulse.x=f.x,this.m_impulse.y=f.y,d=h.sub(this.m_impulse,p);let x=m.combine(d.x,this.m_perp,d.z,this.m_axis),g=d.x*this.m_s1+d.y+d.z*this.m_a1,v=d.x*this.m_s2+d.y+d.z*this.m_a2;e.subMul(n,x),i-=l*g,s.addMul(c,x),o+=a*v}else{let t=this.m_K.solve22(m.neg(_));this.m_impulse.x+=t.x,this.m_impulse.y+=t.y;let r=m.mul(t.x,this.m_perp),h=t.x*this.m_s1+t.y,u=t.x*this.m_s2+t.y;e.subMul(n,r),i-=l*h,s.addMul(c,r),o+=a*u}this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v=s,this.m_bodyB.c_velocity.w=o},p.prototype.solvePositionConstraints=function(t){const e=this.m_bodyA.c_position.c;let i=this.m_bodyA.c_position.a;const s=this.m_bodyB.c_position.c;let o=this.m_bodyB.c_position.a;const _=a.neo(i),u=a.neo(o),p=this.m_invMassA,d=this.m_invMassB,y=this.m_invIA,f=this.m_invIB,x=a.mulVec2(_,m.sub(this.m_localAnchorA,this.m_localCenterA)),g=a.mulVec2(u,m.sub(this.m_localAnchorB,this.m_localCenterB)),v=m.sub(m.add(s,g),m.add(e,x)),A=a.mulVec2(_,this.m_localXAxisA),b=m.cross(m.add(v,x),A),B=m.cross(g,A),w=a.mulVec2(_,this.m_localYAxisA),C=m.cross(m.add(v,x),w),I=m.cross(g,w);let M=h();const S=m.zero();S.x=m.dot(w,v),S.y=o-i-this.m_referenceAngle;let L=r.abs(S.x);const P=r.abs(S.y),V=n.linearSlop,z=n.maxLinearCorrection;let k=!1,O=0;if(this.m_enableLimit){const t=m.dot(A,v);r.abs(this.m_upperTranslation-this.m_lowerTranslation)<2*V?(O=r.clamp(t,-z,z),L=r.max(L,r.abs(t)),k=!0):t<=this.m_lowerTranslation?(O=r.clamp(t-this.m_lowerTranslation+V,-z,0),L=r.max(L,this.m_lowerTranslation-t),k=!0):t>=this.m_upperTranslation&&(O=r.clamp(t-this.m_upperTranslation-V,0,z),L=r.max(L,t-this.m_upperTranslation),k=!0)}if(k){let t=p+d+y*C*C+f*I*I,e=y*C+f*I;const i=y*C*b+f*I*B;let s=y+f;0==s&&(s=1);const o=y*b+f*B,n=p+d+y*b*b+f*B*B;let r=new l;r.ex.set(t,e,i),r.ey.set(e,s,o),r.ez.set(i,o,n);const m=h();m.x=S.x,m.y=S.y,m.z=O,M=r.solve33(h.neg(m))}else{let t=p+d+y*C*C+f*I*I,e=y*C+f*I,i=y+f;0==i&&(i=1);let s=new c;s.ex.set(t,e),s.ey.set(e,i);const o=s.solve(m.neg(S));M.x=o.x,M.y=o.y,M.z=0}const T=m.combine(M.x,w,M.z,A),q=M.x*C+M.y+M.z*b,E=M.x*I+M.y+M.z*B;return e.subMul(p,T),i-=y*q,s.addMul(d,T),o+=f*E,this.m_bodyA.c_position.c=e,this.m_bodyA.c_position.a=i,this.m_bodyB.c_position.c=s,this.m_bodyB.c_position.a=o,L<=n.linearSlop&&P<=n.angularSlop}},function(t,e,i){e.internal={},e.Math=i(1),e.Vec2=i(0),e.Vec3=i(17),e.Mat22=i(10),e.Mat33=i(19),e.Transform=i(6),e.Rot=i(3),e.AABB=i(12),e.Shape=i(13),e.Fixture=i(28),e.Body=i(23),e.Contact=i(9),e.Joint=i(8),e.World=i(37),e.Circle=i(15),e.Edge=i(18),e.Capsule=i(20),e.Polygon=i(16),i(31),e.CompositePolygon=i(21),e.Chain=i(27),e.Box=i(26),i(42),i(43),e.internal.CollidePolygons=i(44),i(45),i(46),e.DistanceJoint=i(47),e.FrictionJoint=i(48),e.GearJoint=i(49),e.MotorJoint=i(50),e.MouseJoint=i(51),e.PrismaticJoint=i(33),e.PulleyJoint=i(52),e.RevoluteJoint=i(32),e.RopeJoint=i(53),e.WeldJoint=i(54),e.WheelJoint=i(55),e.internal.Sweep=i(24),e.internal.stats=i(22),e.internal.Manifold=i(11),e.internal.Distance=i(14),e.internal.TimeOfImpact=i(25),e.internal.ShapeCaster=i(30),e.internal.DynamicTree=i(29),e.internal.Settings=i(4)},function(t,e,i){t.exports=function(){this.v=s.zero(),this.w=0};const s=i(0)},function(t,e,i){t.exports=n;const s=i(0),o=i(3);function n(){this.c=s.zero(),this.a=0}n.prototype.getTransform=function(t,e){return t.q.set(this.a),t.p.set(s.sub(this.c,o.mulVec2(t.q,e))),t}},function(t,e,i){t.exports=w;const s=i(7),o=(i(2),i(0)),n=i(6),r=i(38),m=i(30),h=i(41),c=i(23),l=i(9),a=i(12),_=i(14),u=i(15),p=i(26);let d,y,f,x,g,v,A,b;const B={gravity:o.zero(),allowSleep:!0,warmStarting:!0,continuousPhysics:!0,subStepping:!1,blockSolve:!0,velocityIterations:8,positionIterations:3};function w(t){if(!(this instanceof w))return new w(t);t&&o.isValid(t)&&(t={gravity:t}),t=s(t,B),this.m_solver=new h(this),this.m_broadPhase=new r,this.m_contactList=null,this.m_contactCount=0,this.m_bodyList=null,this.m_bodyCount=0,this.m_jointList=null,this.m_jointCount=0,this.m_stepComplete=!0,this.m_allowSleep=t.allowSleep,this.m_gravity=o.clone(t.gravity),this.m_clearForces=!0,this.m_newFixture=!1,this.m_locked=!1,this.m_warmStarting=t.warmStarting,this.m_continuousPhysics=t.continuousPhysics,this.m_subStepping=t.subStepping,this.m_blockSolve=t.blockSolve,this.m_velocityIterations=t.velocityIterations,this.m_positionIterations=t.positionIterations,this.m_t=0,this.m_stepCount=0,this.addPair=this.createContact.bind(this),this.collision_matrix=new Uint32Array(32)}w.prototype.getBodyList=function(){return this.m_bodyList},w.prototype.getJointList=function(){return this.m_jointList},w.prototype.getContactList=function(){return this.m_contactList},w.prototype.getBodyCount=function(){return this.m_bodyCount},w.prototype.getJointCount=function(){return this.m_jointCount},w.prototype.getContactCount=function(){return this.m_contactCount},w.prototype.setGravity=function(t){this.m_gravity=t},w.prototype.getGravity=function(){return this.m_gravity},w.prototype.isLocked=function(){return this.m_locked},w.prototype.setAllowSleeping=function(t){if(t!=this.m_allowSleep&&(this.m_allowSleep=t,0==this.m_allowSleep))for(let t=this.m_bodyList;t;t=t.m_next)t.setAwake(!0)},w.prototype.getAllowSleeping=function(){return this.m_allowSleep},w.prototype.setWarmStarting=function(t){this.m_warmStarting=t},w.prototype.getWarmStarting=function(){return this.m_warmStarting},w.prototype.setContinuousPhysics=function(t){this.m_continuousPhysics=t},w.prototype.getContinuousPhysics=function(){return this.m_continuousPhysics},w.prototype.setSubStepping=function(t){this.m_subStepping=t},w.prototype.getSubStepping=function(){return this.m_subStepping},w.prototype.setAutoClearForces=function(t){this.m_clearForces=t},w.prototype.getAutoClearForces=function(){return this.m_clearForces},w.prototype.getVelocityIterations=function(){return this.m_velocityIterations},w.prototype.setVelocityIterations=function(t){this.m_velocityIterations=t},w.prototype.getPositionIterations=function(){return this.m_positionIterations},w.prototype.setPositionIterations=function(t){this.m_positionIterations=t},w.prototype.clearForces=function(){for(let t=this.m_bodyList;t;t=t.getNext())t.m_force.setZero(),t.m_torque=0},w.prototype.queryAABB=function(t,e){g=e,this.m_broadPhase.query(t,this._queryAABBCallback),g=null},w.prototype._queryAABBCallback=function(t,e){return g(e.fixture,e)},w.prototype.queryCircle=function(t,e,i){f=f||new u,f.setRadius(e),y=y||new n,y.p.set(t),d=d||new a,f.computeAABB(d,y),A={},v=i,this.queryAABB(d,this._queryCircleCallback),A=v=null},w.prototype._queryCircleCallback=function(t,e){const i=t.m_proxies[0].proxyId;return!(!A[i]&&_.testOverlap(f,0,t.m_shape,e.childIndex,y,t.m_body.getTransform()))||(A[i]=!0,v(t))},w.prototype.circleCast=function(t,e,i,s,o){b=b||new m(this),b.castCircle(t,e,i,s,o)},w.prototype.queryBox=function(t,e,i,s){x=x||new p,x.setSize(e.x,e.y),x.setAngle(i),y=y||new n,y.p.set(t),d=d||new a,x.computeAABB(d,y),A={},v=s,this.queryAABB(d,this._queryBoxCallback),A=v=null},w.prototype._queryBoxCallback=function(t,e){const i=t.m_proxies[0].proxyId;return!(!A[i]&&_.testOverlap(x,0,t.m_shape,e.childIndex,y,t.m_body.getTransform()))||(A[i]=!0,v(t))},w.prototype.boxCast=function(t,e,i,s,o,n,r){b=b||new m(this),b.castBox(t,e,i,s,o,n,r)},w.prototype.capsuleCast=function(t,e,i,s,o,n,r,h){b=b||new m(this),b.castCapsule(t,e,i,s,o,n,r,h)},w.prototype.rayCast=function(t,e,i){v=i,this.m_broadPhase.rayCast(null,this._raycastCallback,t,e,1),v=null},w.prototype._raycastCallback=function(t,e,i){const s=i.fixture,o=i.childIndex,n={};if(s.rayCast(n,t,o)&&n.fraction>=0&&n.fraction<=t.maxFraction){const e=n.fraction,i=t.p1.mul(1-e).add(t.p2.mul(e));return Math.min(v(s,i,n.normal,e),t.maxFraction)}return t.maxFraction},w.prototype.getDistance=function(t,e){const i=t.getShape(),s=e.getShape(),o=t.getBody().getTransform(),n=e.getBody().getTransform(),r=t.getProxyCount(),m=e.getProxyCount(),h=new _.getInput,c=new _.getCache,l=new _.getOutput,a=new _.Output;let u=1/0;const p=a.pointA,d=a.pointB;for(let t=0;t<r;++t)for(let e=0;e<m;++e)c.clear(),l.clear(),h.clear(),h.proxyA.set(i,t),h.proxyB.set(s,e),h.transformA=o,h.transformB=n,h.useRadii=!0,h.overlap=!0,_(l,c,h),l.distance<u&&(u=l.distance,p.set(l.pointA),d.set(l.pointB));return u==1/0?null:(a.distance=u,a)},w.prototype.getProxyCount=function(){return this.m_broadPhase.getProxyCount()},w.prototype.getTreeHeight=function(){return this.m_broadPhase.getTreeHeight()},w.prototype.getTreeBalance=function(){return this.m_broadPhase.getTreeBalance()},w.prototype.getTreeQuality=function(){return this.m_broadPhase.getTreeQuality()},w.prototype.shiftOrigin=function(t){if(!this.m_locked){for(let e=this.m_bodyList;e;e=e.m_next)e.m_xf.p.sub(t),e.m_sweep.c0.sub(t),e.m_sweep.c.sub(t);for(let e=this.m_jointList;e;e=e.m_next)e.shiftOrigin(t);this.m_broadPhase.shiftOrigin(t)}},w.prototype.createBody=function(t,e){if(pc.markPhysics2dModuleAsUsed(),this.isLocked())return null;t&&o.isValid(t)&&(t={position:t,angle:e});const i=new c(this,t);return i.m_prev=null,i.m_next=this.m_bodyList,this.m_bodyList&&(this.m_bodyList.m_prev=i),this.m_bodyList=i,++this.m_bodyCount,i},w.prototype.createDynamicBody=function(t,e){return t?o.isValid(t)&&(t={position:t,angle:e}):t={},t.type="dynamic",this.createBody(t)},w.prototype.createKinematicBody=function(t,e){return t?o.isValid(t)&&(t={position:t,angle:e}):t={},t.type="kinematic",this.createBody(t)},w.prototype.destroyBody=function(t){if(pc.markPhysics2dModuleAsUsed(),this.isLocked())return;if(t.m_destroyed)return!1;let e=t.m_jointList;for(;e;){const i=e;e=e.next,this.publish("remove-joint",i.joint),this.destroyJoint(i.joint),t.m_jointList=e}t.m_jointList=null;let i=t.m_contactList;for(;i;){const e=i;i=i.next,this.destroyContact(e.contact),t.m_contactList=i}t.m_contactList=null;let s=t.m_fixtureList;for(;s;){const e=s;s=s.m_next,this.publish("remove-fixture",e),e.destroyProxies(this.m_broadPhase),t.m_fixtureList=s}return t.m_fixtureList=null,t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_bodyList&&(this.m_bodyList=t.m_next),t.m_destroyed=!0,--this.m_bodyCount,this.publish("remove-body",t),!0},w.prototype.createJoint=function(t){return this.isLocked()?null:(t.m_prev=null,t.m_next=this.m_jointList,this.m_jointList&&(this.m_jointList.m_prev=t),this.m_jointList=t,++this.m_jointCount,t.connectBodyA(),t.connectBodyB(),t.refilter(),t)},w.prototype.destroyJoint=function(t){this.isLocked()||(t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_jointList&&(this.m_jointList=t.m_next),t.disconnectBodyA(),t.disconnectBodyB(),--this.m_jointCount,t.refilter(),this.publish("remove-joint",t))};const C=new h.TimeStep;w.prototype.step=function(t,e,i){if((0|e)!==e&&(e=0),e=e||this.m_velocityIterations,i=i||this.m_positionIterations,this.m_stepCount++,this.m_newFixture&&(this.findNewContacts(),this.m_newFixture=!1),this.m_locked=!0,C.reset(t),C.velocityIterations=e,C.positionIterations=i,C.warmStarting=this.m_warmStarting,C.blockSolve=this.m_blockSolve,this.updateContacts(),this.m_stepComplete&&t>0){this.m_solver.solveWorld(C);for(let t=this.m_bodyList;t;t=t.getNext())0!=t.m_islandFlag&&(t.isStatic()||t.synchronizeFixtures());this.findNewContacts()}this.m_continuousPhysics&&t>0&&this.m_solver.solveWorldTOI(C),this.m_clearForces&&this.clearForces(),this.m_locked=!1},w.prototype.getLastTimeStep=function(){return C.dt},w.prototype.findNewContacts=function(){this.m_broadPhase.updatePairs(this.addPair)},w.prototype.createContact=function(t,e){const i=t.fixture,s=e.fixture,o=t.childIndex,n=e.childIndex,r=i.getBody(),m=s.getBody();if(r==m)return;let h=m.getContactList();for(;h;){if(h.other==r){const t=h.contact.getFixtureA(),e=h.contact.getFixtureB(),r=h.contact.getChildIndexA(),m=h.contact.getChildIndexB();if(t==i&&e==s&&r==o&&m==n)return;if(t==s&&e==i&&r==n&&m==o)return}h=h.next}if(0==m.shouldCollide(r))return;if(0==s.shouldCollide(i))return;const c=l.create(i,o,s,n);null!=c&&(c.m_prev=null,null!=this.m_contactList&&(c.m_next=this.m_contactList,this.m_contactList.m_prev=c),this.m_contactList=c,++this.m_contactCount)},w.prototype.updateContacts=function(){let t,e=this.m_contactList;for(;t=e;){e=t.getNext();const i=t.getFixtureA();if(!i.isActive()){this.destroyContact(t);continue}const s=t.getFixtureB();if(!s.isActive()){this.destroyContact(t);continue}const o=i.getBody();if(!o.isActive()){this.destroyContact(t);continue}const n=s.getBody();if(!n.isActive()){this.destroyContact(t);continue}const r=t.getChildIndexA(),m=t.getChildIndexB();if(t.m_filterFlag){if(r>=i.m_proxies.length){this.destroyContact(t);continue}if(m>=s.m_proxies.length){this.destroyContact(t);continue}if(0==n.shouldCollide(o)){this.destroyContact(t);continue}if(0==s.shouldCollide(i)){this.destroyContact(t);continue}t.m_filterFlag=!1}if(0==!o.isStatic()&&0==!n.isStatic())continue;const h=i.m_proxies[r].proxyId,c=s.m_proxies[m].proxyId;0!=this.m_broadPhase.testOverlap(h,c)?o.isKinematic()||n.isKinematic()?(o.isAwake()||o.setAwake(!0),n.isAwake()||n.setAwake(!0),t.update(this)):(o.isAwake()||n.isAwake())&&t.update(this):this.destroyContact(t)}},w.prototype.destroyContact=function(t){l.destroy(t,this),t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_contactList&&(this.m_contactList=t.m_next),--this.m_contactCount},w.prototype._listeners=null,w.prototype.on=function(t,e){return"string"!=typeof t||"function"!=typeof e||(this._listeners||(this._listeners={}),this._listeners[t]||(this._listeners[t]=[]),this._listeners[t].push(e)),this},w.prototype.off=function(t,e){if("string"!=typeof t||"function"!=typeof e)return this;const i=this._listeners&&this._listeners[t];if(!i||!i.length)return this;const s=i.indexOf(e);return s>=0&&i.splice(s,1),this},w.prototype.publish=function(t,e,i,s){const o=this._listeners&&this._listeners[t];if(!o||!o.length)return 0;for(let t=0;t<o.length;t++)o[t].call(this,e,i,s);return o.length},w.prototype.beginContact=function(t){this.publish("begin-contact",t)},w.prototype.endContact=function(t){this.publish("end-contact",t)},w.prototype.preSolve=function(t,e){this.publish("pre-solve",t,e)},w.prototype.postSolve=function(t,e){this.publish("post-solve",t,e)}},function(t,e,i){i(2);const s=i(1),o=i(12),n=i(29);function r(){this.m_tree=new n,this.m_proxyCount=0,this.m_moveBuffer=[],this.queryCallback=this.queryCallback.bind(this)}t.exports=r,r.prototype.getUserData=function(t){return this.m_tree.getUserData(t)},r.prototype.testOverlap=function(t,e){const i=this.m_tree.getFatAABB(t),s=this.m_tree.getFatAABB(e);return o.testOverlap(i,s)},r.prototype.getFatAABB=function(t){return this.m_tree.getFatAABB(t)},r.prototype.getProxyCount=function(){return this.m_proxyCount},r.prototype.getTreeHeight=function(){return this.m_tree.getHeight()},r.prototype.getTreeBalance=function(){return this.m_tree.getMaxBalance()},r.prototype.getTreeQuality=function(){return this.m_tree.getAreaRatio()},r.prototype.query=function(t,e){this.m_tree.query(t,e)},r.prototype.rayCast=function(t,e,i,s,o){this.m_tree.rayCast(t,e,i,s,o)},r.prototype.shiftOrigin=function(t){this.m_tree.shiftOrigin(t)},r.prototype.createProxy=function(t,e){const i=this.m_tree.createProxy(t,e);return this.m_proxyCount++,this.bufferMove(i),i},r.prototype.destroyProxy=function(t){this.unbufferMove(t),this.m_proxyCount--,this.m_tree.destroyProxy(t)},r.prototype.moveProxy=function(t,e,i){this.m_tree.moveProxy(t,e,i)&&this.bufferMove(t)},r.prototype.touchProxy=function(t){this.bufferMove(t)},r.prototype.bufferMove=function(t){this.m_moveBuffer.push(t)},r.prototype.unbufferMove=function(t){for(let e=0;e<this.m_moveBuffer.length;++e)this.m_moveBuffer[e]==t&&(this.m_moveBuffer[e]=null)},r.prototype.updatePairs=function(t){for(this.m_callback=t;this.m_moveBuffer.length>0;){if(this.m_queryProxyId=this.m_moveBuffer.pop(),null===this.m_queryProxyId)continue;const t=this.m_tree.getFatAABB(this.m_queryProxyId);this.m_tree.query(t,this.queryCallback)}},r.prototype.queryCallback=function(t){if(t==this.m_queryProxyId)return!0;const e=s.min(t,this.m_queryProxyId),i=s.max(t,this.m_queryProxyId),o=this.m_tree.getUserData(e),n=this.m_tree.getUserData(i);return this.m_callback(o,n),!0}},function(t,e){t.exports=function(t){const e=[];let i=t.max||1/0;const s=t.create,o=t.allocate,n=t.release,r=t.discard;let m=0,h=0,c=0,l=0;this.max=function(t){return"number"==typeof t?(i=t,this):i},this.size=function(){return e.length},this.allocate=function(){let t;return e.length>0?t=e.shift():(m++,t="function"==typeof s?s():{}),h++,"function"==typeof o&&o(t),t},this.release=function(t){e.length<i?(c++,"function"==typeof n&&n(t),e.push(t)):(l++,"function"==typeof r&&(t=r(t)))},this.toString=function(){return" +"+m+" >"+h+" <"+c+" -"+l+" ="+e.length+"/"+i}}},function(t,e){t.exports.now=function(){return Date.now()},t.exports.diff=function(t){return Date.now()-t}},function(t,e,i){t.exports=_,t.exports.TimeStep=a;const s=i(4),o=i(2),n=i(0),r=i(1),m=(i(23),i(9),i(8),i(25)),h=m.Input,c=m.Output,l=i(14);l.Input,l.Output,l.Cache;function a(t){this.dt=0,this.inv_dt=0,this.velocityIterations=0,this.positionIterations=0,this.warmStarting=!1,this.blockSolve=!0,this.inv_dt0=0,this.dtRatio=1}function _(t){this.m_world=t,this.m_stack=[],this.m_bodies=[],this.m_contacts=[],this.m_joints=[]}a.prototype.reset=function(t){this.dt>0&&(this.inv_dt0=this.inv_dt),this.dt=t,this.inv_dt=0==t?0:1/t,this.dtRatio=t*this.inv_dt0},_.prototype.clear=function(){this.m_stack.length=0,this.m_bodies.length=0,this.m_contacts.length=0,this.m_joints.length=0},_.prototype.addBody=function(t){this.m_bodies.push(t)},_.prototype.addContact=function(t){this.m_contacts.push(t)},_.prototype.addJoint=function(t){this.m_joints.push(t)},_.prototype.solveWorld=function(t){const e=this.m_world;for(let t=e.m_bodyList;t;t=t.m_next)t.m_islandFlag=!1;for(let t=e.m_contactList;t;t=t.m_next)t.m_islandFlag=!1;for(let t=e.m_jointList;t;t=t.m_next)t.m_islandFlag=!1;const i=this.m_stack;for(let s=e.m_bodyList;s;s=s.m_next)if(!s.m_islandFlag&&0!=s.isAwake()&&0!=s.isActive()&&!s.isStatic()){for(this.clear(),i.push(s),s.m_islandFlag=!0;i.length>0;){let t=i.pop();if(this.addBody(t),t.setAwake(!0),!t.isStatic()){for(let e=t.m_contactList;e;e=e.next){const t=e.contact;if(t.m_islandFlag)continue;if(0==t.isEnabled()||0==t.isTouching())continue;const s=t.m_fixtureA,o=t.m_fixtureB;if(!s.isActive()||!o.isActive())continue;const n=s.m_isSensor,r=o.m_isSensor;if(n||r)continue;this.addContact(t),t.m_islandFlag=!0;let m=e.other;m.m_islandFlag||(i.push(m),m.m_islandFlag=!0)}for(let e=t.m_jointList;e;e=e.next){if(1==e.joint.m_islandFlag||0==e.joint.m_activeFlag)continue;let t=e.other;0!=t.isActive()&&(this.addJoint(e.joint),e.joint.m_islandFlag=!0,t.m_islandFlag||(i.push(t),t.m_islandFlag=!0))}}}this.solveIsland(t);for(let t=0;t<this.m_bodies.length;++t){let e=this.m_bodies[t];e.isStatic()&&(e.m_islandFlag=!1)}}},_.prototype.solveIsland=function(t){const e=this.m_world,i=e.m_gravity,o=e.m_allowSleep,m=t.dt;for(let t=0;t<this.m_bodies.length;++t){let e=this.m_bodies[t],s=n.clone(e.m_sweep.c),o=e.m_sweep.a,r=n.clone(e.m_linearVelocity),h=e.m_angularVelocity;e.m_sweep.c1.set(e.m_sweep.c),e.m_sweep.c0.set(e.m_sweep.c),e.m_sweep.a0=e.m_sweep.a,e.isDynamic()&&(r.addMul(m*e.m_gravityScale,i),r.addMul(m*e.m_invMass,e.m_force),h+=m*e.m_invI*e.m_torque,r.mul(1/(1+m*e.m_linearDamping)),h*=1/(1+m*e.m_angularDamping)),e.c_position.c=s,e.c_position.a=o,e.c_velocity.v=r,e.c_velocity.w=h}for(let e=0;e<this.m_contacts.length;++e){this.m_contacts[e].initConstraint(t)}for(let e=0;e<this.m_contacts.length;++e){this.m_contacts[e].initVelocityConstraint(t)}if(t.warmStarting)for(let e=0;e<this.m_contacts.length;++e){this.m_contacts[e].warmStartConstraint(t)}for(let e=0;e<this.m_joints.length;++e){this.m_joints[e].initVelocityConstraints(t)}for(let e=0;e<t.velocityIterations;++e){for(let e=0;e<this.m_joints.length;++e){this.m_joints[e].solveVelocityConstraints(t)}for(let e=0;e<this.m_contacts.length;++e){this.m_contacts[e].solveVelocityConstraint(t)}}for(let e=0;e<this.m_contacts.length;++e){this.m_contacts[e].storeConstraintImpulses(t)}for(let t=0;t<this.m_bodies.length;++t){let e=this.m_bodies[t],i=n.clone(e.c_position.c),o=e.c_position.a,h=n.clone(e.c_velocity.v),c=e.c_velocity.w;const l=n.mul(m,h);if(n.lengthSquared(l)>s.maxTranslationSquared){let t=s.maxTranslation/l.length();h.mul(t)}const a=m*c;if(a*a>s.maxRotationSquared){c*=s.maxRotation/r.abs(a)}i.addMul(m,h),o+=m*c,e.c_position.c.set(i),e.c_position.a=o,e.c_velocity.v.set(h),e.c_velocity.w=c}let h=!1;for(let e=0;e<t.positionIterations;++e){let e=0;for(let i=0;i<this.m_contacts.length;++i){const s=this.m_contacts[i].solvePositionConstraint(t);e=r.min(e,s)}const i=e>=-3*s.linearSlop;let o=!0;for(let e=0;e<this.m_joints.length;++e){const i=this.m_joints[e].solvePositionConstraints(t);o=o&&i}if(i&&o){h=!0;break}}for(let t=0;t<this.m_bodies.length;++t){let e=this.m_bodies[t];const i=e.c_position.c,s=e.m_sweep.c,o=e.m_sweep.c0,n=e.m_sweep.c1,r=e.c_velocity.v,m=e.m_linearVelocity;e.m_fixedXFlag?(o.x=s.x=n.x,m.x=0):(s.x=i.x,m.x=r.x),e.m_fixedYFlag?(o.y=s.y=n.y,m.y=0):(s.y=i.y,m.y=r.y),e.m_sweep.a=e.c_position.a,e.m_angularVelocity=e.c_velocity.w,e.synchronizeTransform()}if(this.postSolveIsland(),o){let t=1/0;const e=s.linearSleepToleranceSqr,i=s.angularSleepToleranceSqr;for(let s=0;s<this.m_bodies.length;++s){let o=this.m_bodies[s];o.isStatic()||(0==o.m_autoSleepFlag||o.m_angularVelocity*o.m_angularVelocity>i||n.lengthSquared(o.m_linearVelocity)>e?(o.m_sleepTime=0,t=0):(o.m_sleepTime+=m,t=r.min(t,o.m_sleepTime)))}if(t>=s.timeToSleep&&h)for(let t=0;t<this.m_bodies.length;++t){this.m_bodies[t].setAwake(!1)}}},_.prototype.printBodies=function(t){for(let e=0;e<this.m_bodies.length;++e){const i=this.m_bodies[e];o.debug(t,i.c_position.a,i.c_position.c.x,i.c_position.c.y,i.c_velocity.w,i.c_velocity.v.x,i.c_velocity.v.y)}};const u=new a;function p(){this.normalImpulses=[],this.tangentImpulses=[]}_.prototype.solveWorldTOI=function(t){const e=this.m_world;if(e.m_stepComplete){for(let t=e.m_bodyList;t;t=t.m_next)t.m_islandFlag=!1,t.m_sweep.alpha0=0;for(let t=e.m_contactList;t;t=t.m_next)t.m_toiFlag=!1,t.m_islandFlag=!1,t.m_toiCount=0,t.m_toi=1}for(;;){let i=null,o=1;for(let t=e.m_contactList;t;t=t.m_next){if(0==t.isEnabled())continue;if(t.m_toiCount>s.maxSubSteps)continue;let e=1;if(t.m_toiFlag)e=t.m_toi;else{let i=t.getFixtureA(),s=t.getFixtureB();if(!i.isActive()||!s.isActive())continue;if(i.isSensor()||s.isSensor())continue;let o=i.getBody(),n=s.getBody();const l=o.isAwake()&&!o.isStatic(),a=n.isAwake()&&!n.isStatic();if(0==l&&0==a)continue;const _=o.isBullet()||!o.isDynamic()||o.m_fixedXFlag||o.m_fixedYFlag,u=n.isBullet()||!n.isDynamic()||n.m_fixedXFlag||n.m_fixedYFlag;if(0==_&&0==u)continue;let p=o.m_sweep.alpha0;o.m_sweep.alpha0<n.m_sweep.alpha0?(p=n.m_sweep.alpha0,o.m_sweep.advance(p)):n.m_sweep.alpha0<o.m_sweep.alpha0&&(p=o.m_sweep.alpha0,n.m_sweep.advance(p));const d=t.getChildIndexA(),y=t.getChildIndexB(),f=new h;f.proxyA.set(i.getShape(),d),f.proxyB.set(s.getShape(),y),f.sweepA.set(o.m_sweep),f.sweepB.set(n.m_sweep),f.tMax=1;const x=new c;m(x,f);const g=x.t;e=x.state==c.e_touching?r.min(p+(1-p)*g,1):1,t.m_toi=e,t.m_toiFlag=!0}e<o&&(i=t,o=e)}if(null==i||1-10*r.EPSILON<o){e.m_stepComplete=!0;break}let n=i.getFixtureA(),l=i.getFixtureB(),a=n.getBody(),_=l.getBody();const p=a.m_sweep.clone(),d=_.m_sweep.clone();if(a.advance(o),_.advance(o),i.update(e),i.m_toiFlag=!1,++i.m_toiCount,0==i.isEnabled()||0==i.isTouching()){i.setEnabled(!1),a.m_sweep.set(p),_.m_sweep.set(d),a.synchronizeTransform(),_.synchronizeTransform();continue}a.setAwake(!0),_.setAwake(!0),this.clear(),this.addBody(a),this.addBody(_),this.addContact(i),a.m_islandFlag=!0,_.m_islandFlag=!0,i.m_islandFlag=!0;const y=[a,_];for(let t=0;t<y.length;++t){let i=y[t];if(i.isDynamic())for(let t=i.m_contactList;t;t=t.next){const s=t.contact;if(s.m_islandFlag)continue;const n=t.other;if(n.isDynamic()&&!i.isBullet()&&!n.isBullet())continue;const r=s.m_fixtureA.m_isSensor,m=s.m_fixtureB.m_isSensor;if(r||m)continue;const h=n.m_sweep.clone();0==n.m_islandFlag&&n.advance(o),s.update(e),0!=s.isEnabled()&&0!=s.isTouching()?(s.m_islandFlag=!0,this.addContact(s),n.m_islandFlag||(n.m_islandFlag=!0,n.isStatic()||n.setAwake(!0),this.addBody(n))):(n.m_sweep.set(h),n.synchronizeTransform())}}u.reset((1-o)*t.dt),u.dtRatio=1,u.positionIterations=20,u.velocityIterations=t.velocityIterations,u.warmStarting=!1,this.solveIslandTOI(u,a,_);for(let t=0;t<this.m_bodies.length;++t){let e=this.m_bodies[t];if(e.m_islandFlag=!1,e.isDynamic()){e.synchronizeFixtures();for(let t=e.m_contactList;t;t=t.next)t.contact.m_toiFlag=!1,t.contact.m_islandFlag=!1}}if(e.findNewContacts(),e.m_subStepping){e.m_stepComplete=!1;break}}},_.prototype.solveIslandTOI=function(t,e,i){for(let t=0;t<this.m_bodies.length;++t){let e=this.m_bodies[t];e.c_position.c.set(e.m_sweep.c),e.c_position.a=e.m_sweep.a,e.c_velocity.v.set(e.m_linearVelocity),e.c_velocity.w=e.m_angularVelocity}for(let e=0;e<this.m_contacts.length;++e){this.m_contacts[e].initConstraint(t)}for(let o=0;o<t.positionIterations;++o){let o=0;for(let s=0;s<this.m_contacts.length;++s){const n=this.m_contacts[s].solvePositionConstraintTOI(t,e,i);o=r.min(o,n)}if(o>=-1.5*s.linearSlop)break}e.m_sweep.c0.set(e.c_position.c),e.m_sweep.a0=e.c_position.a,i.m_sweep.c0.set(i.c_position.c),i.m_sweep.a0=i.c_position.a;for(let e=0;e<this.m_contacts.length;++e){this.m_contacts[e].initVelocityConstraint(t)}for(let e=0;e<t.velocityIterations;++e)for(let e=0;e<this.m_contacts.length;++e){this.m_contacts[e].solveVelocityConstraint(t)}const o=t.dt;for(let t=0;t<this.m_bodies.length;++t){let e=this.m_bodies[t],i=n.clone(e.c_position.c),m=e.c_position.a;const h=n.clone(e.c_velocity.v);let c=e.c_velocity.w;const l=n.mul(o,h);if(n.dot(l,l)>s.maxTranslationSquared){let t=s.maxTranslation/l.length();h.mul(t)}const a=o*c;if(a*a>s.maxRotationSquared){c*=s.maxRotation/r.abs(a)}i.addMul(o,h),m+=o*c,e.c_position.c=i,e.c_position.a=m,e.c_velocity.v=h,e.c_velocity.w=c,e.m_sweep.c=i,e.m_linearVelocity=h,e.m_fixedXFlag&&(e.m_sweep.c0.x=e.m_sweep.c.x=e.m_sweep.c1.x,e.m_linearVelocity.x=0),e.m_fixedYFlag&&(e.m_sweep.c0.y=e.m_sweep.c.y=e.m_sweep.c1.y,e.m_linearVelocity.y=0),e.m_sweep.a=m,e.m_angularVelocity=c,e.synchronizeTransform()}this.postSolveIsland()},_.prototype.postSolveIsland=function(){const t=new p;for(let e=0;e<this.m_contacts.length;++e){const i=this.m_contacts[e];for(let e=0;e<i.v_points.length;++e)t.normalImpulses.push(i.v_points[e].normalImpulse),t.tangentImpulses.push(i.v_points[e].tangentImpulse);this.m_world.postSolve(i,t)}}},function(t,e,i){i(2);const s=i(6),o=i(0),n=i(9),r=i(11),m=i(15);let h=new o,c=new o;function l(t,e,i,n,m){t.pointCount=0,h=s.mulVec2(i,e.m_p,h),c=s.mulVec2(m,n.m_p,c);const l=o.distanceSquared(c,h),a=e.m_radius+n.m_radius;l>a*a||(t.type=r.e_circles,t.localPoint.set(e.m_p),t.localNormal.setZero(),t.pointCount=1,t.points[0].localPoint.set(n.m_p),t.points[0].id.cf.indexA=0,t.points[0].id.cf.typeA=r.e_vertex,t.points[0].id.cf.indexB=0,t.points[0].id.cf.typeB=r.e_vertex)}n.addType(m.TYPE,m.TYPE,(function(t,e,i,s,o,n,r){l(t,i.getShape(),e,n.getShape(),o)})),e.CollideCircles=l},function(t,e,i){i(2);const s=i(6),o=i(0),n=i(9),r=i(11),m=i(18),h=i(27),c=i(15),l=i(20);let a,_=new o,u=new o,p=new o;function d(t,e,i,s,o,n,r){const m=i.getShape(),h=n.getShape();y(t,m,e,h.m_p,h.m_radius,o)}function y(t,e,i,n,m,h){t.pointCount=0,_=s.mulTVec2(i,s.mulVec2(h,n,_),_);const c=e.m_vertex1,l=e.m_vertex2;u=u.set(l).sub(c);const a=o.dot(u,p.set(_).sub(c)),d=e.m_radius+m;if(a<=0){let i=c;if(p=p.set(_).sub(i),o.dot(p,p)>d*d)return;if(e.m_hasVertex0){const t=e.m_vertex0,i=c,s=u.set(i).sub(t);if(o.dot(s,p.set(i).sub(_))>0)return}return t.type=r.e_circles,t.localNormal.setZero(),t.localPoint.set(i),t.pointCount=1,t.points[0].localPoint.set(n),t.points[0].id.cf.indexA=0,t.points[0].id.cf.typeA=r.e_vertex,t.points[0].id.cf.indexB=0,void(t.points[0].id.cf.typeB=r.e_vertex)}const y=o.dot(u,o.sub(l,_));if(y<=0){let i=l;if(p=p.set(_).sub(i),o.dot(p,p)>d*d)return;if(e.m_hasVertex3){const t=e.m_vertex3,i=l,s=u.set(t).sub(i);if(o.dot(s,p.set(_).sub(i))>0)return}return t.type=r.e_circles,t.localNormal.setZero(),t.localPoint.set(i),t.pointCount=1,t.points[0].localPoint.set(n),t.points[0].id.cf.indexA=1,t.points[0].id.cf.typeA=r.e_vertex,t.points[0].id.cf.indexB=0,void(t.points[0].id.cf.typeB=r.e_vertex)}const f=o.dot(u,u);let x=p.setCombine(y/f,c,a/f,l);if(p=p.set(-x.x,-x.y).add(_),o.dot(p,p)>d*d)return;const g=u.set(-u.y,u.x);o.dot(g,p.set(_).sub(c))<0&&g.set(-g.x,-g.y),g.normalize(),t.type=r.e_faceA,t.localNormal.set(g),t.localPoint.set(c),t.pointCount=1,t.points[0].localPoint.set(n),t.points[0].id.cf.indexA=0,t.points[0].id.cf.typeA=r.e_face,t.points[0].id.cf.indexB=0,t.points[0].id.cf.typeB=r.e_vertex}n.addType(m.TYPE,c.TYPE,d),n.addType(h.TYPE,c.TYPE,(function(t,e,i,s,o,n,r){const h=i.getShape();a=a||new m,h.getChildEdge(a,s);const c=a,l=n.getShape();y(t,c,e,l.m_p,l.m_radius,o)})),n.addType(l.TYPE,c.TYPE,d)},function(t,e,i){i(2);const s=i(6),o=i(3),n=i(0),r=i(4),m=i(11),h=i(9),c=i(16),l=i(21);function a(t,e,i,r){const m=t.m_count,h=i.m_count,c=t.m_normals,l=t.m_vertices,_=i.m_vertices,u=s.mulTXf(r,e);let p=0,d=-1/0;for(let t=0;t<m;++t){const e=o.mulVec2(u.q,c[t]),i=s.mulVec2(u,l[t]),r=n.dot(e,i);let m=1/0;for(let t=0;t<h;++t){const i=n.dot(e,_[t])-r;i<m&&(m=i)}m>d&&(d=m,p=t)}a._maxSeparation=d,a._bestIndex=p}function _(t,e,i,h,c){t.pointCount=0;const l=e.m_radius+h.m_radius;a(e,i,h,c);const _=a._bestIndex,u=a._maxSeparation;if(u>l)return;a(h,c,e,i);const p=a._bestIndex,d=a._maxSeparation;if(d>l)return;let y,f,x,g,v,A;d>u+.1*r.linearSlop?(y=h,f=e,x=c,g=i,v=p,t.type=m.e_faceB,A=1):(y=e,f=h,x=i,g=c,v=_,t.type=m.e_faceA,A=0);const b=[new m.clipVertex,new m.clipVertex];!function(t,e,i,r,h,c){const l=e.m_normals,a=h.m_count,_=h.m_vertices,u=h.m_normals,p=o.mulT(c.q,o.mulVec2(i.q,l[r]));let d=0,y=1/0;for(let t=0;t<a;++t){const e=n.dot(p,u[t]);e<y&&(y=e,d=t)}const f=d,x=f+1<a?f+1:0;t[0].v=s.mulVec2(c,_[f]),t[0].id.cf.indexA=r,t[0].id.cf.indexB=f,t[0].id.cf.typeA=m.e_face,t[0].id.cf.typeB=m.e_vertex,t[1].v=s.mulVec2(c,_[x]),t[1].id.cf.indexA=r,t[1].id.cf.indexB=x,t[1].id.cf.typeA=m.e_face,t[1].id.cf.typeB=m.e_vertex}(b,y,x,v,f,g);const B=y.m_count,w=y.m_vertices,C=v,I=v+1<B?v+1:0;let M=w[C],S=w[I];const L=n.sub(S,M);L.normalize();const P=n.cross(L,1),V=n.combine(.5,M,.5,S),z=o.mulVec2(x.q,L),k=n.cross(z,1);M=s.mulVec2(x,M),S=s.mulVec2(x,S);const O=n.dot(k,M),T=-n.dot(z,M)+l,q=n.dot(z,S)+l,E=[new m.clipVertex,new m.clipVertex],F=[new m.clipVertex,new m.clipVertex];let R;if(R=m.clipSegmentToLine(E,b,n.neg(z),T,C),R<2)return;if(R=m.clipSegmentToLine(F,E,z,q,I),R<2)return;t.localNormal=P,t.localPoint=V;let D=0;for(let e=0;e<F.length;++e){if(n.dot(k,F[e].v)-O<=l){const i=t.points[D];if(i.localPoint.set(s.mulTVec2(g,F[e].v)),i.id=F[e].id,A){const t=i.id.cf,e=t.indexA,s=t.indexB,o=t.typeA,n=t.typeB;t.indexA=s,t.indexB=e,t.typeA=n,t.typeB=o}++D}}t.pointCount=D}t.exports=_,h.addType(c.TYPE,c.TYPE,(function(t,e,i,s,o,n,r){_(t,i.getShape(),e,n.getShape(),o)})),h.addType(l.TYPE,c.TYPE,(function(t,e,i,s,o,n,r){_(t,i.getShape().getChildPolygon(s),e,n.getShape(),o)})),h.addType(l.TYPE,l.TYPE,(function(t,e,i,s,o,n,r){_(t,i.getShape().getChildPolygon(s),e,n.getShape().getChildPolygon(r),o)}))},function(t,e,i){const s=i(1),o=i(6),n=i(0),r=i(11),m=i(9),h=i(15),c=i(16),l=i(21);let a=new n;const _=new n,u=new n;function p(t,e,i,m,h){t.pointCount=0,a=o.mulVec2(h,m.m_p,a),a=o.mulTVec2(i,a,a);let c=0,l=-1/0;const p=e.m_radius+m.m_radius,d=e.m_count,y=e.m_vertices,f=e.m_normals;for(let t=0;t<d;++t){const e=n.dot(f[t],_.set(a).sub(y[t]));if(e>p)return;e>l&&(l=e,c=t)}const x=c,g=x+1<d?x+1:0,v=y[x],A=y[g];if(l<s.EPSILON)return t.pointCount=1,t.type=r.e_faceA,t.localNormal.set(f[c]),t.localPoint.setCombine(.5,v,.5,A),t.points[0].localPoint=m.m_p,t.points[0].id.cf.indexA=0,t.points[0].id.cf.typeA=r.e_vertex,t.points[0].id.cf.indexB=0,void(t.points[0].id.cf.typeB=r.e_vertex);if(n.dot(_.set(a).sub(v),u.set(A).sub(v))<=0){if(n.distanceSquared(a,v)>p*p)return;t.pointCount=1,t.type=r.e_faceA,t.localNormal.setCombine(1,a,-1,v),t.localNormal.normalize(),t.localPoint=v,t.points[0].localPoint.set(m.m_p),t.points[0].id.cf.indexA=0,t.points[0].id.cf.typeA=r.e_vertex,t.points[0].id.cf.indexB=0,t.points[0].id.cf.typeB=r.e_vertex}else if(n.dot(_.set(a).sub(A),u.set(v).sub(A))<=0){if(n.distanceSquared(a,A)>p*p)return;t.pointCount=1,t.type=r.e_faceA,t.localNormal.setCombine(1,a,-1,A),t.localNormal.normalize(),t.localPoint.set(A),t.points[0].localPoint.set(m.m_p),t.points[0].id.cf.indexA=0,t.points[0].id.cf.typeA=r.e_vertex,t.points[0].id.cf.indexB=0,t.points[0].id.cf.typeB=r.e_vertex}else{const e=n.mid(v,A,u);if(l=n.dot(a,f[x])-n.dot(e,f[x]),l>p)return;t.pointCount=1,t.type=r.e_faceA,t.localNormal.set(f[x]),t.localPoint.set(e),t.points[0].localPoint.set(m.m_p),t.points[0].id.cf.indexA=0,t.points[0].id.cf.typeA=r.e_vertex,t.points[0].id.cf.indexB=0,t.points[0].id.cf.typeB=r.e_vertex}}m.addType(c.TYPE,h.TYPE,(function(t,e,i,s,o,n,r){p(t,i.getShape(),e,n.getShape(),o)})),m.addType(l.TYPE,h.TYPE,(function(t,e,i,s,o,n,r){p(t,i.getShape().getChildPolygon(s),e,n.getShape(),o)}))},function(t,e,i){const s=i(1),o=i(6),n=i(0),r=i(3),m=i(4),h=i(9),c=i(11),l=i(18),a=i(27),_=i(16),u=i(20),p=i(21);let d;function y(t,e,i,s,o,n,r){w(t,i.getShape(),e,n.getShape(),o)}function f(t,e,i,s,o,n,r){const m=n.getShape();m.initCollisionData(),w(t,i.getShape(),e,m,o)}function x(t,e,i,s,o,n,r){w(t,i.getShape(),e,n.getShape().getChildPolygon(r),o)}h.addType(l.TYPE,_.TYPE,y),h.addType(l.TYPE,u.TYPE,f),h.addType(u.TYPE,u.TYPE,f),h.addType(a.TYPE,_.TYPE,(function(t,e,i,s,o,n,r){const m=i.getShape();d=d||new l,m.getChildEdge(d,s),w(t,d,e,n.getShape(),o)})),h.addType(a.TYPE,u.TYPE,(function(t,e,i,s,o,n,r){const m=i.getShape();d=d||new l,m.getChildEdge(d,s);const h=n.getShape();h.initCollisionData(),w(t,d,e,h,o)})),h.addType(u.TYPE,_.TYPE,y),h.addType(l.TYPE,p.TYPE,x),h.addType(a.TYPE,p.TYPE,(function(t,e,i,s,o,n,r){const m=i.getShape();d=d||new l,m.getChildEdge(d,s),w(t,d,e,n.getShape().getChildPolygon(r),o)})),h.addType(u.TYPE,p.TYPE,x);function g(){this.type=0,this.index=0,this.separation=0}const v=new g,A=new g,b=new function(){this.vertices=[],this.normals=[],this.count=0},B=new function(){this.i1=0,this.i2=0,this.v1=0,this.v2=0,this.normal=n.zero(),this.sideNormal1=n.zero(),this.sideOffset1=0,this.sideNormal2=n.zero(),this.sideOffset2=0};function w(t,e,i,h,l){const a=o.mulTXf(i,l),_=o.mulVec2(a,h.m_centroid),u=e.m_vertex0,p=e.m_vertex1,d=e.m_vertex2,y=e.m_vertex3,f=e.m_hasVertex0,x=e.m_hasVertex3,g=n.sub(d,p);g.normalize();const w=n.neo(g.y,-g.x),I=n.dot(w,n.sub(_,p));let M,S=0,L=0,P=!1,V=!1,z=null,k=null;if(f){const t=n.sub(p,u);t.normalize(),z=n.neo(t.y,-t.x),P=n.cross(t,g)>=0,S=n.dot(z,_)-n.dot(z,u)}if(x){const t=n.sub(y,d);t.normalize(),k=n.neo(t.y,-t.x),V=n.cross(g,t)>0,L=n.dot(k,_)-n.dot(k,d)}const O=n.zero(),T=n.zero(),q=n.zero();f&&x?P&&V?(M=S>=0||I>=0||L>=0,M?(O.set(w),T.set(z),q.set(k)):(O.setMul(-1,w),T.setMul(-1,w),q.setMul(-1,w))):P?(M=S>=0||I>=0&&L>=0,M?(O.set(w),T.set(z),q.set(w)):(O.setMul(-1,w),T.setMul(-1,k),q.setMul(-1,w))):V?(M=L>=0||S>=0&&I>=0,M?(O.set(w),T.set(w),q.set(k)):(O.setMul(-1,w),T.setMul(-1,w),q.setMul(-1,z))):(M=S>=0&&I>=0&&L>=0,M?(O.set(w),T.set(w),q.set(w)):(O.setMul(-1,w),T.setMul(-1,k),q.setMul(-1,z))):f?P?(M=S>=0||I>=0,M?(O.set(w),T.set(z),q.setMul(-1,w)):(O.setMul(-1,w),T.set(w),q.setMul(-1,w))):(M=S>=0&&I>=0,M?(O.set(w),T.set(w),q.setMul(-1,w)):(O.setMul(-1,w),T.set(w),q.setMul(-1,z))):x?V?(M=I>=0||L>=0,M?(O.set(w),T.setMul(-1,w),q.set(k)):(O.setMul(-1,w),T.setMul(-1,w),q.set(w))):(M=I>=0&&L>=0,M?(O.set(w),T.setMul(-1,w),q.set(w)):(O.setMul(-1,w),T.setMul(-1,k),q.set(w))):(M=I>=0,M?(O.set(w),T.setMul(-1,w),q.setMul(-1,w)):(O.setMul(-1,w),T.set(w),q.set(w))),b.count=h.m_count;for(let t=0;t<h.m_count;++t)b.vertices[t]=o.mulVec2(a,h.m_vertices[t]),b.normals[t]=r.mulVec2(a.q,h.m_normals[t]);const E=e.m_radius+h.m_radius;t.pointCount=0,v.type=1,v.index=M?0:1,v.separation=1/0;for(let t=0;t<b.count;++t){const e=n.dot(O,n.sub(b.vertices[t],p));e<v.separation&&(v.separation=e)}if(-1===v.type)return;if(v.separation>E)return;{A.type=-1,A.index=-1,A.separation=-1/0;const t=n.neo(-O.y,O.x);for(let e=0;e<b.count;++e){const i=n.neg(b.normals[e]),o=n.dot(i,n.sub(b.vertices[e],p)),r=n.dot(i,n.sub(b.vertices[e],d));let h=s.min(o,r);if(h>E){A.type=2,A.index=e,A.separation=h;break}if(n.dot(i,t)>=0){if(n.dot(n.sub(i,q),O)<-m.angularSlop)continue}else if(n.dot(n.sub(i,T),O)<-m.angularSlop)continue;h>A.separation&&(A.type=2,A.index=e,A.separation=h)}}if(-1!==A.type&&A.separation>E)return;let F;F=-1===A.type?v:A.separation>.98*v.separation+.001?A:v;const R=[new c.clipVertex,new c.clipVertex];let D,N;if(1===F.type){t.type=c.e_faceA;let e=0,i=n.dot(O,b.normals[0]);for(let t=1;t<b.count;++t){const s=n.dot(O,b.normals[t]);s<i&&(i=s,e=t)}const s=e,o=s+1<b.count?s+1:0;R[0].v=b.vertices[D=s],R[0].id.cf.indexA=0,R[0].id.cf.indexB=s,R[0].id.cf.typeA=c.e_face,R[0].id.cf.typeB=c.e_vertex,R[1].v=b.vertices[N=o],R[1].id.cf.indexA=0,R[1].id.cf.indexB=o,R[1].id.cf.typeA=c.e_face,R[1].id.cf.typeB=c.e_vertex,M?(B.i1=0,B.i2=1,B.v1=p,B.v2=d,B.normal.set(w)):(B.i1=1,B.i2=0,B.v1=d,B.v2=p,B.normal.setMul(-1,w))}else t.type=c.e_faceB,R[0].v=p,R[0].id.cf.indexA=0,R[0].id.cf.indexB=F.index,R[0].id.cf.typeA=c.e_vertex,R[0].id.cf.typeB=c.e_face,R[1].v=d,R[1].id.cf.indexA=0,R[1].id.cf.indexB=F.index,R[1].id.cf.typeA=c.e_vertex,R[1].id.cf.typeB=c.e_face,B.i1=F.index,B.i2=B.i1+1<b.count?B.i1+1:0,B.v1=b.vertices[D=B.i1],B.v2=b.vertices[N=B.i2],B.normal.set(b.normals[B.i1]);B.sideNormal1.set(B.normal.y,-B.normal.x),B.sideNormal2.setMul(-1,B.sideNormal1),B.sideOffset1=n.dot(B.sideNormal1,B.v1),B.sideOffset2=n.dot(B.sideNormal2,B.v2);const U=[new c.clipVertex,new c.clipVertex],j=[new c.clipVertex,new c.clipVertex];let Y;if(Y=c.clipSegmentToLine(U,R,B.sideNormal1,B.sideOffset1,B.i1),Y<m.maxManifoldPoints)return void C(t,e,h,b,D,N);if(Y=c.clipSegmentToLine(j,U,B.sideNormal2,B.sideOffset2,B.i2),Y<m.maxManifoldPoints)return void C(t,e,h,b,D,N);1===F.type?(t.localNormal=n.clone(B.normal),t.localPoint=n.clone(B.v1)):(t.localNormal=n.clone(h.m_normals[B.i1]),t.localPoint=n.clone(h.m_vertices[B.i1]));let W=0;for(let e=0;e<m.maxManifoldPoints;++e){if(n.dot(B.normal,n.sub(j[e].v,B.v1))<=E){const i=t.points[W];1===F.type?(i.localPoint=o.mulT(a,j[e].v),i.id=j[e].id):(i.localPoint=j[e].v,i.id.cf.typeA=j[e].id.cf.typeB,i.id.cf.typeB=j[e].id.cf.typeA,i.id.cf.indexA=j[e].id.cf.indexB,i.id.cf.indexB=j[e].id.cf.indexA),++W}}t.pointCount=W}function C(t,e,i,s,o,r){const m=e.m_radius+i.m_radius,h=m*m,l=e.m_vertex1,a=e.m_vertex2,_=s.vertices[o],u=s.vertices[r],p=n.distanceSquared(l,_),d=n.distanceSquared(l,u),y=n.distanceSquared(a,_),f=n.distanceSquared(a,u);let x=1/0,g=-1,v=-1;if(p<=h&&(x=p,g=0,v=o),d<=h&&d<x&&(x=d,g=0,v=r),y<=h&&y<x&&(x=y,g=1,v=o),f<=h&&f<x&&(g=1,v=r),g<0)return;!function(t,e,i,s,o){t.type=c.e_circles,t.localPoint.set(e),t.localNormal.setZero(),t.pointCount=1,t.points[0].localPoint.set(s),t.points[0].id.cf.indexA=i,t.points[0].id.cf.typeA=c.e_vertex,t.points[0].id.cf.indexB=o,t.points[0].id.cf.typeB=c.e_vertex}(t,0===g?e.m_vertex1:e.m_vertex2,g,i.m_vertices[v],v)}},function(t,e,i){t.exports=a;const s=i(7),o=i(5),n=i(4),r=i(1),m=i(0),h=i(3),c=i(8);a.TYPE="distance-joint",a._super=c,a.prototype=o(a._super.prototype);const l={frequencyHz:0,dampingRatio:0,active:!0};function a(t,e,i,o,n){if(pc.markPhysics2dModuleAsUsed(),!(this instanceof a))return new a(t,e,i,o,n);if(i&&o&&"m_type"in o&&"x"in i&&"y"in i){const t=i;i=o,o=t}t=s(t,l),c.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=a.TYPE,this.m_localAnchorA=o?e.getLocalPoint(o):t.localAnchorA||m.zero(),this.m_localAnchorB=n?i.getLocalPoint(n):t.localAnchorB||m.zero(),r.isFinite(t.length)?(this.m_length=t.length,this.m_autoLength=!1):(this.m_length=m.distance(e.getWorldPoint(this.m_localAnchorA),i.getWorldPoint(this.m_localAnchorB)),this.m_autoLength=!0),this.m_frequencyHz=t.frequencyHz,this.m_dampingRatio=t.dampingRatio,this.m_impulse=0,this.m_gamma=0,this.m_bias=0,this.m_u=m.ZERO,this.m_rA,this.m_rB,this.m_localCenterA,this.m_localCenterB,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_mass}a.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},a.prototype.setLocalAnchorA=function(t){return this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_localAnchorA=t},a.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},a.prototype.setLocalAnchorB=function(t){return this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_localAnchorB=t},a.prototype.setLength=function(t){this.m_length=t},a.prototype.getLength=function(){return this.m_length},a.prototype.setFrequency=function(t){this.m_frequencyHz=t},a.prototype.getFrequency=function(){return this.m_frequencyHz},a.prototype.setDampingRatio=function(t){this.m_dampingRatio=t},a.prototype.getDampingRatio=function(){return this.m_dampingRatio},a.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},a.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},a.prototype.getReactionForce=function(t,e){return m.mul(this.m_impulse,this.m_u,e).mul(t)},a.prototype.getReactionTorque=function(t){return 0},a.prototype.setBodyA=function(t){a._super.prototype.setBodyA.call(this,t),this.m_autoLength&&(this.m_length=m.distance(this.m_bodyA.getWorldPoint(this.m_localAnchorA),this.m_bodyB.getWorldPoint(this.m_localAnchorB)))},a.prototype.setBodyB=function(t){a._super.prototype.setBodyB.call(this,t),this.m_autoLength&&(this.m_length=m.distance(this.m_bodyA.getWorldPoint(this.m_localAnchorA),this.m_bodyB.getWorldPoint(this.m_localAnchorB)))},a.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;const e=this.m_bodyA.c_position.c,i=this.m_bodyA.c_position.a,s=this.m_bodyA.c_velocity.v;let o=this.m_bodyA.c_velocity.w;const c=this.m_bodyB.c_position.c,l=this.m_bodyB.c_position.a,a=this.m_bodyB.c_velocity.v;let _=this.m_bodyB.c_velocity.w;const u=h.neo(i),p=h.neo(l);this.m_rA=h.mulVec2(u,m.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=h.mulVec2(p,m.sub(this.m_localAnchorB,this.m_localCenterB)),this.m_u=m.sub(m.add(c,this.m_rB),m.add(e,this.m_rA));const d=this.m_u.length();d>n.linearSlop?this.m_u.mul(1/d):this.m_u.set(0,0);const y=m.cross(this.m_rA,this.m_u),f=m.cross(this.m_rB,this.m_u);let x=this.m_invMassA+this.m_invIA*y*y+this.m_invMassB+this.m_invIB*f*f;if(this.m_mass=0!=x?1/x:0,this.m_frequencyHz>0){const e=d-this.m_length,i=2*r.PI*this.m_frequencyHz,s=2*this.m_mass*this.m_dampingRatio*i,o=this.m_mass*i*i,n=t.dt;this.m_gamma=n*(s+n*o),this.m_gamma=0!=this.m_gamma?1/this.m_gamma:0,this.m_bias=e*n*o*this.m_gamma,x+=this.m_gamma,this.m_mass=0!=x?1/x:0}else this.m_gamma=0,this.m_bias=0;if(t.warmStarting){this.m_impulse*=t.dtRatio;const e=m.mul(this.m_impulse,this.m_u);s.subMul(this.m_invMassA,e),o-=this.m_invIA*m.cross(this.m_rA,e),a.addMul(this.m_invMassB,e),_+=this.m_invIB*m.cross(this.m_rB,e)}else this.m_impulse=0;this.m_bodyA.c_velocity.v.set(s),this.m_bodyA.c_velocity.w=o,this.m_bodyB.c_velocity.v.set(a),this.m_bodyB.c_velocity.w=_},a.prototype.solveVelocityConstraints=function(t){const e=this.m_bodyA.c_velocity.v;let i=this.m_bodyA.c_velocity.w;const s=this.m_bodyB.c_velocity.v;let o=this.m_bodyB.c_velocity.w;const n=m.add(e,m.cross(i,this.m_rA)),r=m.add(s,m.cross(o,this.m_rB)),h=m.dot(this.m_u,r)-m.dot(this.m_u,n),c=-this.m_mass*(h+this.m_bias+this.m_gamma*this.m_impulse);this.m_impulse+=c;const l=m.mul(c,this.m_u);e.subMul(this.m_invMassA,l),i-=this.m_invIA*m.cross(this.m_rA,l),s.addMul(this.m_invMassB,l),o+=this.m_invIB*m.cross(this.m_rB,l),this.m_bodyA.c_velocity.v.set(e),this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v.set(s),this.m_bodyB.c_velocity.w=o},a.prototype.solvePositionConstraints=function(t){if(this.m_frequencyHz>0)return!0;const e=this.m_bodyA.c_position.c;let i=this.m_bodyA.c_position.a;const s=this.m_bodyB.c_position.c;let o=this.m_bodyB.c_position.a;const c=h.neo(i),l=h.neo(o),a=h.mulSub(c,this.m_localAnchorA,this.m_localCenterA),_=h.mulSub(l,this.m_localAnchorB,this.m_localCenterB),u=m.sub(m.add(s,_),m.add(e,a));let p=u.normalize()-this.m_length;p=r.clamp(p,-n.maxLinearCorrection,n.maxLinearCorrection);const d=-this.m_mass*p,y=m.mul(d,u);return e.subMul(this.m_invMassA,y),i-=this.m_invIA*m.cross(a,y),s.addMul(this.m_invMassB,y),o+=this.m_invIB*m.cross(_,y),this.m_bodyA.c_position.c.set(e),this.m_bodyA.c_position.a=i,this.m_bodyB.c_position.c.set(s),this.m_bodyB.c_position.a=o,r.abs(p)<n.linearSlop}},function(t,e,i){t.exports=a;const s=i(7),o=i(5),n=i(1),r=i(0),m=i(10),h=i(3),c=i(8);a.TYPE="friction-joint",a._super=c,a.prototype=o(a._super.prototype);const l={maxForce:0,maxTorque:0,active:!0};function a(t,e,i,o){if(pc.markPhysics2dModuleAsUsed(),!(this instanceof a))return new a(t,e,i,o);t=s(t,l),c.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=a.TYPE,this.m_localAnchorA=o?e.getLocalPoint(o):t.localAnchorA||r.zero(),this.m_localAnchorB=o?i.getLocalPoint(o):t.localAnchorB||r.zero(),this.m_linearImpulse=r.zero(),this.m_angularImpulse=0,this.m_maxForce=t.maxForce,this.m_maxTorque=t.maxTorque,this.m_rA,this.m_rB,this.m_localCenterA,this.m_localCenterB,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_linearMass,this.m_angularMass}a.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},a.prototype.setLocalAnchorA=function(t){return this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_localAnchorA=t},a.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},a.prototype.setLocalAnchorB=function(t){return this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_localAnchorB=t},a.prototype.setMaxForce=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_maxForce=t},a.prototype.getMaxForce=function(){return this.m_maxForce},a.prototype.setMaxTorque=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_maxTorque=t},a.prototype.getMaxTorque=function(){return this.m_maxTorque},a.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},a.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},a.prototype.getReactionForce=function(t,e){return r.mul(t,this.m_linearImpulse,e)},a.prototype.getReactionTorque=function(t){return t*this.m_angularImpulse},a.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;const e=this.m_bodyA.c_position.a,i=this.m_bodyA.c_velocity.v;let s=this.m_bodyA.c_velocity.w;const o=this.m_bodyB.c_position.a,n=this.m_bodyB.c_velocity.v;let c=this.m_bodyB.c_velocity.w;const l=h.neo(e),a=h.neo(o);this.m_rA=h.mulVec2(l,r.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=h.mulVec2(a,r.sub(this.m_localAnchorB,this.m_localCenterB));const _=this.m_invMassA,u=this.m_invMassB,p=this.m_invIA,d=this.m_invIB,y=new m;if(y.ex.x=_+u+p*this.m_rA.y*this.m_rA.y+d*this.m_rB.y*this.m_rB.y,y.ex.y=-p*this.m_rA.x*this.m_rA.y-d*this.m_rB.x*this.m_rB.y,y.ey.x=y.ex.y,y.ey.y=_+u+p*this.m_rA.x*this.m_rA.x+d*this.m_rB.x*this.m_rB.x,this.m_linearMass=y.getInverse(),this.m_angularMass=p+d,this.m_angularMass>0&&(this.m_angularMass=1/this.m_angularMass),t.warmStarting){this.m_linearImpulse.mul(t.dtRatio),this.m_angularImpulse*=t.dtRatio;const e=r.neo(this.m_linearImpulse.x,this.m_linearImpulse.y);i.subMul(_,e),s-=p*(r.cross(this.m_rA,e)+this.m_angularImpulse),n.addMul(u,e),c+=d*(r.cross(this.m_rB,e)+this.m_angularImpulse)}else this.m_linearImpulse.setZero(),this.m_angularImpulse=0;this.m_bodyA.c_velocity.v=i,this.m_bodyA.c_velocity.w=s,this.m_bodyB.c_velocity.v=n,this.m_bodyB.c_velocity.w=c},a.prototype.solveVelocityConstraints=function(t){const e=this.m_bodyA.c_velocity.v;let i=this.m_bodyA.c_velocity.w;const s=this.m_bodyB.c_velocity.v;let o=this.m_bodyB.c_velocity.w;const h=this.m_invMassA,c=this.m_invMassB,l=this.m_invIA,a=this.m_invIB,_=t.dt;{let t=o-i,e=-this.m_angularMass*t,s=this.m_angularImpulse,r=_*this.m_maxTorque;this.m_angularImpulse=n.clamp(this.m_angularImpulse+e,-r,r),e=this.m_angularImpulse-s,i-=l*e,o+=a*e}{let t=r.sub(r.add(s,r.cross(o,this.m_rB)),r.add(e,r.cross(i,this.m_rA))),n=r.neg(m.mulVec2(this.m_linearMass,t)),u=this.m_linearImpulse.clone();this.m_linearImpulse.add(n);let p=_*this.m_maxForce;this.m_linearImpulse.lengthSquared()>p*p&&(this.m_linearImpulse.normalize(),this.m_linearImpulse.mul(p)),n=r.sub(this.m_linearImpulse,u),e.subMul(h,n),i-=l*r.cross(this.m_rA,n),s.addMul(c,n),o+=a*r.cross(this.m_rB,n)}this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v=s,this.m_bodyB.c_velocity.w=o},a.prototype.solvePositionConstraints=function(t){return!0}},function(t,e,i){t.exports=_;i(2);const s=i(7),o=i(5),n=i(4),r=i(1),m=i(0),h=i(3),c=i(8),l=i(32);i(33);_.TYPE="gear-joint",_._super=c,_.prototype=o(_._super.prototype);const a={ratio:1,active:!0};function _(t,e,i,o,n,u){if(pc.markPhysics2dModuleAsUsed(),!(this instanceof _))return new _(t,e,i,o,n,u);let p,d;t=s(t,a),c.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=_.TYPE,this.m_joint1=o||t.joint1,this.m_joint2=n||t.joint2,this.m_ratio=r.isFinite(u)?u:t.ratio,this.m_type1=this.m_joint1.getType(),this.m_type2=this.m_joint2.getType(),this.m_bodyC=this.m_joint1.getBodyA(),this.m_bodyA=this.m_joint1.getBodyB();const y=this.m_bodyA.m_xf,f=this.m_bodyA.m_sweep.a,x=this.m_bodyC.m_xf,g=this.m_bodyC.m_sweep.a;if(this.m_type1===l.TYPE){let t=this.m_joint1;this.m_localAnchorC=t.m_localAnchorA,this.m_localAnchorA=t.m_localAnchorB,this.m_referenceAngleA=t.m_referenceAngle,this.m_localAxisC=m.zero(),p=f-g-this.m_referenceAngleA}else{let t=this.m_joint1;this.m_localAnchorC=t.m_localAnchorA,this.m_localAnchorA=t.m_localAnchorB,this.m_referenceAngleA=t.m_referenceAngle,this.m_localAxisC=t.m_localXAxisA;const e=this.m_localAnchorC,i=h.mulTVec2(x.q,m.add(h.mul(y.q,this.m_localAnchorA),m.sub(y.p,x.p)));p=m.dot(i,this.m_localAxisC)-m.dot(e,this.m_localAxisC)}this.m_bodyD=this.m_joint2.getBodyA(),this.m_bodyB=this.m_joint2.getBodyB();const v=this.m_bodyB.m_xf,A=this.m_bodyB.m_sweep.a,b=this.m_bodyD.m_xf,B=this.m_bodyD.m_sweep.a;if(this.m_type2===l.TYPE){let t=this.m_joint2;this.m_localAnchorD=t.m_localAnchorA,this.m_localAnchorB=t.m_localAnchorB,this.m_referenceAngleB=t.m_referenceAngle,this.m_localAxisD=m.zero(),d=A-B-this.m_referenceAngleB}else{let t=this.m_joint2;this.m_localAnchorD=t.m_localAnchorA,this.m_localAnchorB=t.m_localAnchorB,this.m_referenceAngleB=t.m_referenceAngle,this.m_localAxisD=t.m_localXAxisA;const e=this.m_localAnchorD,i=h.mulTVec2(b.q,m.add(h.mul(v.q,this.m_localAnchorB),m.sub(v.p,b.p)));d=m.dot(i,this.m_localAxisD)-m.dot(e,this.m_localAxisD)}this.m_constant=p+this.m_ratio*d,this.m_impulse=0,this.m_lcA,this.m_lcB,this.m_lcC,this.m_lcD,this.m_mA,this.m_mB,this.m_mC,this.m_mD,this.m_iA,this.m_iB,this.m_iC,this.m_iD,this.m_JvAC,this.m_JvBD,this.m_JwA,this.m_JwB,this.m_JwC,this.m_JwD,this.m_mass}_.prototype.getJoint1=function(){return this.m_joint1},_.prototype.getJoint2=function(){return this.m_joint2},_.prototype.setRatio=function(t){this.m_ratio=t},_.prototype.getRatio=function(){return this.m_ratio},_.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},_.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},_.prototype.getReactionForce=function(t){return m.mul(this.m_impulse,this.m_JvAC).mul(t)},_.prototype.getReactionTorque=function(t){return t*(this.m_impulse*this.m_JwA)},_.prototype.initVelocityConstraints=function(t){this.m_lcA=this.m_bodyA.m_sweep.localCenter,this.m_lcB=this.m_bodyB.m_sweep.localCenter,this.m_lcC=this.m_bodyC.m_sweep.localCenter,this.m_lcD=this.m_bodyD.m_sweep.localCenter,this.m_mA=this.m_bodyA.m_invMass,this.m_mB=this.m_bodyB.m_invMass,this.m_mC=this.m_bodyC.m_invMass,this.m_mD=this.m_bodyD.m_invMass,this.m_iA=this.m_bodyA.m_invI,this.m_iB=this.m_bodyB.m_invI,this.m_iC=this.m_bodyC.m_invI,this.m_iD=this.m_bodyD.m_invI;const e=this.m_bodyA.c_position.a,i=this.m_bodyA.c_velocity.v;let s=this.m_bodyA.c_velocity.w;const o=this.m_bodyB.c_position.a,n=this.m_bodyB.c_velocity.v;let r=this.m_bodyB.c_velocity.w;const c=this.m_bodyC.c_position.a,a=this.m_bodyC.c_velocity.v;let _=this.m_bodyC.c_velocity.w;const u=this.m_bodyD.c_position.a,p=this.m_bodyD.c_velocity.v;let d=this.m_bodyD.c_velocity.w;const y=h.neo(e),f=h.neo(o),x=h.neo(c),g=h.neo(u);if(this.m_mass=0,this.m_type1==l.TYPE)this.m_JvAC=m.zero(),this.m_JwA=1,this.m_JwC=1,this.m_mass+=this.m_iA+this.m_iC;else{let t=h.mulVec2(x,this.m_localAxisC);const e=h.mulSub(x,this.m_localAnchorC,this.m_lcC),i=h.mulSub(y,this.m_localAnchorA,this.m_lcA);this.m_JvAC=t,this.m_JwC=m.cross(e,t),this.m_JwA=m.cross(i,t),this.m_mass+=this.m_mC+this.m_mA+this.m_iC*this.m_JwC*this.m_JwC+this.m_iA*this.m_JwA*this.m_JwA}if(this.m_type2==l.TYPE)this.m_JvBD=m.zero(),this.m_JwB=this.m_ratio,this.m_JwD=this.m_ratio,this.m_mass+=this.m_ratio*this.m_ratio*(this.m_iB+this.m_iD);else{let t=h.mulVec2(g,this.m_localAxisD);const e=h.mulSub(g,this.m_localAnchorD,this.m_lcD),i=h.mulSub(f,this.m_localAnchorB,this.m_lcB);this.m_JvBD=m.mul(this.m_ratio,t),this.m_JwD=this.m_ratio*m.cross(e,t),this.m_JwB=this.m_ratio*m.cross(i,t),this.m_mass+=this.m_ratio*this.m_ratio*(this.m_mD+this.m_mB)+this.m_iD*this.m_JwD*this.m_JwD+this.m_iB*this.m_JwB*this.m_JwB}this.m_mass=this.m_mass>0?1/this.m_mass:0,t.warmStarting?(i.addMul(this.m_mA*this.m_impulse,this.m_JvAC),s+=this.m_iA*this.m_impulse*this.m_JwA,n.addMul(this.m_mB*this.m_impulse,this.m_JvBD),r+=this.m_iB*this.m_impulse*this.m_JwB,a.subMul(this.m_mC*this.m_impulse,this.m_JvAC),_-=this.m_iC*this.m_impulse*this.m_JwC,p.subMul(this.m_mD*this.m_impulse,this.m_JvBD),d-=this.m_iD*this.m_impulse*this.m_JwD):this.m_impulse=0,this.m_bodyA.c_velocity.v.set(i),this.m_bodyA.c_velocity.w=s,this.m_bodyB.c_velocity.v.set(n),this.m_bodyB.c_velocity.w=r,this.m_bodyC.c_velocity.v.set(a),this.m_bodyC.c_velocity.w=_,this.m_bodyD.c_velocity.v.set(p),this.m_bodyD.c_velocity.w=d},_.prototype.solveVelocityConstraints=function(t){const e=this.m_bodyA.c_velocity.v;let i=this.m_bodyA.c_velocity.w;const s=this.m_bodyB.c_velocity.v;let o=this.m_bodyB.c_velocity.w;const n=this.m_bodyC.c_velocity.v;let r=this.m_bodyC.c_velocity.w;const h=this.m_bodyD.c_velocity.v;let c=this.m_bodyD.c_velocity.w,l=m.dot(this.m_JvAC,e)-m.dot(this.m_JvAC,n)+m.dot(this.m_JvBD,s)-m.dot(this.m_JvBD,h);l+=this.m_JwA*i-this.m_JwC*r+(this.m_JwB*o-this.m_JwD*c);const a=-this.m_mass*l;this.m_impulse+=a,e.addMul(this.m_mA*a,this.m_JvAC),i+=this.m_iA*a*this.m_JwA,s.addMul(this.m_mB*a,this.m_JvBD),o+=this.m_iB*a*this.m_JwB,n.subMul(this.m_mC*a,this.m_JvAC),r-=this.m_iC*a*this.m_JwC,h.subMul(this.m_mD*a,this.m_JvBD),c-=this.m_iD*a*this.m_JwD,this.m_bodyA.c_velocity.v.set(e),this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v.set(s),this.m_bodyB.c_velocity.w=o,this.m_bodyC.c_velocity.v.set(n),this.m_bodyC.c_velocity.w=r,this.m_bodyD.c_velocity.v.set(h),this.m_bodyD.c_velocity.w=c},_.prototype.solvePositionConstraints=function(t){const e=this.m_bodyA.c_position.c;let i=this.m_bodyA.c_position.a;const s=this.m_bodyB.c_position.c;let o=this.m_bodyB.c_position.a;const r=this.m_bodyC.c_position.c;let c=this.m_bodyC.c_position.a;const a=this.m_bodyD.c_position.c;let _=this.m_bodyD.c_position.a;const u=h.neo(i),p=h.neo(o),d=h.neo(c),y=h.neo(_);let f,x,g,v,A,b,B,w,C=0;if(this.m_type1==l.TYPE)g=m.zero(),A=1,B=1,C+=this.m_iA+this.m_iC,f=i-c-this.m_referenceAngleA;else{let t=h.mulVec2(d,this.m_localAxisC);const i=h.mulSub(d,this.m_localAnchorC,this.m_lcC),s=h.mulSub(u,this.m_localAnchorA,this.m_lcA);g=t,B=m.cross(i,t),A=m.cross(s,t),C+=this.m_mC+this.m_mA+this.m_iC*B*B+this.m_iA*A*A;const o=m.sub(this.m_localAnchorC,this.m_lcC),n=h.mulTVec2(d,m.add(s,m.sub(e,r)));f=m.dot(m.sub(n,o),this.m_localAxisC)}if(this.m_type2==l.TYPE)v=m.zero(),b=this.m_ratio,w=this.m_ratio,C+=this.m_ratio*this.m_ratio*(this.m_iB+this.m_iD),x=o-_-this.m_referenceAngleB;else{let t=h.mulVec2(y,this.m_localAxisD);const e=h.mulSub(y,this.m_localAnchorD,this.m_lcD),i=h.mulSub(p,this.m_localAnchorB,this.m_lcB);v=m.mul(this.m_ratio,t),w=this.m_ratio*m.cross(e,t),b=this.m_ratio*m.cross(i,t),C+=this.m_ratio*this.m_ratio*(this.m_mD+this.m_mB)+this.m_iD*w*w+this.m_iB*b*b;const o=m.sub(this.m_localAnchorD,this.m_lcD),n=h.mulTVec2(y,m.add(i,m.sub(s,a)));x=m.dot(n,this.m_localAxisD)-m.dot(o,this.m_localAxisD)}const I=f+this.m_ratio*x-this.m_constant;let M=0;return C>0&&(M=-I/C),e.addMul(this.m_mA*M,g),i+=this.m_iA*M*A,s.addMul(this.m_mB*M,v),o+=this.m_iB*M*b,r.subMul(this.m_mC*M,g),c-=this.m_iC*M*B,a.subMul(this.m_mD*M,v),_-=this.m_iD*M*w,this.m_bodyA.c_position.c.set(e),this.m_bodyA.c_position.a=i,this.m_bodyB.c_position.c.set(s),this.m_bodyB.c_position.a=o,this.m_bodyC.c_position.c.set(r),this.m_bodyC.c_position.a=c,this.m_bodyD.c_position.c.set(a),this.m_bodyD.c_position.a=_,0<n.linearSlop}},function(t,e,i){t.exports=a;i(2);const s=i(7),o=i(5),n=i(1),r=i(0),m=i(10),h=i(3),c=i(8);a.TYPE="motor-joint",a._super=c,a.prototype=o(a._super.prototype);const l={maxForce:1,maxTorque:1,correctionFactor:.3,active:!0};function a(t,e,i){if(pc.markPhysics2dModuleAsUsed(),!(this instanceof a))return new a(t,e,i);t=s(t,l),c.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=a.TYPE,this.m_linearOffset=t.linearOffset?t.linearOffset:e.getLocalPoint(i.getPosition()),this.m_angularOffset=t.angularOffset?t.angularOffset:i.getAngle()-e.getAngle(),this.m_linearImpulse=r.zero(),this.m_angularImpulse=0,this.m_maxForce=t.maxForce,this.m_maxTorque=t.maxTorque,this.m_correctionFactor=t.correctionFactor,this.m_rA,this.m_rB,this.m_localCenterA,this.m_localCenterB,this.m_linearError,this.m_angularError,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_linearMass,this.m_angularMass}a.prototype.setMaxForce=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_maxForce=t},a.prototype.getMaxForce=function(){return this.m_maxForce},a.prototype.setMaxTorque=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_maxTorque=t},a.prototype.getMaxTorque=function(){return this.m_maxTorque},a.prototype.setCorrectionFactor=function(t){this.m_correctionFactor=t},a.prototype.getCorrectionFactor=function(){return this.m_correctionFactor},a.prototype.setLinearOffset=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_linearOffset=t},a.prototype.getLinearOffset=function(){return this.m_linearOffset},a.prototype.setAngularOffset=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_angularOffset=t},a.prototype.getAngularOffset=function(){return this.m_angularOffset},a.prototype.getAnchorA=function(){return this.m_bodyA.getPosition()},a.prototype.getAnchorB=function(){return this.m_bodyB.getPosition()},a.prototype.getReactionForce=function(t,e){return r.mul(t,this.m_linearImpulse,e)},a.prototype.getReactionTorque=function(t){return t*this.m_angularImpulse},a.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;const e=this.m_bodyA.c_position.c,i=this.m_bodyA.c_position.a,s=this.m_bodyA.c_velocity.v;let o=this.m_bodyA.c_velocity.w;const n=this.m_bodyB.c_position.c,c=this.m_bodyB.c_position.a,l=this.m_bodyB.c_velocity.v;let a=this.m_bodyB.c_velocity.w;const _=h.neo(i),u=h.neo(c);this.m_rA=h.mulVec2(_,this.m_linearOffset.clone().sub(this.m_localCenterA)),this.m_rB=h.mulVec2(u,r.neg(this.m_localCenterB));const p=this.m_invMassA,d=this.m_invMassB,y=this.m_invIA,f=this.m_invIB,x=new m;if(x.ex.x=p+d+y*this.m_rA.y*this.m_rA.y+f*this.m_rB.y*this.m_rB.y,x.ex.y=-y*this.m_rA.x*this.m_rA.y-f*this.m_rB.x*this.m_rB.y,x.ey.x=x.ex.y,x.ey.y=p+d+y*this.m_rA.x*this.m_rA.x+f*this.m_rB.x*this.m_rB.x,this.m_linearMass=x.getInverse(),this.m_angularMass=y+f,this.m_angularMass>0&&(this.m_angularMass=1/this.m_angularMass),this.m_linearError=r.zero(),this.m_linearError.addCombine(1,n,1,this.m_rB),this.m_linearError.subCombine(1,e,1,this.m_rA),this.m_angularError=c-i-this.m_angularOffset,t.warmStarting){this.m_linearImpulse.mul(t.dtRatio),this.m_angularImpulse*=t.dtRatio;const e=r.neo(this.m_linearImpulse.x,this.m_linearImpulse.y);s.subMul(p,e),o-=y*(r.cross(this.m_rA,e)+this.m_angularImpulse),l.addMul(d,e),a+=f*(r.cross(this.m_rB,e)+this.m_angularImpulse)}else this.m_linearImpulse.setZero(),this.m_angularImpulse=0;this.m_bodyA.c_velocity.v=s,this.m_bodyA.c_velocity.w=o,this.m_bodyB.c_velocity.v=l,this.m_bodyB.c_velocity.w=a},a.prototype.solveVelocityConstraints=function(t){const e=this.m_bodyA.c_velocity.v;let i=this.m_bodyA.c_velocity.w;const s=this.m_bodyB.c_velocity.v;let o=this.m_bodyB.c_velocity.w;const h=this.m_invMassA,c=this.m_invMassB,l=this.m_invIA,a=this.m_invIB,_=t.dt,u=t.inv_dt;{let t=o-i+u*this.m_correctionFactor*this.m_angularError,e=-this.m_angularMass*t,s=this.m_angularImpulse,r=_*this.m_maxTorque;this.m_angularImpulse=n.clamp(this.m_angularImpulse+e,-r,r),e=this.m_angularImpulse-s,i-=l*e,o+=a*e}{let t=r.zero();t.addCombine(1,s,1,r.cross(o,this.m_rB)),t.subCombine(1,e,1,r.cross(i,this.m_rA)),t.addMul(u*this.m_correctionFactor,this.m_linearError);let n=r.neg(m.mulVec2(this.m_linearMass,t)),p=r.clone(this.m_linearImpulse);this.m_linearImpulse.add(n);let d=_*this.m_maxForce;this.m_linearImpulse.clamp(d),n=r.sub(this.m_linearImpulse,p),e.subMul(h,n),i-=l*r.cross(this.m_rA,n),s.addMul(c,n),o+=a*r.cross(this.m_rB,n)}this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v=s,this.m_bodyB.c_velocity.w=o},a.prototype.solvePositionConstraints=function(t){return!0}},function(t,e,i){t.exports=_;i(2);const s=i(7),o=i(5),n=i(1),r=i(0),m=i(10),h=i(3),c=i(6),l=i(8);_.TYPE="mouse-joint",_._super=l,_.prototype=o(_._super.prototype);const a={maxForce:0,frequencyHz:5,dampingRatio:.7,active:!0};function _(t,e,i,o){if(pc.markPhysics2dModuleAsUsed(),!(this instanceof _))return new _(t,e,i,o);t=s(t,a),l.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=_.TYPE,this.m_targetA=o?r.clone(o):t.target||r.zero(),this.m_localAnchorB=t.anchorB?t.anchorB:c.mulTVec2(i.getTransform(),this.m_targetA),this.m_maxForce=t.maxForce,this.m_impulse=r.zero(),this.m_frequencyHz=t.frequencyHz,this.m_dampingRatio=t.dampingRatio,this.m_beta=0,this.m_gamma=0,this.m_rB=r.zero(),this.m_localCenterB=r.zero(),this.m_invMassB=0,this.m_invIB=0,this.mass=new m,this.m_C=r.zero()}_.prototype.setTarget=function(t){0==this.m_bodyB.isAwake()&&this.m_bodyB.setAwake(!0),this.m_targetA=t},_.prototype.getTarget=function(){return this.m_targetA},_.prototype.setMaxForce=function(t){this.m_bodyB.setAwake(!0),this.m_maxForce=t},_.getMaxForce=function(){return this.m_maxForce},_.prototype.setFrequency=function(t){this.m_bodyB.setAwake(!0),this.m_frequencyHz=t},_.prototype.getFrequency=function(){return this.m_frequencyHz},_.prototype.setDampingRatio=function(t){this.m_bodyB.setAwake(!0),this.m_dampingRatio=t},_.prototype.getDampingRatio=function(){return this.m_dampingRatio},_.prototype.getAnchorA=function(){return r.clone(this.m_targetA)},_.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},_.prototype.getLocalAnchorB=function(t){return this.m_localAnchorB},_.prototype.setLocalAnchorB=function(t){return this.m_bodyB.setAwake(!0),this.m_localAnchorB=t},_.prototype.getReactionForce=function(t,e){return r.mul(t,this.m_impulse,e)},_.prototype.getReactionTorque=function(t){return 0*t},_.prototype.shiftOrigin=function(t){this.m_targetA.sub(t)},_.prototype.initVelocityConstraints=function(t){this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIB=this.m_bodyB.m_invI;const e=this.m_bodyB.c_position,i=this.m_bodyB.c_velocity,s=e.c,o=e.a,c=i.v;let l=i.w;const a=h.neo(o),_=this.m_bodyB.getMass(),u=2*n.PI*this.m_frequencyHz,p=2*_*this.m_dampingRatio*u,d=_*(u*u),y=t.dt;this.m_gamma=y*(p+y*d),0!=this.m_gamma&&(this.m_gamma=1/this.m_gamma),this.m_beta=y*d*this.m_gamma,this.m_rB=h.mulVec2(a,r.sub(this.m_localAnchorB,this.m_localCenterB));const f=new m;f.ex.x=this.m_invMassB+this.m_invIB*this.m_rB.y*this.m_rB.y+this.m_gamma,f.ex.y=-this.m_invIB*this.m_rB.x*this.m_rB.y,f.ey.x=f.ex.y,f.ey.y=this.m_invMassB+this.m_invIB*this.m_rB.x*this.m_rB.x+this.m_gamma,this.m_mass=f.getInverse(),this.m_C.set(s),this.m_C.addCombine(1,this.m_rB,-1,this.m_targetA),this.m_C.mul(this.m_beta),l*=.98,t.warmStarting?(this.m_impulse.mul(t.dtRatio),c.addMul(this.m_invMassB,this.m_impulse),l+=this.m_invIB*r.cross(this.m_rB,this.m_impulse)):this.m_impulse.setZero(),i.v.set(c),i.w=l},_.prototype.solveVelocityConstraints=function(t){const e=this.m_bodyB.c_velocity,i=r.clone(e.v);let s=e.w;const o=r.cross(s,this.m_rB);o.add(i),o.addCombine(1,this.m_C,this.m_gamma,this.m_impulse),o.neg();let n=m.mulVec2(this.m_mass,o);const h=r.clone(this.m_impulse);this.m_impulse.add(n);const c=t.dt*this.m_maxForce;this.m_impulse.clamp(c),n=r.sub(this.m_impulse,h),i.addMul(this.m_invMassB,n),s+=this.m_invIB*r.cross(this.m_rB,n),e.v.set(i),e.w=s},_.prototype.solvePositionConstraints=function(t){return!0}},function(t,e,i){t.exports=a;i(2);const s=i(7),o=i(5),n=i(4),r=i(1),m=i(0),h=i(3),c=i(8);a.TYPE="pulley-joint",a.MIN_PULLEY_LENGTH=2,a._super=c,a.prototype=o(a._super.prototype);const l={collideConnected:!0,active:!0};function a(t,e,i,o,n,h,_,u){if(pc.markPhysics2dModuleAsUsed(),!(this instanceof a))return new a(t,e,i,o,n,h,_,u);t=s(t,l),c.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=a.TYPE,this.m_groundAnchorA=o||t.groundAnchorA||m.neo(-1,1),this.m_groundAnchorB=n||t.groundAnchorB||m.neo(1,1),this.m_localAnchorA=h?e.getLocalPoint(h):t.localAnchorA||m.neo(-1,0),this.m_localAnchorB=_?i.getLocalPoint(_):t.localAnchorB||m.neo(1,0),this.m_lengthA=r.isFinite(t.lengthA)?t.lengthA:m.distance(h,o),this.m_lengthB=r.isFinite(t.lengthB)?t.lengthB:m.distance(_,n),this.m_ratio=r.isFinite(u)?u:t.ratio,this.m_constant=this.m_lengthA+this.m_ratio*this.m_lengthB,this.m_impulse=0,this.m_uA,this.m_uB,this.m_rA,this.m_rB,this.m_localCenterA,this.m_localCenterB,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_mass}a.prototype.getGroundAnchorA=function(){return this.m_groundAnchorA},a.prototype.getGroundAnchorB=function(){return this.m_groundAnchorB},a.prototype.getLengthA=function(){return this.m_lengthA},a.prototype.getLengthB=function(){return this.m_lengthB},a.prototype.getRatio=function(){return this.m_ratio},a.prototype.getCurrentLengthA=function(){const t=this.m_bodyA.getWorldPoint(this.m_localAnchorA),e=this.m_groundAnchorA;return m.distance(t,e)},a.prototype.getCurrentLengthB=function(){const t=this.m_bodyB.getWorldPoint(this.m_localAnchorB),e=this.m_groundAnchorB;return m.distance(t,e)},a.prototype.shiftOrigin=function(t){this.m_groundAnchorA.sub(t),this.m_groundAnchorB.sub(t)},a.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},a.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},a.prototype.getReactionForce=function(t){return m.mul(this.m_impulse,this.m_uB).mul(t)},a.prototype.getReactionTorque=function(t){return 0},a.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;const e=this.m_bodyA.c_position.c,i=this.m_bodyA.c_position.a,s=this.m_bodyA.c_velocity.v;let o=this.m_bodyA.c_velocity.w;const r=this.m_bodyB.c_position.c,c=this.m_bodyB.c_position.a,l=this.m_bodyB.c_velocity.v;let a=this.m_bodyB.c_velocity.w;const _=h.neo(i),u=h.neo(c);this.m_rA=h.mulVec2(_,m.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=h.mulVec2(u,m.sub(this.m_localAnchorB,this.m_localCenterB)),this.m_uA=m.sub(m.add(e,this.m_rA),this.m_groundAnchorA),this.m_uB=m.sub(m.add(r,this.m_rB),this.m_groundAnchorB);const p=this.m_uA.length(),d=this.m_uB.length();p>10*n.linearSlop?this.m_uA.mul(1/p):this.m_uA.setZero(),d>10*n.linearSlop?this.m_uB.mul(1/d):this.m_uB.setZero();const y=m.cross(this.m_rA,this.m_uA),f=m.cross(this.m_rB,this.m_uB),x=this.m_invMassA+this.m_invIA*y*y,g=this.m_invMassB+this.m_invIB*f*f;if(this.m_mass=x+this.m_ratio*this.m_ratio*g,this.m_mass>0&&(this.m_mass=1/this.m_mass),t.warmStarting){this.m_impulse*=t.dtRatio;const e=m.mul(-this.m_impulse,this.m_uA),i=m.mul(-this.m_ratio*this.m_impulse,this.m_uB);s.addMul(this.m_invMassA,e),o+=this.m_invIA*m.cross(this.m_rA,e),l.addMul(this.m_invMassB,i),a+=this.m_invIB*m.cross(this.m_rB,i)}else this.m_impulse=0;this.m_bodyA.c_velocity.v=s,this.m_bodyA.c_velocity.w=o,this.m_bodyB.c_velocity.v=l,this.m_bodyB.c_velocity.w=a},a.prototype.solveVelocityConstraints=function(t){const e=this.m_bodyA.c_velocity.v;let i=this.m_bodyA.c_velocity.w;const s=this.m_bodyB.c_velocity.v;let o=this.m_bodyB.c_velocity.w;const n=m.add(e,m.cross(i,this.m_rA)),r=m.add(s,m.cross(o,this.m_rB)),h=-m.dot(this.m_uA,n)-this.m_ratio*m.dot(this.m_uB,r),c=-this.m_mass*h;this.m_impulse+=c;const l=m.mul(-c,this.m_uA),a=m.mul(-this.m_ratio*c,this.m_uB);e.addMul(this.m_invMassA,l),i+=this.m_invIA*m.cross(this.m_rA,l),s.addMul(this.m_invMassB,a),o+=this.m_invIB*m.cross(this.m_rB,a),this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v=s,this.m_bodyB.c_velocity.w=o},a.prototype.solvePositionConstraints=function(t){const e=this.m_bodyA.c_position.c;let i=this.m_bodyA.c_position.a;const s=this.m_bodyB.c_position.c;let o=this.m_bodyB.c_position.a;const c=h.neo(i),l=h.neo(o),a=h.mulVec2(c,m.sub(this.m_localAnchorA,this.m_localCenterA)),_=h.mulVec2(l,m.sub(this.m_localAnchorB,this.m_localCenterB)),u=m.sub(m.add(e,this.m_rA),this.m_groundAnchorA),p=m.sub(m.add(s,this.m_rB),this.m_groundAnchorB),d=u.length(),y=p.length();d>10*n.linearSlop?u.mul(1/d):u.setZero(),y>10*n.linearSlop?p.mul(1/y):p.setZero();const f=m.cross(a,u),x=m.cross(_,p),g=this.m_invMassA+this.m_invIA*f*f,v=this.m_invMassB+this.m_invIB*x*x;let A=g+this.m_ratio*this.m_ratio*v;A>0&&(A=1/A);const b=this.m_constant-d-this.m_ratio*y,B=r.abs(b),w=-A*b,C=m.mul(-w,u),I=m.mul(-this.m_ratio*w,p);return e.addMul(this.m_invMassA,C),i+=this.m_invIA*m.cross(a,C),s.addMul(this.m_invMassB,I),o+=this.m_invIB*m.cross(_,I),this.m_bodyA.c_position.c=e,this.m_bodyA.c_position.a=i,this.m_bodyB.c_position.c=s,this.m_bodyB.c_position.a=o,B<n.linearSlop}},function(t,e,i){t.exports=a;const s=i(7),o=i(5),n=i(4),r=i(1),m=i(0),h=i(3),c=i(8);a.TYPE="rope-joint",a._super=c,a.prototype=o(a._super.prototype);const l={maxLength:0,active:!0};function a(t,e,i,o){if(pc.markPhysics2dModuleAsUsed(),!(this instanceof a))return new a(t,e,i,o);t=s(t,l),c.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=a.TYPE,this.m_localAnchorA=o?e.getLocalPoint(o):t.localAnchorA||m.neo(-1,0),this.m_localAnchorB=o?i.getLocalPoint(o):t.localAnchorB||m.neo(1,0),this.m_maxLength=t.maxLength,this.m_mass=0,this.m_impulse=0,this.m_length=0,this.m_state=0,this.m_u=null,this.m_rA=null,this.m_rB=null,this.m_localCenterA=null,this.m_localCenterB=null,this.m_invMassA=0,this.m_invMassB=0,this.m_invIA=0,this.m_invIB=0,this.m_mass=0}a.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},a.prototype.setLocalAnchorA=function(t){return this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_localAnchorA=t},a.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},a.prototype.setLocalAnchorB=function(t){return this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_localAnchorB=t},a.prototype.setMaxLength=function(t){this.m_maxLength=t},a.prototype.getMaxLength=function(){return this.m_maxLength},a.prototype.setLength=function(t){this.m_maxLength=t},a.prototype.getLength=function(){return this.m_maxLength},a.prototype.getLimitState=function(){return this.m_state},a.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},a.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},a.prototype.getReactionForce=function(t,e){return m.mul(this.m_impulse,this.m_u,e).mul(t)},a.prototype.getReactionTorque=function(t){return 0},a.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;const e=this.m_bodyA.c_position.c,i=this.m_bodyA.c_position.a,s=this.m_bodyA.c_velocity.v;let o=this.m_bodyA.c_velocity.w;const r=this.m_bodyB.c_position.c,c=this.m_bodyB.c_position.a,l=this.m_bodyB.c_velocity.v;let a=this.m_bodyB.c_velocity.w;const _=h.neo(i),u=h.neo(c);this.m_rA=h.mulSub(_,this.m_localAnchorA,this.m_localCenterA),this.m_rB=h.mulSub(u,this.m_localAnchorB,this.m_localCenterB),this.m_u=m.zero(),this.m_u.addCombine(1,r,1,this.m_rB),this.m_u.subCombine(1,e,1,this.m_rA),this.m_length=this.m_u.length();const p=this.m_length-this.m_maxLength;if(this.m_state=p>0?2:0,!(this.m_length>n.linearSlop))return this.m_u.setZero(),this.m_mass=0,void(this.m_impulse=0);this.m_u.mul(1/this.m_length);const d=m.cross(this.m_rA,this.m_u),y=m.cross(this.m_rB,this.m_u),f=this.m_invMassA+this.m_invIA*d*d+this.m_invMassB+this.m_invIB*y*y;if(this.m_mass=0!==f?1/f:0,t.warmStarting){this.m_impulse*=t.dtRatio;const e=m.mul(this.m_impulse,this.m_u);s.subMul(this.m_invMassA,e),o-=this.m_invIA*m.cross(this.m_rA,e),l.addMul(this.m_invMassB,e),a+=this.m_invIB*m.cross(this.m_rB,e)}else this.m_impulse=0;this.m_bodyA.c_velocity.v.set(s),this.m_bodyA.c_velocity.w=o,this.m_bodyB.c_velocity.v.set(l),this.m_bodyB.c_velocity.w=a},a.prototype.solveVelocityConstraints=function(t){const e=this.m_bodyA.c_velocity.v;let i=this.m_bodyA.c_velocity.w;const s=this.m_bodyB.c_velocity.v;let o=this.m_bodyB.c_velocity.w;const n=m.addCross(e,i,this.m_rA),h=m.addCross(s,o,this.m_rB),c=this.m_length-this.m_maxLength;let l=m.dot(this.m_u,m.sub(h,n));c<0&&(l+=t.inv_dt*c);let a=-this.m_mass*l;const _=this.m_impulse;this.m_impulse=r.min(0,this.m_impulse+a),a=this.m_impulse-_;const u=m.mul(a,this.m_u);e.subMul(this.m_invMassA,u),i-=this.m_invIA*m.cross(this.m_rA,u),s.addMul(this.m_invMassB,u),o+=this.m_invIB*m.cross(this.m_rB,u),this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v=s,this.m_bodyB.c_velocity.w=o},a.prototype.solvePositionConstraints=function(t){const e=this.m_bodyA.c_position.c;let i=this.m_bodyA.c_position.a;const s=this.m_bodyB.c_position.c;let o=this.m_bodyB.c_position.a;const c=h.neo(i),l=h.neo(o),a=h.mulSub(c,this.m_localAnchorA,this.m_localCenterA),_=h.mulSub(l,this.m_localAnchorB,this.m_localCenterB),u=m.zero();u.addCombine(1,s,1,_),u.subCombine(1,e,1,a);const p=u.normalize();let d=p-this.m_maxLength;d=r.clamp(d,0,n.maxLinearCorrection);const y=-this.m_mass*d,f=m.mul(y,u);return e.subMul(this.m_invMassA,f),i-=this.m_invIA*m.cross(a,f),s.addMul(this.m_invMassB,f),o+=this.m_invIB*m.cross(_,f),this.m_bodyA.c_position.c.set(e),this.m_bodyA.c_position.a=i,this.m_bodyB.c_position.c.set(s),this.m_bodyB.c_position.a=o,p-this.m_maxLength<n.linearSlop}},function(t,e,i){t.exports=u;const s=i(7),o=i(5),n=i(4),r=i(1),m=i(0),h=i(17),c=i(19),l=i(3),a=i(8);u.TYPE="weld-joint",u._super=a,u.prototype=o(u._super.prototype);const _={frequencyHz:0,dampingRatio:0,active:!0};function u(t,e,i,o){if(pc.markPhysics2dModuleAsUsed(),!(this instanceof u))return new u(t,e,i,o);t=s(t,_),a.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=u.TYPE,this.m_localAnchorA=o?e.getLocalPoint(o):t.localAnchorA||m.zero(),this.m_localAnchorB=o?i.getLocalPoint(o):t.localAnchorB||m.zero(),r.isFinite(t.referenceAngle)?(this.m_referenceAngle=t.referenceAngle,this.m_autoReferenceAngle=!1):(this.m_referenceAngle=i.getAngle()-e.getAngle(),this.m_autoReferenceAngle=!0),this.m_frequencyHz=t.frequencyHz,this.m_dampingRatio=t.dampingRatio,this.m_impulse=h(),this.m_bias=0,this.m_gamma=0,this.m_rA=null,this.m_rB=null,this.m_localCenterA=null,this.m_localCenterB=null,this.m_invMassA=0,this.m_invMassB=0,this.m_invIA=0,this.m_invIB=0,this.m_mass=new c}u.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},u.prototype.setLocalAnchorA=function(t){return this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_localAnchorA=t},u.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},u.prototype.setLocalAnchorB=function(t){return this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_localAnchorB=t},u.prototype.getReferenceAngle=function(){return this.m_referenceAngle},u.prototype.setReferenceAngle=function(t){return this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_referenceAngle=t},u.prototype.setFrequency=function(t){this.m_frequencyHz=t},u.prototype.getFrequency=function(){return this.m_frequencyHz},u.prototype.setDampingRatio=function(t){this.m_dampingRatio=t},u.prototype.getDampingRatio=function(){return this.m_dampingRatio},u.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},u.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},u.prototype.getReactionForce=function(t,e){return(e=e||m.zero()).set(this.m_impulse.x,this.m_impulse.y).mul(t)},u.prototype.getReactionTorque=function(t){return t*this.m_impulse.z},u.prototype.setBodyA=function(t){u._super.prototype.setBodyA.call(this,t),this.m_autoReferenceAngle&&(this.m_referenceAngle=this.m_bodyB.getAngle()-this.m_bodyA.getAngle())},u.prototype.setBodyB=function(t){u._super.prototype.setBodyB.call(this,t),this.m_autoReferenceAngle&&(this.m_referenceAngle=this.m_bodyB.getAngle()-this.m_bodyA.getAngle())},u.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;const e=this.m_bodyA.c_position.a,i=this.m_bodyA.c_velocity.v;let s=this.m_bodyA.c_velocity.w;const o=this.m_bodyB.c_position.a,n=this.m_bodyB.c_velocity.v;let h=this.m_bodyB.c_velocity.w;const a=l.neo(e),_=l.neo(o);this.m_rA=l.mulVec2(a,m.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=l.mulVec2(_,m.sub(this.m_localAnchorB,this.m_localCenterB));const u=this.m_invMassA,p=this.m_invMassB,d=this.m_invIA,y=this.m_invIB,f=new c;if(f.ex.x=u+p+this.m_rA.y*this.m_rA.y*d+this.m_rB.y*this.m_rB.y*y,f.ey.x=-this.m_rA.y*this.m_rA.x*d-this.m_rB.y*this.m_rB.x*y,f.ez.x=-this.m_rA.y*d-this.m_rB.y*y,f.ex.y=f.ey.x,f.ey.y=u+p+this.m_rA.x*this.m_rA.x*d+this.m_rB.x*this.m_rB.x*y,f.ez.y=this.m_rA.x*d+this.m_rB.x*y,f.ex.z=f.ez.x,f.ey.z=f.ez.y,f.ez.z=d+y,this.m_frequencyHz>0){f.getInverse22(this.m_mass);let i=d+y;const s=i>0?1/i:0,n=o-e-this.m_referenceAngle,m=2*r.PI*this.m_frequencyHz,h=2*s*this.m_dampingRatio*m,c=s*m*m,l=t.dt;this.m_gamma=l*(h+l*c),this.m_gamma=0!==this.m_gamma?1/this.m_gamma:0,this.m_bias=n*l*c*this.m_gamma,i+=this.m_gamma,this.m_mass.ez.z=0!==i?1/i:0}else 0===f.ez.z?(f.getInverse22(this.m_mass),this.m_gamma=0,this.m_bias=0):(f.getSymInverse33(this.m_mass),this.m_gamma=0,this.m_bias=0);if(t.warmStarting){this.m_impulse.mul(t.dtRatio);const e=m.neo(this.m_impulse.x,this.m_impulse.y);i.subMul(u,e),s-=d*(m.cross(this.m_rA,e)+this.m_impulse.z),n.addMul(p,e),h+=y*(m.cross(this.m_rB,e)+this.m_impulse.z)}else this.m_impulse.setZero();this.m_bodyA.c_velocity.v=i,this.m_bodyA.c_velocity.w=s,this.m_bodyB.c_velocity.v=n,this.m_bodyB.c_velocity.w=h},u.prototype.solveVelocityConstraints=function(t){const e=this.m_bodyA.c_velocity.v;let i=this.m_bodyA.c_velocity.w;const s=this.m_bodyB.c_velocity.v;let o=this.m_bodyB.c_velocity.w;const n=this.m_invMassA,r=this.m_invMassB,l=this.m_invIA,a=this.m_invIB;if(this.m_frequencyHz>0){let t=o-i;const h=-this.m_mass.ez.z*(t+this.m_bias+this.m_gamma*this.m_impulse.z);this.m_impulse.z+=h,i-=l*h,o+=a*h;let _=m.zero();_.addCombine(1,s,1,m.cross(o,this.m_rB)),_.subCombine(1,e,1,m.cross(i,this.m_rA));const u=m.neg(c.mulVec2(this.m_mass,_));this.m_impulse.x+=u.x,this.m_impulse.y+=u.y;let p=m.clone(u);e.subMul(n,p),i-=l*m.cross(this.m_rA,p),s.addMul(r,p),o+=a*m.cross(this.m_rB,p)}else{let t=m.zero();t.addCombine(1,s,1,m.cross(o,this.m_rB)),t.subCombine(1,e,1,m.cross(i,this.m_rA));let _=o-i;const u=h(t.x,t.y,_),p=h.neg(c.mulVec3(this.m_mass,u));this.m_impulse.add(p);let d=m.neo(p.x,p.y);e.subMul(n,d),i-=l*(m.cross(this.m_rA,d)+p.z),s.addMul(r,d),o+=a*(m.cross(this.m_rB,d)+p.z)}this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v=s,this.m_bodyB.c_velocity.w=o},u.prototype.solvePositionConstraints=function(t){const e=this.m_bodyA.c_position.c;let i=this.m_bodyA.c_position.a;const s=this.m_bodyB.c_position.c;let o=this.m_bodyB.c_position.a;const a=l.neo(i),_=l.neo(o),u=this.m_invMassA,p=this.m_invMassB,d=this.m_invIA,y=this.m_invIB,f=l.mulVec2(a,m.sub(this.m_localAnchorA,this.m_localCenterA)),x=l.mulVec2(_,m.sub(this.m_localAnchorB,this.m_localCenterB));let g,v;const A=new c;if(A.ex.x=u+p+f.y*f.y*d+x.y*x.y*y,A.ey.x=-f.y*f.x*d-x.y*x.x*y,A.ez.x=-f.y*d-x.y*y,A.ex.y=A.ey.x,A.ey.y=u+p+f.x*f.x*d+x.x*x.x*y,A.ez.y=f.x*d+x.x*y,A.ex.z=A.ez.x,A.ey.z=A.ez.y,A.ez.z=d+y,this.m_frequencyHz>0){let t=m.zero();t.addCombine(1,s,1,x),t.subCombine(1,e,1,f),g=t.length(),v=0;let n=m.neg(A.solve22(t));e.subMul(u,n),i-=d*m.cross(f,n),s.addMul(p,n),o+=y*m.cross(x,n)}else{let t=m.zero();t.addCombine(1,s,1,x),t.subCombine(1,e,1,f);const n=o-i-this.m_referenceAngle;g=t.length(),v=r.abs(n);const c=h(t.x,t.y,n);let l=h();if(A.ez.z>0)l=h.neg(A.solve33(c));else{const e=m.neg(A.solve22(t));l.set(e.x,e.y,0)}let a=m.neo(l.x,l.y);e.subMul(u,a),i-=d*(m.cross(f,a)+l.z),s.addMul(p,a),o+=y*(m.cross(x,a)+l.z)}return this.m_bodyA.c_position.c=e,this.m_bodyA.c_position.a=i,this.m_bodyB.c_position.c=s,this.m_bodyB.c_position.a=o,g<=n.linearSlop&&v<=n.angularSlop}},function(t,e,i){t.exports=a;const s=i(7),o=i(5),n=i(4),r=i(1),m=i(0),h=i(3),c=i(8);a.TYPE="wheel-joint",a._super=c,a.prototype=o(a._super.prototype);const l={enableMotor:!1,maxMotorTorque:1e4,motorSpeed:0,frequencyHz:2,dampingRatio:.7,active:!0};function a(t,e,i,o,n){if(pc.markPhysics2dModuleAsUsed(),!(this instanceof a))return new a(t,e,i,o,n);t=s(t,l),c.call(this,t,e,i),e=this.m_bodyA,i=this.m_bodyB,this.m_type=a.TYPE,this.m_localAnchorA=o?e.getLocalPoint(o):t.localAnchorA||m.zero(),this.m_localAnchorB=o?i.getLocalPoint(o):t.localAnchorB||m.zero(),this.m_localAxis=n?e.getLocalVector(n):t.localAxisA||m.neo(0,1),this.m_localXAxisA=this.m_localAxis,this.m_localYAxisA=m.cross(1,this.m_localXAxisA),this.m_mass=0,this.m_impulse=0,this.m_motorMass=0,this.m_motorImpulse=0,this.m_springMass=0,this.m_springImpulse=0,this.m_maxMotorTorque=t.maxMotorTorque,this.m_motorSpeed=t.motorSpeed,this.m_enableMotor=t.enableMotor,this.m_frequencyHz=t.frequencyHz,this.m_dampingRatio=t.dampingRatio,this.m_bias=0,this.m_gamma=0,this.m_localCenterA=null,this.m_localCenterB=null,this.m_invMassA=null,this.m_invMassB=null,this.m_invIA=null,this.m_invIB=null,this.m_ax=m.zero(),this.m_ay=m.zero(),this.m_sAx=0,this.m_sBx=0,this.m_sAy=0,this.m_sBy=0}a.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},a.prototype.setLocalAnchorA=function(t){return this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_localAnchorA=t,this.m_localAnchorA},a.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},a.prototype.setLocalAnchorB=function(t){return this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_localAnchorB=t,this.m_localAnchorB},a.prototype.getLocalAxisA=function(){return this.m_localXAxisA},a.prototype.setLocalAxisA=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_localAxis.set(t),this.m_localXAxisA.set(t),this.m_localYAxisA.set(-t.y,t.x)},a.prototype.getJointTranslation=function(){const t=this.m_bodyA,e=this.m_bodyB,i=t.getWorldPoint(this.m_localAnchorA),s=e.getWorldPoint(this.m_localAnchorB),o=m.sub(s,i),n=t.getWorldVector(this.m_localXAxisA);return m.dot(o,n)},a.prototype.getJointLinearSpeed=function(){const t=this.m_bodyA,e=this.m_bodyB,i=h.mulVec2(t.m_xf.q,m.sub(this.m_localAnchorA,t.m_sweep.localCenter)),s=h.mulVec2(e.m_xf.q,m.sub(this.m_localAnchorB,e.m_sweep.localCenter)),o=m.add(t.m_sweep.c,i),n=m.add(e.m_sweep.c,s),r=m.sub(n,o),c=h.mulVec2(t.m_xf.q,this.m_localXAxisA),l=t.m_linearVelocity,a=e.m_linearVelocity,_=t.m_angularVelocity,u=e.m_angularVelocity;return m.dot(r,m.cross(_,c))+m.dot(c,m.add(a,m.sub(m.cross(u,s),m.add(l,m.cross(_,i)))))},a.prototype.getJointAngle=function(){return this.m_bodyB.m_sweep.a-this.m_bodyA.m_sweep.a},a.prototype.getJointAngularSpeed=function(){const t=this.m_bodyA.m_angularVelocity;return this.m_bodyB.m_angularVelocity-t},a.prototype.isMotorEnabled=function(){return this.m_enableMotor},a.prototype.enableMotor=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableMotor=t},a.prototype.setMotorSpeed=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_motorSpeed=t},a.prototype.getMotorSpeed=function(){return this.m_motorSpeed},a.prototype.setMaxMotorTorque=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_maxMotorTorque=t},a.prototype.getMaxMotorTorque=function(){return this.m_maxMotorTorque},a.prototype.getMotorTorque=function(t){return t*this.m_motorImpulse},a.prototype.setSpringFrequencyHz=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_frequencyHz=t},a.prototype.getSpringFrequencyHz=function(){return this.m_frequencyHz},a.prototype.setSpringDampingRatio=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_dampingRatio=t},a.prototype.getSpringDampingRatio=function(){return this.m_dampingRatio},a.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},a.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},a.prototype.getReactionForce=function(t,e){return(e=e||m.zero()).setCombine(this.m_impulse,this.m_ay,this.m_springImpulse,this.m_ax).mul(t)},a.prototype.getReactionTorque=function(t){return t*this.m_motorImpulse},a.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;const e=this.m_invMassA,i=this.m_invMassB,s=this.m_invIA,o=this.m_invIB,n=this.m_bodyA.c_position.c,c=this.m_bodyA.c_position.a,l=this.m_bodyA.c_velocity.v;let a=this.m_bodyA.c_velocity.w;const _=this.m_bodyB.c_position.c,u=this.m_bodyB.c_position.a,p=this.m_bodyB.c_velocity.v;let d=this.m_bodyB.c_velocity.w;const y=h.neo(c),f=h.neo(u),x=h.mulVec2(y,m.sub(this.m_localAnchorA,this.m_localCenterA)),g=h.mulVec2(f,m.sub(this.m_localAnchorB,this.m_localCenterB));let v=m.zero();if(v.addCombine(1,_,1,g),v.subCombine(1,n,1,x),this.m_ay=h.mulVec2(y,this.m_localYAxisA),this.m_sAy=m.cross(m.add(v,x),this.m_ay),this.m_sBy=m.cross(g,this.m_ay),this.m_mass=e+i+s*this.m_sAy*this.m_sAy+o*this.m_sBy*this.m_sBy,this.m_mass>0&&(this.m_mass=1/this.m_mass),this.m_springMass=0,this.m_bias=0,this.m_gamma=0,this.m_frequencyHz>0){this.m_ax=h.mulVec2(y,this.m_localXAxisA),this.m_sAx=m.cross(m.add(v,x),this.m_ax),this.m_sBx=m.cross(g,this.m_ax);const n=e+i+s*this.m_sAx*this.m_sAx+o*this.m_sBx*this.m_sBx;if(n>0){this.m_springMass=1/n;const e=m.dot(v,this.m_ax),i=2*r.PI*this.m_frequencyHz;let s=2*this.m_springMass*this.m_dampingRatio*i;const o=this.m_springMass*i*i,h=t.dt;this.m_gamma=h*(s+h*o),this.m_gamma>0&&(this.m_gamma=1/this.m_gamma),this.m_bias=e*h*o*this.m_gamma,this.m_springMass=n+this.m_gamma,this.m_springMass>0&&(this.m_springMass=1/this.m_springMass)}}else this.m_springImpulse=0;if(this.m_enableMotor?(this.m_motorMass=s+o,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass)):(this.m_motorMass=0,this.m_motorImpulse=0),t.warmStarting){this.m_impulse*=t.dtRatio,this.m_springImpulse*=t.dtRatio,this.m_motorImpulse*=t.dtRatio;const e=m.combine(this.m_impulse,this.m_ay,this.m_springImpulse,this.m_ax),i=this.m_impulse*this.m_sAy+this.m_springImpulse*this.m_sAx+this.m_motorImpulse,s=this.m_impulse*this.m_sBy+this.m_springImpulse*this.m_sBx+this.m_motorImpulse;l.subMul(this.m_invMassA,e),a-=this.m_invIA*i,p.addMul(this.m_invMassB,e),d+=this.m_invIB*s}else this.m_impulse=0,this.m_springImpulse=0,this.m_motorImpulse=0;this.m_bodyA.c_velocity.v.set(l),this.m_bodyA.c_velocity.w=a,this.m_bodyB.c_velocity.v.set(p),this.m_bodyB.c_velocity.w=d},a.prototype.solveVelocityConstraints=function(t){const e=this.m_invMassA,i=this.m_invMassB,s=this.m_invIA,o=this.m_invIB,n=this.m_bodyA.c_velocity.v;let h=this.m_bodyA.c_velocity.w;const c=this.m_bodyB.c_velocity.v;let l=this.m_bodyB.c_velocity.w;{let t=m.dot(this.m_ax,c)-m.dot(this.m_ax,n)+this.m_sBx*l-this.m_sAx*h,r=-this.m_springMass*(t+this.m_bias+this.m_gamma*this.m_springImpulse);this.m_springImpulse+=r;let a=m.mul(r,this.m_ax),_=r*this.m_sAx,u=r*this.m_sBx;n.subMul(e,a),h-=s*_,c.addMul(i,a),l+=o*u}{let e=l-h-this.m_motorSpeed,i=-this.m_motorMass*e;const n=this.m_motorImpulse,m=t.dt*this.m_maxMotorTorque;this.m_motorImpulse=r.clamp(this.m_motorImpulse+i,-m,m),i=this.m_motorImpulse-n,h-=s*i,l+=o*i}{let t=m.dot(this.m_ay,c)-m.dot(this.m_ay,n)+this.m_sBy*l-this.m_sAy*h,r=-this.m_mass*t;this.m_impulse+=r;let a=m.mul(r,this.m_ay),_=r*this.m_sAy,u=r*this.m_sBy;n.subMul(e,a),h-=s*_,c.addMul(i,a),l+=o*u}this.m_bodyA.c_velocity.v.set(n),this.m_bodyA.c_velocity.w=h,this.m_bodyB.c_velocity.v.set(c),this.m_bodyB.c_velocity.w=l},a.prototype.solvePositionConstraints=function(t){const e=this.m_bodyA.c_position.c;let i=this.m_bodyA.c_position.a;const s=this.m_bodyB.c_position.c;let o=this.m_bodyB.c_position.a;const c=h.neo(i),l=h.neo(o),a=h.mulVec2(c,m.sub(this.m_localAnchorA,this.m_localCenterA)),_=h.mulVec2(l,m.sub(this.m_localAnchorB,this.m_localCenterB)),u=m.zero();u.addCombine(1,s,1,_),u.subCombine(1,e,1,a);const p=h.mulVec2(c,this.m_localYAxisA),d=m.cross(m.add(u,a),p),y=m.cross(_,p),f=m.dot(u,p),x=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_sAy*this.m_sAy+this.m_invIB*this.m_sBy*this.m_sBy;let g;g=0!==x?-f/x:0;const v=m.mul(g,p),A=g*d,b=g*y;return e.subMul(this.m_invMassA,v),i-=this.m_invIA*A,s.addMul(this.m_invMassB,v),o+=this.m_invIB*b,this.m_bodyA.c_position.c.set(e),this.m_bodyA.c_position.a=i,this.m_bodyB.c_position.c.set(s),this.m_bodyB.c_position.a=o,r.abs(f)<=n.linearSlop}}]);